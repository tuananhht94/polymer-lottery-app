import{d as O,L as $,M as w,N as b,O as I,P as B,Q as P,t as n,v as a,x as s,B as R,R as e,y as o,S as r,l as Y,_ as V,z as W}from"./CQoln4ml.js";import{d as t,a as d}from"./MAmfmF4f.js";const z={class:"card"},H={class:"card-body"},M={key:0},Q={key:1},j={key:0},q={key:1},F=["disabled"],G={key:0},J=s("p",null,"Your transaction is being confirmed, please wait!",-1),K=[J],U={key:1,class:"transaction"},X=["href"],Z={key:2,class:"transaction"},ee=s("p",null,"Transaction failed!",-1),se=[ee],ne=O({__name:"AdminCard",setup(N){const i=Y(),{data:c,isLoading:g,refetch:l}=$({chainId:t.id,address:`0x${i.public.LOTTERY_CONTRACT_ADDRESS}`}),{data:_,isLoading:v,refetch:h}=w({chainId:t.id,address:`0x${i.public.LOTTERY_CONTRACT_ADDRESS}`,abi:d,functionName:"getPlayers"});b({chainId:t.id,address:`0x${i.public.LOTTERY_CONTRACT_ADDRESS}`,abi:d,eventName:"Enter",listener:()=>{l(),h()}}),b({chainId:t.id,address:`0x${i.public.LOTTERY_CONTRACT_ADDRESS}`,abi:d,eventName:"Winner",listener:()=>{l(),h()}});const E=I(),{switchNetworkAsync:S}=B({chainId:t.id}),{data:u,write:x,isLoading:p,isSuccess:A,isError:D}=P({chainId:t.id,address:`0x${i.public.LOTTERY_CONTRACT_ADDRESS}`,abi:d,functionName:"pickWinner"});async function L(){E.value!==t.id&&await S(),x()}return(de,re)=>{var f,m,C,T,k,y;return n(),a("div",z,[s("div",H,[s("div",null,[s("p",null,[R(" Prize: "),e(g)?(n(),a("span",M,"loading...")):(n(),a("span",Q,o((f=e(c))==null?void 0:f.formatted)+" "+o((m=e(c))==null?void 0:m.symbol),1))]),s("p",null,[R(" Number of players: "),e(v)?(n(),a("span",j,"loading...")):(n(),a("span",q,o(((C=e(_))==null?void 0:C.length)||0),1))]),s("button",{class:"btn btn-dark",disabled:((T=e(_))==null?void 0:T.length)===0||e(p),onClick:L}," Pick winner! ",8,F),s("div",null,[e(p)?(n(),a("div",G,K)):r("",!0),e(A)?(n(),a("div",U,[s("a",{href:`${e(t).blockExplorers.default.url}/tx/${(k=e(u))==null?void 0:k.hash}`,target:"_blank"}," Click here and check your transaction ",8,X),s("p",null,"Hash: "+o((y=e(u))==null?void 0:y.hash),1)])):r("",!0),e(D)?(n(),a("div",Z,se)):r("",!0)])])])])}}}),ae={},te={class:"container py-4"},ie={class:"row g-4"},ce={class:"col-12 col-md-6 offset-md-3"};function oe(N,i){const c=ne;return n(),a("main",null,[s("div",te,[s("div",ie,[s("div",ce,[W(c)])])])])}const he=V(ae,[["render",oe]]);export{he as default};
