function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./CN8lmHpk.js","./CQoln4ml.js","./entry.hFavoi6R.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{ah as Io,ai as co,aj as Ql,ak as bs,al as se,am as R0,an as Yl,ao as Xl,ap as Rc,aq as xo,ar as C0,as as jr,at as xi,au as A0,av as T0,aw as Y,ax as N0,ay as mc,az as L0,aA as D0,aB as $0,aC as zh,aD as q0,aE as M0,aF as j0,aG as Uh,aH as z0,aI as U0,aJ as H0,aK as Zs,aL as Hh,aM as k0,aN as K0,aO as Zl,aP as qr,aQ as B0,aR as kh,aS as ds,aT as Dt,aU as Wt,aV as Ii,aW as lr,aX as F0,aY as gs,aZ as ef,a_ as V0,a$ as G0,b0 as W0,b1 as tf,b2 as J0,b3 as rf,b4 as sf,b5 as ys,b6 as wc,b7 as go,b8 as _s,b9 as Q0,ba as vo,bb as Y0,bc as X0,bd as Z0,be as ew,bf as uo,bg as tw,bh as rw,bi as tc,bj as Kh,bk as iw,bl as sw,bm as nw,bn as Bh,bo as ow,bp as aw,bq as cw,br as uw,bs as hw,bt as lw,bu as fw,bv as Js,bw as nf,bx as rc,by as pw,bz as dw,bA as gw}from"./CQoln4ml.js";var Cc={exports:{}},ms=typeof Reflect=="object"?Reflect:null,Fh=ms&&typeof ms.apply=="function"?ms.apply:function(t,i,s){return Function.prototype.apply.call(t,i,s)},yo;ms&&typeof ms.ownKeys=="function"?yo=ms.ownKeys:Object.getOwnPropertySymbols?yo=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:yo=function(t){return Object.getOwnPropertyNames(t)};function vw(a){console&&console.warn&&console.warn(a)}var of=Number.isNaN||function(t){return t!==t};function Ke(){Ke.init.call(this)}Cc.exports=Ke;Cc.exports.once=_w;Ke.EventEmitter=Ke;Ke.prototype._events=void 0;Ke.prototype._eventsCount=0;Ke.prototype._maxListeners=void 0;var Vh=10;function Po(a){if(typeof a!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}Object.defineProperty(Ke,"defaultMaxListeners",{enumerable:!0,get:function(){return Vh},set:function(a){if(typeof a!="number"||a<0||of(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");Vh=a}});Ke.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ke.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||of(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function af(a){return a._maxListeners===void 0?Ke.defaultMaxListeners:a._maxListeners}Ke.prototype.getMaxListeners=function(){return af(this)};Ke.prototype.emit=function(t){for(var i=[],s=1;s<arguments.length;s++)i.push(arguments[s]);var o=t==="error",h=this._events;if(h!==void 0)o=o&&h.error===void 0;else if(!o)return!1;if(o){var f;if(i.length>0&&(f=i[0]),f instanceof Error)throw f;var g=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw g.context=f,g}var _=h[t];if(_===void 0)return!1;if(typeof _=="function")Fh(_,this,i);else for(var v=_.length,I=ff(_,v),s=0;s<v;++s)Fh(I[s],this,i);return!0};function cf(a,t,i,s){var o,h,f;if(Po(i),h=a._events,h===void 0?(h=a._events=Object.create(null),a._eventsCount=0):(h.newListener!==void 0&&(a.emit("newListener",t,i.listener?i.listener:i),h=a._events),f=h[t]),f===void 0)f=h[t]=i,++a._eventsCount;else if(typeof f=="function"?f=h[t]=s?[i,f]:[f,i]:s?f.unshift(i):f.push(i),o=af(a),o>0&&f.length>o&&!f.warned){f.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=a,g.type=t,g.count=f.length,vw(g)}return a}Ke.prototype.addListener=function(t,i){return cf(this,t,i,!1)};Ke.prototype.on=Ke.prototype.addListener;Ke.prototype.prependListener=function(t,i){return cf(this,t,i,!0)};function yw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uf(a,t,i){var s={fired:!1,wrapFn:void 0,target:a,type:t,listener:i},o=yw.bind(s);return o.listener=i,s.wrapFn=o,o}Ke.prototype.once=function(t,i){return Po(i),this.on(t,uf(this,t,i)),this};Ke.prototype.prependOnceListener=function(t,i){return Po(i),this.prependListener(t,uf(this,t,i)),this};Ke.prototype.removeListener=function(t,i){var s,o,h,f,g;if(Po(i),o=this._events,o===void 0)return this;if(s=o[t],s===void 0)return this;if(s===i||s.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,s.listener||i));else if(typeof s!="function"){for(h=-1,f=s.length-1;f>=0;f--)if(s[f]===i||s[f].listener===i){g=s[f].listener,h=f;break}if(h<0)return this;h===0?s.shift():mw(s,h),s.length===1&&(o[t]=s[0]),o.removeListener!==void 0&&this.emit("removeListener",t,g||i)}return this};Ke.prototype.off=Ke.prototype.removeListener;Ke.prototype.removeAllListeners=function(t){var i,s,o;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var h=Object.keys(s),f;for(o=0;o<h.length;++o)f=h[o],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=s[t],typeof i=="function")this.removeListener(t,i);else if(i!==void 0)for(o=i.length-1;o>=0;o--)this.removeListener(t,i[o]);return this};function hf(a,t,i){var s=a._events;if(s===void 0)return[];var o=s[t];return o===void 0?[]:typeof o=="function"?i?[o.listener||o]:[o]:i?ww(o):ff(o,o.length)}Ke.prototype.listeners=function(t){return hf(this,t,!0)};Ke.prototype.rawListeners=function(t){return hf(this,t,!1)};Ke.listenerCount=function(a,t){return typeof a.listenerCount=="function"?a.listenerCount(t):lf.call(a,t)};Ke.prototype.listenerCount=lf;function lf(a){var t=this._events;if(t!==void 0){var i=t[a];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}Ke.prototype.eventNames=function(){return this._eventsCount>0?yo(this._events):[]};function ff(a,t){for(var i=new Array(t),s=0;s<t;++s)i[s]=a[s];return i}function mw(a,t){for(;t+1<a.length;t++)a[t]=a[t+1];a.pop()}function ww(a){for(var t=new Array(a.length),i=0;i<t.length;++i)t[i]=a[i].listener||a[i];return t}function _w(a,t){return new Promise(function(i,s){function o(f){a.removeListener(t,h),s(f)}function h(){typeof a.removeListener=="function"&&a.removeListener("error",o),i([].slice.call(arguments))}pf(a,t,h,{once:!0}),t!=="error"&&bw(a,o,{once:!0})})}function bw(a,t,i){typeof a.on=="function"&&pf(a,"error",t,i)}function pf(a,t,i,s){if(typeof a.on=="function")s.once?a.once(t,i):a.on(t,i);else if(typeof a.addEventListener=="function")a.addEventListener(t,function o(h){s.once&&a.removeEventListener(t,o),i(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}var mr=Cc.exports;const Ac=Io(mr);function Ew(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Ht(a,...t){try{return Ew(a(...t))}catch(i){return Promise.reject(i)}}function Iw(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function xw(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function mo(a){if(Iw(a))return String(a);if(xw(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return mo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function df(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const _c="base64:";function Pw(a){if(typeof a=="string")return a;df();const t=Buffer.from(a).toString("base64");return _c+t}function Sw(a){return typeof a!="string"||!a.startsWith(_c)?a:(df(),Buffer.from(a.slice(_c.length),"base64"))}function hr(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Ow(...a){return hr(a.join(":"))}function ho(a){return a=hr(a),a?a+":":""}const Rw="memory",Cw=()=>{const a=new Map;return{name:Rw,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,i){a.set(t,i)},setItemRaw(t,i){a.set(t,i)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function Aw(a={}){const t={mounts:{"":a.driver||Cw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=v=>{for(const I of t.mountpoints)if(v.startsWith(I))return{base:I,relativeKey:v.slice(I.length),driver:t.mounts[I]};return{base:"",relativeKey:v,driver:t.mounts[""]}},s=(v,I)=>t.mountpoints.filter(R=>R.startsWith(v)||I&&v.startsWith(R)).map(R=>({relativeBase:v.length>R.length?v.slice(R.length):void 0,mountpoint:R,driver:t.mounts[R]})),o=(v,I)=>{if(t.watching){I=hr(I);for(const R of t.watchListeners)R(v,I)}},h=async()=>{if(!t.watching){t.watching=!0;for(const v in t.mounts)t.unwatch[v]=await Gh(t.mounts[v],o,v)}},f=async()=>{if(t.watching){for(const v in t.unwatch)await t.unwatch[v]();t.unwatch={},t.watching=!1}},g=(v,I,R)=>{const A=new Map,z=T=>{let F=A.get(T.base);return F||(F={driver:T.driver,base:T.base,items:[]},A.set(T.base,F)),F};for(const T of v){const F=typeof T=="string",re=hr(F?T:T.key),he=F?void 0:T.value,le=F||!T.options?I:{...I,...T.options},fe=i(re);z(fe).items.push({key:re,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...A.values()].map(T=>R(T))).then(T=>T.flat())},_={hasItem(v,I={}){v=hr(v);const{relativeKey:R,driver:A}=i(v);return Ht(A.hasItem,R,I)},getItem(v,I={}){v=hr(v);const{relativeKey:R,driver:A}=i(v);return Ht(A.getItem,R,I).then(z=>co(z))},getItems(v,I){return g(v,I,R=>R.driver.getItems?Ht(R.driver.getItems,R.items.map(A=>({key:A.relativeKey,options:A.options})),I).then(A=>A.map(z=>({key:Ow(R.base,z.key),value:co(z.value)}))):Promise.all(R.items.map(A=>Ht(R.driver.getItem,A.relativeKey,A.options).then(z=>({key:A.key,value:co(z)})))))},getItemRaw(v,I={}){v=hr(v);const{relativeKey:R,driver:A}=i(v);return A.getItemRaw?Ht(A.getItemRaw,R,I):Ht(A.getItem,R,I).then(z=>Sw(z))},async setItem(v,I,R={}){if(I===void 0)return _.removeItem(v);v=hr(v);const{relativeKey:A,driver:z}=i(v);z.setItem&&(await Ht(z.setItem,A,mo(I),R),z.watch||o("update",v))},async setItems(v,I){await g(v,I,async R=>{if(R.driver.setItems)return Ht(R.driver.setItems,R.items.map(A=>({key:A.relativeKey,value:mo(A.value),options:A.options})),I);R.driver.setItem&&await Promise.all(R.items.map(A=>Ht(R.driver.setItem,A.relativeKey,mo(A.value),A.options)))})},async setItemRaw(v,I,R={}){if(I===void 0)return _.removeItem(v,R);v=hr(v);const{relativeKey:A,driver:z}=i(v);if(z.setItemRaw)await Ht(z.setItemRaw,A,I,R);else if(z.setItem)await Ht(z.setItem,A,Pw(I),R);else return;z.watch||o("update",v)},async removeItem(v,I={}){typeof I=="boolean"&&(I={removeMeta:I}),v=hr(v);const{relativeKey:R,driver:A}=i(v);A.removeItem&&(await Ht(A.removeItem,R,I),(I.removeMeta||I.removeMata)&&await Ht(A.removeItem,R+"$",I),A.watch||o("remove",v))},async getMeta(v,I={}){typeof I=="boolean"&&(I={nativeOnly:I}),v=hr(v);const{relativeKey:R,driver:A}=i(v),z=Object.create(null);if(A.getMeta&&Object.assign(z,await Ht(A.getMeta,R,I)),!I.nativeOnly){const T=await Ht(A.getItem,R+"$",I).then(F=>co(F));T&&typeof T=="object"&&(typeof T.atime=="string"&&(T.atime=new Date(T.atime)),typeof T.mtime=="string"&&(T.mtime=new Date(T.mtime)),Object.assign(z,T))}return z},setMeta(v,I,R={}){return this.setItem(v+"$",I,R)},removeMeta(v,I={}){return this.removeItem(v+"$",I)},async getKeys(v,I={}){v=ho(v);const R=s(v,!0);let A=[];const z=[];for(const T of R){const re=(await Ht(T.driver.getKeys,T.relativeBase,I)).map(he=>T.mountpoint+hr(he)).filter(he=>!A.some(le=>he.startsWith(le)));z.push(...re),A=[T.mountpoint,...A.filter(he=>!he.startsWith(T.mountpoint))]}return v?z.filter(T=>T.startsWith(v)&&!T.endsWith("$")):z.filter(T=>!T.endsWith("$"))},async clear(v,I={}){v=ho(v),await Promise.all(s(v,!1).map(async R=>{if(R.driver.clear)return Ht(R.driver.clear,R.relativeBase,I);if(R.driver.removeItem){const A=await R.driver.getKeys(R.relativeBase||"",I);return Promise.all(A.map(z=>R.driver.removeItem(z,I)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(v=>Wh(v)))},async watch(v){return await h(),t.watchListeners.push(v),async()=>{t.watchListeners=t.watchListeners.filter(I=>I!==v),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(v,I){if(v=ho(v),v&&t.mounts[v])throw new Error(`already mounted at ${v}`);return v&&(t.mountpoints.push(v),t.mountpoints.sort((R,A)=>A.length-R.length)),t.mounts[v]=I,t.watching&&Promise.resolve(Gh(I,o,v)).then(R=>{t.unwatch[v]=R}).catch(console.error),_},async unmount(v,I=!0){v=ho(v),!(!v||!t.mounts[v])&&(t.watching&&v in t.unwatch&&(t.unwatch[v](),delete t.unwatch[v]),I&&await Wh(t.mounts[v]),t.mountpoints=t.mountpoints.filter(R=>R!==v),delete t.mounts[v])},getMount(v=""){v=hr(v)+":";const I=i(v);return{driver:I.driver,base:I.base}},getMounts(v="",I={}){return v=hr(v),s(v,I.parents).map(A=>({driver:A.driver,base:A.mountpoint}))}};return _}function Gh(a,t,i){return a.watch?a.watch((s,o)=>t(s,i+o)):()=>{}}async function Wh(a){typeof a.dispose=="function"&&await Ht(a.dispose)}function Fi(a){return new Promise((t,i)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>i(a.error)})}function gf(a,t){const i=indexedDB.open(a);i.onupgradeneeded=()=>i.result.createObjectStore(t);const s=Fi(i);return(o,h)=>s.then(f=>h(f.transaction(t,o).objectStore(t)))}let ic;function en(){return ic||(ic=gf("keyval-store","keyval")),ic}function Jh(a,t=en()){return t("readonly",i=>Fi(i.get(a)))}function Tw(a,t,i=en()){return i("readwrite",s=>(s.put(t,a),Fi(s.transaction)))}function Nw(a,t=en()){return t("readwrite",i=>(i.delete(a),Fi(i.transaction)))}function Lw(a=en()){return a("readwrite",t=>(t.clear(),Fi(t.transaction)))}function Dw(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Fi(a.transaction)}function $w(a=en()){return a("readonly",t=>{if(t.getAllKeys)return Fi(t.getAllKeys());const i=[];return Dw(t,s=>i.push(s.key)).then(()=>i)})}const qw=a=>JSON.stringify(a,(t,i)=>typeof i=="bigint"?i.toString()+"n":i),Mw=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=a.replace(t,'$1"$2n"$3');return JSON.parse(i,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function tn(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return Mw(a)}catch{return a}}function Bi(a){return typeof a=="string"?a:qw(a)||""}const jw="idb-keyval";var zw=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",i=o=>t+o;let s;return a.dbName&&a.storeName&&(s=gf(a.dbName,a.storeName)),{name:jw,options:a,async hasItem(o){return!(typeof await Jh(i(o),s)>"u")},async getItem(o){return await Jh(i(o),s)??null},setItem(o,h){return Tw(i(o),h,s)},removeItem(o){return Nw(i(o),s)},getKeys(){return $w(s)},clear(){return Lw(s)}}};const Uw="WALLET_CONNECT_V2_INDEXED_DB",Hw="keyvaluestorage";let kw=class{constructor(){this.indexedDb=Aw({driver:zw({dbName:Uw,storeName:Hw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const i=await this.indexedDb.getItem(t);if(i!==null)return i}async setItem(t,i){await this.indexedDb.setItem(t,Bi(i))}async removeItem(t){await this.indexedDb.removeItem(t)}};var sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wo={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},a.prototype.setItem=function(i,s){this[i]=String(s)},a.prototype.removeItem=function(i){delete this[i]},a.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(s){i[s]=void 0,delete i[s]})},a.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof sc<"u"&&sc.localStorage?wo.exports=sc.localStorage:typeof window<"u"&&window.localStorage?wo.exports=window.localStorage:wo.exports=new t})();function Kw(a){var t;return[a[0],tn((t=a[1])!=null?t:"")]}class Bw{constructor(){this.localStorage=wo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Kw)}async getItem(t){const i=this.localStorage.getItem(t);if(i!==null)return tn(i)}async setItem(t,i){this.localStorage.setItem(t,Bi(i))}async removeItem(t){this.localStorage.removeItem(t)}}const Fw="wc_storage_version",Qh=1,Vw=async(a,t,i)=>{const s=Fw,o=await t.getItem(s);if(o&&o>=Qh){i(t);return}const h=await a.getKeys();if(!h.length){i(t);return}const f=[];for(;h.length;){const g=h.shift();if(!g)continue;const _=g.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const v=await a.getItem(g);await t.setItem(g,v),f.push(g)}}await t.setItem(s,Qh),i(t),Gw(a,f)},Gw=async(a,t)=>{t.length&&t.forEach(async i=>{await a.removeItem(i)})};let Ww=class{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};const t=new Bw;this.storage=t;try{const i=new kw;Vw(t,i,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,i){return await this.initialize(),this.storage.setItem(t,i)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const i=setInterval(()=>{this.initialized&&(clearInterval(i),t())},20)})}};var Es={},ks={},nc={},Ks={};let Vi=class{};const Jw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Vi},Symbol.toStringTag,{value:"Module"})),Qw=Ql(Jw);var Yh;function Yw(){if(Yh)return Ks;Yh=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.IHeartBeat=void 0;const a=Qw;class t extends a.IEvents{constructor(s){super()}}return Ks.IHeartBeat=t,Ks}var Xh;function vf(){return Xh||(Xh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),bs.__exportStar(Yw(),a)}(nc)),nc}var oc={},ki={},Zh;function Xw(){if(Zh)return ki;Zh=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.HEARTBEAT_EVENTS=ki.HEARTBEAT_INTERVAL=void 0;const a=se;return ki.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,ki.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ki}var el;function yf(){return el||(el=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),bs.__exportStar(Xw(),a)}(oc)),oc}var tl;function Zw(){if(tl)return ks;tl=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.HeartBeat=void 0;const a=bs,t=mr,i=se,s=vf(),o=yf();class h extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||o.HEARTBEAT_INTERVAL}static init(g){return a.__awaiter(this,void 0,void 0,function*(){const _=new h(g);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,_){this.events.on(g,_)}once(g,_){this.events.once(g,_)}off(g,_){this.events.off(g,_)}removeListener(g,_){this.events.removeListener(g,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ks.HeartBeat=h,ks}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=bs;t.__exportStar(Zw(),a),t.__exportStar(vf(),a),t.__exportStar(yf(),a)})(Es);var Re={},ac,rl;function e_(){if(rl)return ac;rl=1;function a(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}ac=t;function t(i,s,o){var h=o&&o.stringify||a,f=1;if(typeof i=="object"&&i!==null){var g=s.length+f;if(g===1)return i;var _=new Array(g);_[0]=h(i);for(var v=1;v<g;v++)_[v]=h(s[v]);return _.join(" ")}if(typeof i!="string")return i;var I=s.length;if(I===0)return i;for(var R="",A=1-f,z=-1,T=i&&i.length||0,F=0;F<T;){if(i.charCodeAt(F)===37&&F+1<T){switch(z=z>-1?z:0,i.charCodeAt(F+1)){case 100:case 102:if(A>=I||s[A]==null)break;z<F&&(R+=i.slice(z,F)),R+=Number(s[A]),z=F+2,F++;break;case 105:if(A>=I||s[A]==null)break;z<F&&(R+=i.slice(z,F)),R+=Math.floor(Number(s[A])),z=F+2,F++;break;case 79:case 111:case 106:if(A>=I||s[A]===void 0)break;z<F&&(R+=i.slice(z,F));var re=typeof s[A];if(re==="string"){R+="'"+s[A]+"'",z=F+2,F++;break}if(re==="function"){R+=s[A].name||"<anonymous>",z=F+2,F++;break}R+=h(s[A]),z=F+2,F++;break;case 115:if(A>=I)break;z<F&&(R+=i.slice(z,F)),R+=String(s[A]),z=F+2,F++;break;case 37:z<F&&(R+=i.slice(z,F)),R+="%",z=F+2,F++,A--;break}++A}++F}return z===-1?i:(z<T&&(R+=i.slice(z)),R)}return ac}var cc,il;function t_(){if(il)return cc;il=1;const a=e_();cc=o;const t=de().console||{},i={mapHttpRequest:T,mapHttpResponse:T,wrapRequestSerializer:F,wrapResponseSerializer:F,wrapErrorSerializer:F,req:T,res:T,err:A};function s($,H){return Array.isArray($)?$.filter(function(ye){return ye!=="!stdSerializers.err"}):$===!0?Object.keys(H):!1}function o($){$=$||{},$.browser=$.browser||{};const H=$.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const W=$.browser.write||t;$.browser.write&&($.browser.asObject=!0);const ye=$.serializers||{},ie=s($.browser.serialize,ye);let ue=$.browser.serialize;Array.isArray($.browser.serialize)&&$.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),$.enabled===!1&&($.level="silent");const Ue=$.level||"info",m=Object.create(W);m.log||(m.log=re),Object.defineProperty(m,"levelVal",{get:X}),Object.defineProperty(m,"level",{get:ce,set:V});const x={transmit:H,serialize:ie,asObject:$.browser.asObject,levels:Te,timestamp:z($)};m.levels=o.levels,m.level=Ue,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=re,m.serializers=ye,m._serialize=ie,m._stdErrSerialize=ue,m.child=k,H&&(m._logEvent=R());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(B){if(B!=="silent"&&!this.levels.values[B])throw Error("unknown level "+B);this._level=B,h(x,m,"error","log"),h(x,m,"fatal","error"),h(x,m,"warn","error"),h(x,m,"info","log"),h(x,m,"debug","log"),h(x,m,"trace","log")}function k(B,G){if(!B)throw new Error("missing bindings for child Pino");G=G||{},ie&&B.serializers&&(G.serializers=B.serializers);const Qe=G.serializers;if(ie&&Qe){var Be=Object.assign({},ye,Qe),zr=$.browser.serialize===!0?Object.keys(Be):ie;delete B.serializers,_([B],zr,Be,this._stdErrSerialize)}function Ie(xt){this._childLevel=(xt._childLevel|0)+1,this.error=v(xt,B,"error"),this.fatal=v(xt,B,"fatal"),this.warn=v(xt,B,"warn"),this.info=v(xt,B,"info"),this.debug=v(xt,B,"debug"),this.trace=v(xt,B,"trace"),Be&&(this.serializers=Be,this._serialize=zr),H&&(this._logEvent=R([].concat(xt._logEvent.bindings,B)))}return Ie.prototype=this,new Ie(this)}return m}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function h($,H,W,ye){const ie=Object.getPrototypeOf(H);H[W]=H.levelVal>H.levels.values[W]?re:ie[W]?ie[W]:t[W]||t[ye]||re,f($,H,W)}function f($,H,W){!$.transmit&&H[W]===re||(H[W]=function(ye){return function(){const ue=$.timestamp(),Te=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var m=0;m<Te.length;m++)Te[m]=arguments[m];if($.serialize&&!$.asObject&&_(Te,this._serialize,this.serializers,this._stdErrSerialize),$.asObject?ye.call(Ue,g(this,W,Te,ue)):ye.apply(Ue,Te),$.transmit){const x=$.transmit.level||H.level,X=o.levels.values[x],ce=o.levels.values[W];if(ce<X)return;I(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:x,transmitValue:o.levels.values[$.transmit.level||H.level],send:$.transmit.send,val:H.levelVal},Te)}}}(H[W]))}function g($,H,W,ye){$._serialize&&_(W,$._serialize,$.serializers,$._stdErrSerialize);const ie=W.slice();let ue=ie[0];const Te={};ye&&(Te.time=ye),Te.level=o.levels.values[H];let Ue=($._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof ie[0]=="object";)Object.assign(Te,ie.shift());ue=ie.length?a(ie.shift(),ie):void 0}else typeof ue=="string"&&(ue=a(ie.shift(),ie));return ue!==void 0&&(Te.msg=ue),Te}function _($,H,W,ye){for(const ie in $)if(ye&&$[ie]instanceof Error)$[ie]=o.stdSerializers.err($[ie]);else if(typeof $[ie]=="object"&&!Array.isArray($[ie]))for(const ue in $[ie])H&&H.indexOf(ue)>-1&&ue in W&&($[ie][ue]=W[ue]($[ie][ue]))}function v($,H,W){return function(){const ye=new Array(1+arguments.length);ye[0]=H;for(var ie=1;ie<ye.length;ie++)ye[ie]=arguments[ie-1];return $[W].apply(this,ye)}}function I($,H,W){const ye=H.send,ie=H.ts,ue=H.methodLevel,Te=H.methodValue,Ue=H.val,m=$._logEvent.bindings;_(W,$._serialize||Object.keys($.serializers),$.serializers,$._stdErrSerialize===void 0?!0:$._stdErrSerialize),$._logEvent.ts=ie,$._logEvent.messages=W.filter(function(x){return m.indexOf(x)===-1}),$._logEvent.level.label=ue,$._logEvent.level.value=Te,ye(ue,$._logEvent,Ue),$._logEvent=R(m)}function R($){return{ts:0,messages:[],bindings:$||[],level:{label:"",value:0}}}function A($){const H={type:$.constructor.name,msg:$.message,stack:$.stack};for(const W in $)H[W]===void 0&&(H[W]=$[W]);return H}function z($){return typeof $.timestamp=="function"?$.timestamp:$.timestamp===!1?he:le}function T(){return{}}function F($){return $}function re(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function $(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return $(self)||$(window)||$(this)||{}}}return cc}var Ki={},sl;function mf(){return sl||(sl=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.PINO_CUSTOM_CONTEXT_KEY=Ki.PINO_LOGGER_DEFAULTS=void 0,Ki.PINO_LOGGER_DEFAULTS={level:"info"},Ki.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ki}var rr={},nl;function r_(){if(nl)return rr;nl=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const a=mf();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||a.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=t;function i(g,_=a.PINO_CUSTOM_CONTEXT_KEY){return g[_]||""}rr.getBrowserLoggerContext=i;function s(g,_,v=a.PINO_CUSTOM_CONTEXT_KEY){return g[v]=_,g}rr.setBrowserLoggerContext=s;function o(g,_=a.PINO_CUSTOM_CONTEXT_KEY){let v="";return typeof g.bindings>"u"?v=i(g,_):v=g.bindings().context||"",v}rr.getLoggerContext=o;function h(g,_,v=a.PINO_CUSTOM_CONTEXT_KEY){const I=o(g,v);return I.trim()?`${I}/${_}`:_}rr.formatChildLoggerContext=h;function f(g,_,v=a.PINO_CUSTOM_CONTEXT_KEY){const I=h(g,_,v),R=g.child({context:I});return s(R,I,v)}return rr.generateChildLogger=f,rr}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const t=bs,i=t.__importDefault(t_());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return i.default}}),t.__exportStar(mf(),a),t.__exportStar(r_(),a)})(Re);class i_ extends Vi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let s_=class extends Vi{constructor(t,i){super(),this.core=t,this.logger=i,this.records=new Map}},n_=class{constructor(t,i){this.logger=t,this.core=i}},o_=class extends Vi{constructor(t,i){super(),this.relayer=t,this.logger=i}},a_=class extends Vi{constructor(t){super()}},c_=class{constructor(t,i,s,o){this.core=t,this.logger=i,this.name=s}};class u_ extends Vi{constructor(t,i){super(),this.relayer=t,this.logger=i}}let h_=class extends Vi{constructor(t,i){super(),this.core=t,this.logger=i}},l_=class{constructor(t,i){this.projectId=t,this.logger=i}},f_=class{constructor(t,i){this.projectId=t,this.logger=i}},p_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},d_=class{constructor(t){this.client=t}};var Tc={},wf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=R0,i=Yl;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},g.prototype.update=function(_,v){if(v===void 0&&(v=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var I=0;if(this._bytesHashed+=v,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&v>0;)this._buffer[this._bufferLength++]=_[I++],v--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(v>=this.blockSize&&(I=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,I,v),v%=this.blockSize);v>0;)this._buffer[this._bufferLength++]=_[I++],v--;return this},g.prototype.finish=function(_){if(!this._finished){var v=this._bytesHashed,I=this._bufferLength,R=v/536870912|0,A=v<<3,z=v%128<112?128:256;this._buffer[I]=128;for(var T=I+1;T<z-8;T++)this._buffer[T]=0;t.writeUint32BE(R,this._buffer,z-8),t.writeUint32BE(A,this._buffer,z-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,z),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],_,T*8),t.writeUint32BE(this._stateLo[T],_,T*8+4);return this},g.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(_){i.wipe(_.stateHi),i.wipe(_.stateLo),_.buffer&&i.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},g}();a.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(g,_,v,I,R,A,z){for(var T=v[0],F=v[1],re=v[2],he=v[3],le=v[4],fe=v[5],pe=v[6],de=v[7],$=I[0],H=I[1],W=I[2],ye=I[3],ie=I[4],ue=I[5],Te=I[6],Ue=I[7],m,x,X,ce,V,k,B,G;z>=128;){for(var Qe=0;Qe<16;Qe++){var Be=8*Qe+A;g[Qe]=t.readUint32BE(R,Be),_[Qe]=t.readUint32BE(R,Be+4)}for(var Qe=0;Qe<80;Qe++){var zr=T,Ie=F,xt=re,D=he,L=le,C=fe,u=pe,E=de,ee=$,ge=H,be=W,Ne=ye,De=ie,Se=ue,Pt=Te,wt=Ue;if(m=de,x=Ue,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=(le>>>14|ie<<18)^(le>>>18|ie<<14)^(ie>>>9|le<<23),x=(ie>>>14|le<<18)^(ie>>>18|le<<14)^(le>>>9|ie<<23),V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,m=le&fe^~le&pe,x=ie&ue^~ie&Te,V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,m=o[Qe*2],x=o[Qe*2+1],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,m=g[Qe%16],x=_[Qe%16],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,X=B&65535|G<<16,ce=V&65535|k<<16,m=X,x=ce,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=(T>>>28|$<<4)^($>>>2|T<<30)^($>>>7|T<<25),x=($>>>28|T<<4)^(T>>>2|$<<30)^(T>>>7|$<<25),V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,m=T&F^T&re^F&re,x=$&H^$&W^H&W,V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,E=B&65535|G<<16,wt=V&65535|k<<16,m=D,x=Ne,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=X,x=ce,V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,D=B&65535|G<<16,Ne=V&65535|k<<16,F=zr,re=Ie,he=xt,le=D,fe=L,pe=C,de=u,T=E,H=ee,W=ge,ye=be,ie=Ne,ue=De,Te=Se,Ue=Pt,$=wt,Qe%16===15)for(var Be=0;Be<16;Be++)m=g[Be],x=_[Be],V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=g[(Be+9)%16],x=_[(Be+9)%16],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,X=g[(Be+1)%16],ce=_[(Be+1)%16],m=(X>>>1|ce<<31)^(X>>>8|ce<<24)^X>>>7,x=(ce>>>1|X<<31)^(ce>>>8|X<<24)^(ce>>>7|X<<25),V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,X=g[(Be+14)%16],ce=_[(Be+14)%16],m=(X>>>19|ce<<13)^(ce>>>29|X<<3)^X>>>6,x=(ce>>>19|X<<13)^(X>>>29|ce<<3)^(ce>>>6|X<<26),V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,g[Be]=B&65535|G<<16,_[Be]=V&65535|k<<16}m=T,x=$,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[0],x=I[0],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[0]=T=B&65535|G<<16,I[0]=$=V&65535|k<<16,m=F,x=H,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[1],x=I[1],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[1]=F=B&65535|G<<16,I[1]=H=V&65535|k<<16,m=re,x=W,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[2],x=I[2],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[2]=re=B&65535|G<<16,I[2]=W=V&65535|k<<16,m=he,x=ye,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[3],x=I[3],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[3]=he=B&65535|G<<16,I[3]=ye=V&65535|k<<16,m=le,x=ie,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[4],x=I[4],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[4]=le=B&65535|G<<16,I[4]=ie=V&65535|k<<16,m=fe,x=ue,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[5],x=I[5],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[5]=fe=B&65535|G<<16,I[5]=ue=V&65535|k<<16,m=pe,x=Te,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[6],x=I[6],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[6]=pe=B&65535|G<<16,I[6]=Te=V&65535|k<<16,m=de,x=Ue,V=x&65535,k=x>>>16,B=m&65535,G=m>>>16,m=v[7],x=I[7],V+=x&65535,k+=x>>>16,B+=m&65535,G+=m>>>16,k+=V>>>16,B+=k>>>16,G+=B>>>16,v[7]=de=B&65535|G<<16,I[7]=Ue=V&65535|k<<16,A+=128,z-=128}return A}function f(g){var _=new s;_.update(g);var v=_.digest();return _.clean(),v}a.hash=f})(wf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=Xl,i=wf,s=Yl;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(D){const L=new Float64Array(16);if(D)for(let C=0;C<D.length;C++)L[C]=D[C];return L}const h=new Uint8Array(32);h[0]=9;const f=o(),g=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),I=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),R=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function z(D,L){for(let C=0;C<16;C++)D[C]=L[C]|0}function T(D){let L=1;for(let C=0;C<16;C++){let u=D[C]+L+65535;L=Math.floor(u/65536),D[C]=u-L*65536}D[0]+=L-1+37*(L-1)}function F(D,L,C){const u=~(C-1);for(let E=0;E<16;E++){const ee=u&(D[E]^L[E]);D[E]^=ee,L[E]^=ee}}function re(D,L){const C=o(),u=o();for(let E=0;E<16;E++)u[E]=L[E];T(u),T(u),T(u);for(let E=0;E<2;E++){C[0]=u[0]-65517;for(let ge=1;ge<15;ge++)C[ge]=u[ge]-65535-(C[ge-1]>>16&1),C[ge-1]&=65535;C[15]=u[15]-32767-(C[14]>>16&1);const ee=C[15]>>16&1;C[14]&=65535,F(u,C,1-ee)}for(let E=0;E<16;E++)D[2*E]=u[E]&255,D[2*E+1]=u[E]>>8}function he(D,L){let C=0;for(let u=0;u<32;u++)C|=D[u]^L[u];return(1&C-1>>>8)-1}function le(D,L){const C=new Uint8Array(32),u=new Uint8Array(32);return re(C,D),re(u,L),he(C,u)}function fe(D){const L=new Uint8Array(32);return re(L,D),L[0]&1}function pe(D,L){for(let C=0;C<16;C++)D[C]=L[2*C]+(L[2*C+1]<<8);D[15]&=32767}function de(D,L,C){for(let u=0;u<16;u++)D[u]=L[u]+C[u]}function $(D,L,C){for(let u=0;u<16;u++)D[u]=L[u]-C[u]}function H(D,L,C){let u,E,ee=0,ge=0,be=0,Ne=0,De=0,Se=0,Pt=0,wt=0,at=0,qe=0,Xe=0,Ze=0,ct=0,He=0,et=0,Le=0,Fe=0,lt=0,je=0,St=0,$t=0,kt=0,Kt=0,jt=0,Qt=0,ir=0,Ur=0,Yt=0,Gr=0,fi=0,Ri=0,ft=C[0],it=C[1],pt=C[2],dt=C[3],ut=C[4],st=C[5],Ot=C[6],Rt=C[7],gt=C[8],Ct=C[9],vt=C[10],_t=C[11],yt=C[12],Ye=C[13],At=C[14],Tt=C[15];u=L[0],ee+=u*ft,ge+=u*it,be+=u*pt,Ne+=u*dt,De+=u*ut,Se+=u*st,Pt+=u*Ot,wt+=u*Rt,at+=u*gt,qe+=u*Ct,Xe+=u*vt,Ze+=u*_t,ct+=u*yt,He+=u*Ye,et+=u*At,Le+=u*Tt,u=L[1],ge+=u*ft,be+=u*it,Ne+=u*pt,De+=u*dt,Se+=u*ut,Pt+=u*st,wt+=u*Ot,at+=u*Rt,qe+=u*gt,Xe+=u*Ct,Ze+=u*vt,ct+=u*_t,He+=u*yt,et+=u*Ye,Le+=u*At,Fe+=u*Tt,u=L[2],be+=u*ft,Ne+=u*it,De+=u*pt,Se+=u*dt,Pt+=u*ut,wt+=u*st,at+=u*Ot,qe+=u*Rt,Xe+=u*gt,Ze+=u*Ct,ct+=u*vt,He+=u*_t,et+=u*yt,Le+=u*Ye,Fe+=u*At,lt+=u*Tt,u=L[3],Ne+=u*ft,De+=u*it,Se+=u*pt,Pt+=u*dt,wt+=u*ut,at+=u*st,qe+=u*Ot,Xe+=u*Rt,Ze+=u*gt,ct+=u*Ct,He+=u*vt,et+=u*_t,Le+=u*yt,Fe+=u*Ye,lt+=u*At,je+=u*Tt,u=L[4],De+=u*ft,Se+=u*it,Pt+=u*pt,wt+=u*dt,at+=u*ut,qe+=u*st,Xe+=u*Ot,Ze+=u*Rt,ct+=u*gt,He+=u*Ct,et+=u*vt,Le+=u*_t,Fe+=u*yt,lt+=u*Ye,je+=u*At,St+=u*Tt,u=L[5],Se+=u*ft,Pt+=u*it,wt+=u*pt,at+=u*dt,qe+=u*ut,Xe+=u*st,Ze+=u*Ot,ct+=u*Rt,He+=u*gt,et+=u*Ct,Le+=u*vt,Fe+=u*_t,lt+=u*yt,je+=u*Ye,St+=u*At,$t+=u*Tt,u=L[6],Pt+=u*ft,wt+=u*it,at+=u*pt,qe+=u*dt,Xe+=u*ut,Ze+=u*st,ct+=u*Ot,He+=u*Rt,et+=u*gt,Le+=u*Ct,Fe+=u*vt,lt+=u*_t,je+=u*yt,St+=u*Ye,$t+=u*At,kt+=u*Tt,u=L[7],wt+=u*ft,at+=u*it,qe+=u*pt,Xe+=u*dt,Ze+=u*ut,ct+=u*st,He+=u*Ot,et+=u*Rt,Le+=u*gt,Fe+=u*Ct,lt+=u*vt,je+=u*_t,St+=u*yt,$t+=u*Ye,kt+=u*At,Kt+=u*Tt,u=L[8],at+=u*ft,qe+=u*it,Xe+=u*pt,Ze+=u*dt,ct+=u*ut,He+=u*st,et+=u*Ot,Le+=u*Rt,Fe+=u*gt,lt+=u*Ct,je+=u*vt,St+=u*_t,$t+=u*yt,kt+=u*Ye,Kt+=u*At,jt+=u*Tt,u=L[9],qe+=u*ft,Xe+=u*it,Ze+=u*pt,ct+=u*dt,He+=u*ut,et+=u*st,Le+=u*Ot,Fe+=u*Rt,lt+=u*gt,je+=u*Ct,St+=u*vt,$t+=u*_t,kt+=u*yt,Kt+=u*Ye,jt+=u*At,Qt+=u*Tt,u=L[10],Xe+=u*ft,Ze+=u*it,ct+=u*pt,He+=u*dt,et+=u*ut,Le+=u*st,Fe+=u*Ot,lt+=u*Rt,je+=u*gt,St+=u*Ct,$t+=u*vt,kt+=u*_t,Kt+=u*yt,jt+=u*Ye,Qt+=u*At,ir+=u*Tt,u=L[11],Ze+=u*ft,ct+=u*it,He+=u*pt,et+=u*dt,Le+=u*ut,Fe+=u*st,lt+=u*Ot,je+=u*Rt,St+=u*gt,$t+=u*Ct,kt+=u*vt,Kt+=u*_t,jt+=u*yt,Qt+=u*Ye,ir+=u*At,Ur+=u*Tt,u=L[12],ct+=u*ft,He+=u*it,et+=u*pt,Le+=u*dt,Fe+=u*ut,lt+=u*st,je+=u*Ot,St+=u*Rt,$t+=u*gt,kt+=u*Ct,Kt+=u*vt,jt+=u*_t,Qt+=u*yt,ir+=u*Ye,Ur+=u*At,Yt+=u*Tt,u=L[13],He+=u*ft,et+=u*it,Le+=u*pt,Fe+=u*dt,lt+=u*ut,je+=u*st,St+=u*Ot,$t+=u*Rt,kt+=u*gt,Kt+=u*Ct,jt+=u*vt,Qt+=u*_t,ir+=u*yt,Ur+=u*Ye,Yt+=u*At,Gr+=u*Tt,u=L[14],et+=u*ft,Le+=u*it,Fe+=u*pt,lt+=u*dt,je+=u*ut,St+=u*st,$t+=u*Ot,kt+=u*Rt,Kt+=u*gt,jt+=u*Ct,Qt+=u*vt,ir+=u*_t,Ur+=u*yt,Yt+=u*Ye,Gr+=u*At,fi+=u*Tt,u=L[15],Le+=u*ft,Fe+=u*it,lt+=u*pt,je+=u*dt,St+=u*ut,$t+=u*st,kt+=u*Ot,Kt+=u*Rt,jt+=u*gt,Qt+=u*Ct,ir+=u*vt,Ur+=u*_t,Yt+=u*yt,Gr+=u*Ye,fi+=u*At,Ri+=u*Tt,ee+=38*Fe,ge+=38*lt,be+=38*je,Ne+=38*St,De+=38*$t,Se+=38*kt,Pt+=38*Kt,wt+=38*jt,at+=38*Qt,qe+=38*ir,Xe+=38*Ur,Ze+=38*Yt,ct+=38*Gr,He+=38*fi,et+=38*Ri,E=1,u=ee+E+65535,E=Math.floor(u/65536),ee=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=be+E+65535,E=Math.floor(u/65536),be=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=De+E+65535,E=Math.floor(u/65536),De=u-E*65536,u=Se+E+65535,E=Math.floor(u/65536),Se=u-E*65536,u=Pt+E+65535,E=Math.floor(u/65536),Pt=u-E*65536,u=wt+E+65535,E=Math.floor(u/65536),wt=u-E*65536,u=at+E+65535,E=Math.floor(u/65536),at=u-E*65536,u=qe+E+65535,E=Math.floor(u/65536),qe=u-E*65536,u=Xe+E+65535,E=Math.floor(u/65536),Xe=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=ct+E+65535,E=Math.floor(u/65536),ct=u-E*65536,u=He+E+65535,E=Math.floor(u/65536),He=u-E*65536,u=et+E+65535,E=Math.floor(u/65536),et=u-E*65536,u=Le+E+65535,E=Math.floor(u/65536),Le=u-E*65536,ee+=E-1+37*(E-1),E=1,u=ee+E+65535,E=Math.floor(u/65536),ee=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=be+E+65535,E=Math.floor(u/65536),be=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=De+E+65535,E=Math.floor(u/65536),De=u-E*65536,u=Se+E+65535,E=Math.floor(u/65536),Se=u-E*65536,u=Pt+E+65535,E=Math.floor(u/65536),Pt=u-E*65536,u=wt+E+65535,E=Math.floor(u/65536),wt=u-E*65536,u=at+E+65535,E=Math.floor(u/65536),at=u-E*65536,u=qe+E+65535,E=Math.floor(u/65536),qe=u-E*65536,u=Xe+E+65535,E=Math.floor(u/65536),Xe=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=ct+E+65535,E=Math.floor(u/65536),ct=u-E*65536,u=He+E+65535,E=Math.floor(u/65536),He=u-E*65536,u=et+E+65535,E=Math.floor(u/65536),et=u-E*65536,u=Le+E+65535,E=Math.floor(u/65536),Le=u-E*65536,ee+=E-1+37*(E-1),D[0]=ee,D[1]=ge,D[2]=be,D[3]=Ne,D[4]=De,D[5]=Se,D[6]=Pt,D[7]=wt,D[8]=at,D[9]=qe,D[10]=Xe,D[11]=Ze,D[12]=ct,D[13]=He,D[14]=et,D[15]=Le}function W(D,L){H(D,L,L)}function ye(D,L){const C=o();let u;for(u=0;u<16;u++)C[u]=L[u];for(u=253;u>=0;u--)W(C,C),u!==2&&u!==4&&H(C,C,L);for(u=0;u<16;u++)D[u]=C[u]}function ie(D,L){const C=o();let u;for(u=0;u<16;u++)C[u]=L[u];for(u=250;u>=0;u--)W(C,C),u!==1&&H(C,C,L);for(u=0;u<16;u++)D[u]=C[u]}function ue(D,L){const C=o(),u=o(),E=o(),ee=o(),ge=o(),be=o(),Ne=o(),De=o(),Se=o();$(C,D[1],D[0]),$(Se,L[1],L[0]),H(C,C,Se),de(u,D[0],D[1]),de(Se,L[0],L[1]),H(u,u,Se),H(E,D[3],L[3]),H(E,E,v),H(ee,D[2],L[2]),de(ee,ee,ee),$(ge,u,C),$(be,ee,E),de(Ne,ee,E),de(De,u,C),H(D[0],ge,be),H(D[1],De,Ne),H(D[2],Ne,be),H(D[3],ge,De)}function Te(D,L,C){for(let u=0;u<4;u++)F(D[u],L[u],C)}function Ue(D,L){const C=o(),u=o(),E=o();ye(E,L[2]),H(C,L[0],E),H(u,L[1],E),re(D,u),D[31]^=fe(C)<<7}function m(D,L,C){z(D[0],f),z(D[1],g),z(D[2],g),z(D[3],f);for(let u=255;u>=0;--u){const E=C[u/8|0]>>(u&7)&1;Te(D,L,E),ue(L,D),ue(D,D),Te(D,L,E)}}function x(D,L){const C=[o(),o(),o(),o()];z(C[0],I),z(C[1],R),z(C[2],g),H(C[3],I,R),m(D,C,L)}function X(D){if(D.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const L=(0,i.hash)(D);L[0]&=248,L[31]&=127,L[31]|=64;const C=new Uint8Array(32),u=[o(),o(),o(),o()];x(u,L),Ue(C,u);const E=new Uint8Array(64);return E.set(D),E.set(C,32),{publicKey:C,secretKey:E}}a.generateKeyPairFromSeed=X;function ce(D){const L=(0,t.randomBytes)(32,D),C=X(L);return(0,s.wipe)(L),C}a.generateKeyPair=ce;function V(D){if(D.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}a.extractPublicKeyFromSecretKey=V;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(D,L){let C,u,E,ee;for(u=63;u>=32;--u){for(C=0,E=u-32,ee=u-12;E<ee;++E)L[E]+=C-16*L[u]*k[E-(u-32)],C=Math.floor((L[E]+128)/256),L[E]-=C*256;L[E]+=C,L[u]=0}for(C=0,E=0;E<32;E++)L[E]+=C-(L[31]>>4)*k[E],C=L[E]>>8,L[E]&=255;for(E=0;E<32;E++)L[E]-=C*k[E];for(u=0;u<32;u++)L[u+1]+=L[u]>>8,D[u]=L[u]&255}function G(D){const L=new Float64Array(64);for(let C=0;C<64;C++)L[C]=D[C];for(let C=0;C<64;C++)D[C]=0;B(D,L)}function Qe(D,L){const C=new Float64Array(64),u=[o(),o(),o(),o()],E=(0,i.hash)(D.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const ee=new Uint8Array(64);ee.set(E.subarray(32),32);const ge=new i.SHA512;ge.update(ee.subarray(32)),ge.update(L);const be=ge.digest();ge.clean(),G(be),x(u,be),Ue(ee,u),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(D.subarray(32)),ge.update(L);const Ne=ge.digest();G(Ne);for(let De=0;De<32;De++)C[De]=be[De];for(let De=0;De<32;De++)for(let Se=0;Se<32;Se++)C[De+Se]+=Ne[De]*E[Se];return B(ee.subarray(32),C),ee}a.sign=Qe;function Be(D,L){const C=o(),u=o(),E=o(),ee=o(),ge=o(),be=o(),Ne=o();return z(D[2],g),pe(D[1],L),W(E,D[1]),H(ee,E,_),$(E,E,D[2]),de(ee,D[2],ee),W(ge,ee),W(be,ge),H(Ne,be,ge),H(C,Ne,E),H(C,C,ee),ie(C,C),H(C,C,E),H(C,C,ee),H(C,C,ee),H(D[0],C,ee),W(u,D[0]),H(u,u,ee),le(u,E)&&H(D[0],D[0],A),W(u,D[0]),H(u,u,ee),le(u,E)?-1:(fe(D[0])===L[31]>>7&&$(D[0],f,D[0]),H(D[3],D[0],D[1]),0)}function zr(D,L,C){const u=new Uint8Array(32),E=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(C.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Be(ee,D))return!1;const ge=new i.SHA512;ge.update(C.subarray(0,32)),ge.update(D),ge.update(L);const be=ge.digest();return G(be),m(E,ee,be),x(ee,C.subarray(32)),ue(E,ee),Ue(u,E),!he(C,u)}a.verify=zr;function Ie(D){let L=[o(),o(),o(),o()];if(Be(L,D))throw new Error("Ed25519: invalid public key");let C=o(),u=o(),E=L[1];de(C,g,E),$(u,g,E),ye(u,u),H(C,C,u);let ee=new Uint8Array(32);return re(ee,C),ee}a.convertPublicKeyToX25519=Ie;function xt(D){const L=(0,i.hash)(D.subarray(0,32));L[0]&=248,L[31]&=127,L[31]|=64;const C=new Uint8Array(L.subarray(0,32));return(0,s.wipe)(L),C}a.convertSecretKeyToX25519=xt})(Tc);const g_="EdDSA",v_="JWT",_f=".",bf="base64url",y_="utf8",m_="utf8",w_=":",__="did",b_="key",ol="base58btc",E_="z",I_="K36",x_=32;function _o(a){return xo(Rc(Bi(a),y_),bf)}function Ef(a){const t=Rc(I_,ol),i=E_+xo(C0([t,a]),ol);return[__,b_,i].join(w_)}function P_(a){return xo(a,bf)}function S_(a){return Rc([_o(a.header),_o(a.payload)].join(_f),m_)}function O_(a){return[_o(a.header),_o(a.payload),P_(a.signature)].join(_f)}function al(a=Xl.randomBytes(x_)){return Tc.generateKeyPairFromSeed(a)}async function R_(a,t,i,s,o=se.fromMiliseconds(Date.now())){const h={alg:g_,typ:v_},f=Ef(s.publicKey),g=o+i,_={iss:f,sub:a,aud:t,iat:o,exp:g},v=S_({header:h,payload:_}),I=Tc.sign(s.secretKey,v);return O_({header:h,payload:_,signature:I})}const C_="PARSE_ERROR",A_="INVALID_REQUEST",T_="METHOD_NOT_FOUND",N_="INVALID_PARAMS",If="INTERNAL_ERROR",Nc="SERVER_ERROR",L_=[-32700,-32600,-32601,-32602,-32603],Xs={[C_]:{code:-32700,message:"Parse error"},[A_]:{code:-32600,message:"Invalid Request"},[T_]:{code:-32601,message:"Method not found"},[N_]:{code:-32602,message:"Invalid params"},[If]:{code:-32603,message:"Internal error"},[Nc]:{code:-32e3,message:"Server error"}},xf=Nc;function D_(a){return L_.includes(a)}function cl(a){return Object.keys(Xs).includes(a)?Xs[a]:Xs[xf]}function $_(a){const t=Object.values(Xs).find(i=>i.code===a);return t||Xs[xf]}function Pf(a,t,i){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${t}`):a}var Sf={},ni={},ul;function q_(){if(ul)return ni;ul=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(jr===null||jr===void 0?void 0:jr.crypto)||(jr===null||jr===void 0?void 0:jr.msCrypto)||{}}ni.getBrowerCrypto=a;function t(){const s=a();return s.subtle||s.webkitSubtle}ni.getSubtleCrypto=t;function i(){return!!a()&&!!t()}return ni.isBrowserCryptoAvailable=i,ni}var oi={},hl;function M_(){if(hl)return oi;hl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowser=oi.isNode=oi.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}oi.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}oi.isNode=t;function i(){return!a()&&!t()}return oi.isBrowser=i,oi}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=bs;t.__exportStar(q_(),a),t.__exportStar(M_(),a)})(Sf);function Lc(a=3){const t=Date.now()*Math.pow(10,a),i=Math.floor(Math.random()*Math.pow(10,a));return t+i}function Of(a=6){return BigInt(Lc(a))}function ws(a,t,i){return{id:i||Lc(),jsonrpc:"2.0",method:a,params:t}}function So(a,t){return{id:a,jsonrpc:"2.0",result:t}}function Oo(a,t,i){return{id:a,jsonrpc:"2.0",error:j_(t,i)}}function j_(a,t){return typeof a>"u"?cl(If):(typeof a=="string"&&(a=Object.assign(Object.assign({},cl(Nc)),{message:a})),typeof t<"u"&&(a.data=t),D_(a.code)&&(a=$_(a.code)),a)}class z_{}class U_ extends z_{constructor(){super()}}class H_ extends U_{constructor(t){super()}}const k_="^https?:",K_="^wss?:";function B_(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Rf(a,t){const i=B_(a);return typeof i>"u"?!1:new RegExp(t).test(i)}function ll(a){return Rf(a,k_)}function fl(a){return Rf(a,K_)}function F_(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Cf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Dc(a){return Cf(a)&&"method"in a}function Ro(a){return Cf(a)&&(ui(a)||Mr(a))}function ui(a){return"result"in a}function Mr(a){return"error"in a}class hi extends H_{constructor(t){super(t),this.events=new mr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(ws(t.method,t.params||[],t.id||Of().toString()),i)}async requestStrict(t,i){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${t.id}`,h=>{Mr(h)?o(h.error):s(h.result)});try{await this.connection.send(t,i)}catch(h){o(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ro(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const V_=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof globalThis.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),G_=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",pl=a=>a.split("?")[0],dl=10,W_=V_();let J_=class{constructor(t){if(this.url=t,this.events=new mr.EventEmitter,this.registering=!1,!fl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bi(t))}catch(i){this.onError(t.id,i)}}register(t=this.url){if(!fl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((s,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((i,s)=>{const o=new URLSearchParams(t).get("origin"),h=Sf.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!F_(t)},f=new W_(t,[],h);G_()?f.onerror=g=>{const _=g;s(this.emitError(_.error))}:f.on("error",g=>{s(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),i(f)}})}onOpen(t){t.onmessage=i=>this.onPayload(i),t.onclose=i=>this.onClose(i),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?tn(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const s=this.parseError(i),o=s.message||s.toString(),h=Oo(t,o);this.events.emit("payload",h)}parseError(t,i=this.url){return Pf(t,pl(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>dl&&this.events.setMaxListeners(dl)}emitError(t){const i=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${pl(this.url)}`));return this.events.emit("register_error",i),i}};var bo={exports:{}};bo.exports;(function(a,t){var i=200,s="__lodash_hash_undefined__",o=1,h=2,f=9007199254740991,g="[object Arguments]",_="[object Array]",v="[object AsyncFunction]",I="[object Boolean]",R="[object Date]",A="[object Error]",z="[object Function]",T="[object GeneratorFunction]",F="[object Map]",re="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",$="[object Set]",H="[object String]",W="[object Symbol]",ye="[object Undefined]",ie="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",Ue="[object Float32Array]",m="[object Float64Array]",x="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",k="[object Uint8ClampedArray]",B="[object Uint16Array]",G="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,zr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[Ue]=Ie[m]=Ie[x]=Ie[X]=Ie[ce]=Ie[V]=Ie[k]=Ie[B]=Ie[G]=!0,Ie[g]=Ie[_]=Ie[ue]=Ie[I]=Ie[Te]=Ie[R]=Ie[A]=Ie[z]=Ie[F]=Ie[re]=Ie[le]=Ie[de]=Ie[$]=Ie[H]=Ie[ie]=!1;var xt=typeof jr=="object"&&jr&&jr.Object===Object&&jr,D=typeof self=="object"&&self&&self.Object===Object&&self,L=xt||D||Function("return this")(),C=t&&!t.nodeType&&t,u=C&&!0&&a&&!a.nodeType&&a,E=u&&u.exports===C,ee=E&&xt.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=ge&&ge.isTypedArray;function Ne(y,P){for(var U=-1,Q=y==null?0:y.length,Ge=0,me=[];++U<Q;){var tt=y[U];P(tt,U,y)&&(me[Ge++]=tt)}return me}function De(y,P){for(var U=-1,Q=P.length,Ge=y.length;++U<Q;)y[Ge+U]=P[U];return y}function Se(y,P){for(var U=-1,Q=y==null?0:y.length;++U<Q;)if(P(y[U],U,y))return!0;return!1}function Pt(y,P){for(var U=-1,Q=Array(y);++U<y;)Q[U]=P(U);return Q}function wt(y){return function(P){return y(P)}}function at(y,P){return y.has(P)}function qe(y,P){return y==null?void 0:y[P]}function Xe(y){var P=-1,U=Array(y.size);return y.forEach(function(Q,Ge){U[++P]=[Ge,Q]}),U}function Ze(y,P){return function(U){return y(P(U))}}function ct(y){var P=-1,U=Array(y.size);return y.forEach(function(Q){U[++P]=Q}),U}var He=Array.prototype,et=Function.prototype,Le=Object.prototype,Fe=L["__core-js_shared__"],lt=et.toString,je=Le.hasOwnProperty,St=function(){var y=/[^.]+$/.exec(Fe&&Fe.keys&&Fe.keys.IE_PROTO||"");return y?"Symbol(src)_1."+y:""}(),$t=Le.toString,kt=RegExp("^"+lt.call(je).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Kt=E?L.Buffer:void 0,jt=L.Symbol,Qt=L.Uint8Array,ir=Le.propertyIsEnumerable,Ur=He.splice,Yt=jt?jt.toStringTag:void 0,Gr=Object.getOwnPropertySymbols,fi=Kt?Kt.isBuffer:void 0,Ri=Ze(Object.keys,Object),ft=fr(L,"DataView"),it=fr(L,"Map"),pt=fr(L,"Promise"),dt=fr(L,"Set"),ut=fr(L,"WeakMap"),st=fr(Object,"create"),Ot=Jr(ft),Rt=Jr(it),gt=Jr(pt),Ct=Jr(dt),vt=Jr(ut),_t=jt?jt.prototype:void 0,yt=_t?_t.valueOf:void 0;function Ye(y){var P=-1,U=y==null?0:y.length;for(this.clear();++P<U;){var Q=y[P];this.set(Q[0],Q[1])}}function At(){this.__data__=st?st(null):{},this.size=0}function Tt(y){var P=this.has(y)&&delete this.__data__[y];return this.size-=P?1:0,P}function To(y){var P=this.__data__;if(st){var U=P[y];return U===s?void 0:U}return je.call(P,y)?P[y]:void 0}function No(y){var P=this.__data__;return st?P[y]!==void 0:je.call(P,y)}function Lo(y,P){var U=this.__data__;return this.size+=this.has(y)?0:1,U[y]=st&&P===void 0?s:P,this}Ye.prototype.clear=At,Ye.prototype.delete=Tt,Ye.prototype.get=To,Ye.prototype.has=No,Ye.prototype.set=Lo;function wr(y){var P=-1,U=y==null?0:y.length;for(this.clear();++P<U;){var Q=y[P];this.set(Q[0],Q[1])}}function Do(){this.__data__=[],this.size=0}function $o(y){var P=this.__data__,U=Ci(P,y);if(U<0)return!1;var Q=P.length-1;return U==Q?P.pop():Ur.call(P,U,1),--this.size,!0}function qo(y){var P=this.__data__,U=Ci(P,y);return U<0?void 0:P[U][1]}function Mo(y){return Ci(this.__data__,y)>-1}function jo(y,P){var U=this.__data__,Q=Ci(U,y);return Q<0?(++this.size,U.push([y,P])):U[Q][1]=P,this}wr.prototype.clear=Do,wr.prototype.delete=$o,wr.prototype.get=qo,wr.prototype.has=Mo,wr.prototype.set=jo;function Wr(y){var P=-1,U=y==null?0:y.length;for(this.clear();++P<U;){var Q=y[P];this.set(Q[0],Q[1])}}function Wi(){this.size=0,this.__data__={hash:new Ye,map:new(it||wr),string:new Ye}}function zo(y){var P=pi(this,y).delete(y);return this.size-=P?1:0,P}function Ji(y){return pi(this,y).get(y)}function Uo(y){return pi(this,y).has(y)}function Ho(y,P){var U=pi(this,y),Q=U.size;return U.set(y,P),this.size+=U.size==Q?0:1,this}Wr.prototype.clear=Wi,Wr.prototype.delete=zo,Wr.prototype.get=Ji,Wr.prototype.has=Uo,Wr.prototype.set=Ho;function Qi(y){var P=-1,U=y==null?0:y.length;for(this.__data__=new Wr;++P<U;)this.add(y[P])}function sn(y){return this.__data__.set(y,s),this}function nn(y){return this.__data__.has(y)}Qi.prototype.add=Qi.prototype.push=sn,Qi.prototype.has=nn;function Cr(y){var P=this.__data__=new wr(y);this.size=P.size}function ko(){this.__data__=new wr,this.size=0}function Ko(y){var P=this.__data__,U=P.delete(y);return this.size=P.size,U}function Bo(y){return this.__data__.get(y)}function Fo(y){return this.__data__.has(y)}function on(y,P){var U=this.__data__;if(U instanceof wr){var Q=U.__data__;if(!it||Q.length<i-1)return Q.push([y,P]),this.size=++U.size,this;U=this.__data__=new Wr(Q)}return U.set(y,P),this.size=U.size,this}Cr.prototype.clear=ko,Cr.prototype.delete=Ko,Cr.prototype.get=Bo,Cr.prototype.has=Fo,Cr.prototype.set=on;function an(y,P){var U=Zi(y),Q=!U&&wn(y),Ge=!U&&!Q&&Ps(y),me=!U&&!Q&&!Ge&&En(y),tt=U||Q||Ge||me,Nt=tt?Pt(y.length,String):[],Ce=Nt.length;for(var We in y)(P||je.call(y,We))&&!(tt&&(We=="length"||Ge&&(We=="offset"||We=="parent")||me&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||dn(We,Ce)))&&Nt.push(We);return Nt}function Ci(y,P){for(var U=y.length;U--;)if(mn(y[U][0],P))return U;return-1}function Is(y,P,U){var Q=P(y);return Zi(y)?Q:De(Q,U(y))}function Ai(y){return y==null?y===void 0?ye:he:Yt&&Yt in Object(y)?fn(y):Wo(y)}function xs(y){return Ni(y)&&Ai(y)==g}function Ti(y,P,U,Q,Ge){return y===P?!0:y==null||P==null||!Ni(y)&&!Ni(P)?y!==y&&P!==P:cn(y,P,U,Q,Ti,Ge)}function cn(y,P,U,Q,Ge,me){var tt=Zi(y),Nt=Zi(P),Ce=tt?_:Hr(y),We=Nt?_:Hr(P);Ce=Ce==g?le:Ce,We=We==g?le:We;var bt=Ce==le,sr=We==le,Lt=Ce==We;if(Lt&&Ps(y)){if(!Ps(P))return!1;tt=!0,bt=!1}if(Lt&&!bt)return me||(me=new Cr),tt||En(y)?Yi(y,P,U,Q,Ge,me):Go(y,P,Ce,U,Q,Ge,me);if(!(U&o)){var rt=bt&&je.call(y,"__wrapped__"),Xt=sr&&je.call(P,"__wrapped__");if(rt||Xt){var Ar=rt?y.value():y,_r=Xt?P.value():P;return me||(me=new Cr),Ge(Ar,_r,U,Q,me)}}return Lt?(me||(me=new Cr),ln(y,P,U,Q,Ge,me)):!1}function Vo(y){if(!bn(y)||vn(y))return!1;var P=es(y)?kt:Be;return P.test(Jr(y))}function un(y){return Ni(y)&&_n(y.length)&&!!Ie[Ai(y)]}function hn(y){if(!yn(y))return Ri(y);var P=[];for(var U in Object(y))je.call(y,U)&&U!="constructor"&&P.push(U);return P}function Yi(y,P,U,Q,Ge,me){var tt=U&o,Nt=y.length,Ce=P.length;if(Nt!=Ce&&!(tt&&Ce>Nt))return!1;var We=me.get(y);if(We&&me.get(P))return We==P;var bt=-1,sr=!0,Lt=U&h?new Qi:void 0;for(me.set(y,P),me.set(P,y);++bt<Nt;){var rt=y[bt],Xt=P[bt];if(Q)var Ar=tt?Q(Xt,rt,bt,P,y,me):Q(rt,Xt,bt,y,P,me);if(Ar!==void 0){if(Ar)continue;sr=!1;break}if(Lt){if(!Se(P,function(_r,kr){if(!at(Lt,kr)&&(rt===_r||Ge(rt,_r,U,Q,me)))return Lt.push(kr)})){sr=!1;break}}else if(!(rt===Xt||Ge(rt,Xt,U,Q,me))){sr=!1;break}}return me.delete(y),me.delete(P),sr}function Go(y,P,U,Q,Ge,me,tt){switch(U){case Te:if(y.byteLength!=P.byteLength||y.byteOffset!=P.byteOffset)return!1;y=y.buffer,P=P.buffer;case ue:return!(y.byteLength!=P.byteLength||!me(new Qt(y),new Qt(P)));case I:case R:case re:return mn(+y,+P);case A:return y.name==P.name&&y.message==P.message;case de:case H:return y==P+"";case F:var Nt=Xe;case $:var Ce=Q&o;if(Nt||(Nt=ct),y.size!=P.size&&!Ce)return!1;var We=tt.get(y);if(We)return We==P;Q|=h,tt.set(y,P);var bt=Yi(Nt(y),Nt(P),Q,Ge,me,tt);return tt.delete(y),bt;case W:if(yt)return yt.call(y)==yt.call(P)}return!1}function ln(y,P,U,Q,Ge,me){var tt=U&o,Nt=Xi(y),Ce=Nt.length,We=Xi(P),bt=We.length;if(Ce!=bt&&!tt)return!1;for(var sr=Ce;sr--;){var Lt=Nt[sr];if(!(tt?Lt in P:je.call(P,Lt)))return!1}var rt=me.get(y);if(rt&&me.get(P))return rt==P;var Xt=!0;me.set(y,P),me.set(P,y);for(var Ar=tt;++sr<Ce;){Lt=Nt[sr];var _r=y[Lt],kr=P[Lt];if(Q)var Ss=tt?Q(kr,_r,Lt,P,y,me):Q(_r,kr,Lt,y,P,me);if(!(Ss===void 0?_r===kr||Ge(_r,kr,U,Q,me):Ss)){Xt=!1;break}Ar||(Ar=Lt=="constructor")}if(Xt&&!Ar){var Li=y.constructor,zt=P.constructor;Li!=zt&&"constructor"in y&&"constructor"in P&&!(typeof Li=="function"&&Li instanceof Li&&typeof zt=="function"&&zt instanceof zt)&&(Xt=!1)}return me.delete(y),me.delete(P),Xt}function Xi(y){return Is(y,Yo,pn)}function pi(y,P){var U=y.__data__;return gn(P)?U[typeof P=="string"?"string":"hash"]:U.map}function fr(y,P){var U=qe(y,P);return Vo(U)?U:void 0}function fn(y){var P=je.call(y,Yt),U=y[Yt];try{y[Yt]=void 0;var Q=!0}catch{}var Ge=$t.call(y);return Q&&(P?y[Yt]=U:delete y[Yt]),Ge}var pn=Gr?function(y){return y==null?[]:(y=Object(y),Ne(Gr(y),function(P){return ir.call(y,P)}))}:Ve,Hr=Ai;(ft&&Hr(new ft(new ArrayBuffer(1)))!=Te||it&&Hr(new it)!=F||pt&&Hr(pt.resolve())!=fe||dt&&Hr(new dt)!=$||ut&&Hr(new ut)!=ie)&&(Hr=function(y){var P=Ai(y),U=P==le?y.constructor:void 0,Q=U?Jr(U):"";if(Q)switch(Q){case Ot:return Te;case Rt:return F;case gt:return fe;case Ct:return $;case vt:return ie}return P});function dn(y,P){return P=P??f,!!P&&(typeof y=="number"||zr.test(y))&&y>-1&&y%1==0&&y<P}function gn(y){var P=typeof y;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?y!=="__proto__":y===null}function vn(y){return!!St&&St in y}function yn(y){var P=y&&y.constructor,U=typeof P=="function"&&P.prototype||Le;return y===U}function Wo(y){return $t.call(y)}function Jr(y){if(y!=null){try{return lt.call(y)}catch{}try{return y+""}catch{}}return""}function mn(y,P){return y===P||y!==y&&P!==P}var wn=xs(function(){return arguments}())?xs:function(y){return Ni(y)&&je.call(y,"callee")&&!ir.call(y,"callee")},Zi=Array.isArray;function Jo(y){return y!=null&&_n(y.length)&&!es(y)}var Ps=fi||ke;function Qo(y,P){return Ti(y,P)}function es(y){if(!bn(y))return!1;var P=Ai(y);return P==z||P==T||P==v||P==pe}function _n(y){return typeof y=="number"&&y>-1&&y%1==0&&y<=f}function bn(y){var P=typeof y;return y!=null&&(P=="object"||P=="function")}function Ni(y){return y!=null&&typeof y=="object"}var En=be?wt(be):un;function Yo(y){return Jo(y)?an(y):hn(y)}function Ve(){return[]}function ke(){return!1}a.exports=Qo})(bo,bo.exports);var Q_=bo.exports;const Y_=Io(Q_);function X_(a,t){return t=t||{},new Promise(function(i,s){var o=new XMLHttpRequest,h=[],f=[],g={},_=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:_,headers:{keys:function(){return h},entries:function(){return f},get:function(I){return g[I.toLowerCase()]},has:function(I){return I.toLowerCase()in g}}}};for(var v in o.open(t.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(I,R,A){h.push(R=R.toLowerCase()),f.push([R,A]),g[R]=g[R]?g[R]+","+A:A}),i(_())},o.onerror=s,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(v,t.headers[v]);o.send(t.body||null)})}const Z_=Object.freeze(Object.defineProperty({__proto__:null,default:X_},Symbol.toStringTag,{value:"Module"})),gl=Ql(Z_);var eb=self.fetch||(self.fetch=gl.default||gl);const tb=Io(eb);var rb={};function ib(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),s=0;s<i.length;s++)i[s]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),f=h.charCodeAt(0);if(i[f]!==255)throw new TypeError(h+" is ambiguous");i[f]=o}var g=a.length,_=a.charAt(0),v=Math.log(g)/Math.log(256),I=Math.log(256)/Math.log(g);function R(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var F=0,re=0,he=0,le=T.length;he!==le&&T[he]===0;)he++,F++;for(var fe=(le-he)*I+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=T[he],$=0,H=fe-1;(de!==0||$<re)&&H!==-1;H--,$++)de+=256*pe[H]>>>0,pe[H]=de%g>>>0,de=de/g>>>0;if(de!==0)throw new Error("Non-zero carry");re=$,he++}for(var W=fe-re;W!==fe&&pe[W]===0;)W++;for(var ye=_.repeat(F);W<fe;++W)ye+=a.charAt(pe[W]);return ye}function A(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var F=0;if(T[F]!==" "){for(var re=0,he=0;T[F]===_;)re++,F++;for(var le=(T.length-F)*v+1>>>0,fe=new Uint8Array(le);T[F];){var pe=i[T.charCodeAt(F)];if(pe===255)return;for(var de=0,$=le-1;(pe!==0||de<he)&&$!==-1;$--,de++)pe+=g*fe[$]>>>0,fe[$]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,F++}if(T[F]!==" "){for(var H=le-he;H!==le&&fe[H]===0;)H++;for(var W=new Uint8Array(re+(le-H)),ye=re;H!==le;)W[ye++]=fe[H++];return W}}}function z(T){var F=A(T);if(F)return F;throw new Error(`Non-${t} character`)}return{encode:R,decodeUnsafe:A,decode:z}}var sb=ib,nb=sb;const Af=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},ob=a=>new TextEncoder().encode(a),ab=a=>new TextDecoder().decode(a);class cb{constructor(t,i,s){this.name=t,this.prefix=i,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ub{constructor(t,i,s){if(this.name=t,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Tf(this,t)}}class hb{constructor(t){this.decoders=t}or(t){return Tf(this,t)}decode(t){const i=t[0],s=this.decoders[i];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Tf=(a,t)=>new hb({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class lb{constructor(t,i,s,o){this.name=t,this.prefix=i,this.baseEncode=s,this.baseDecode=o,this.encoder=new cb(t,i,s),this.decoder=new ub(t,i,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Co=({name:a,prefix:t,encode:i,decode:s})=>new lb(a,t,i,s),rn=({prefix:a,name:t,alphabet:i})=>{const{encode:s,decode:o}=nb(i,t);return Co({prefix:a,name:t,encode:s,decode:h=>Af(o(h))})},fb=(a,t,i,s)=>{const o={};for(let I=0;I<t.length;++I)o[t[I]]=I;let h=a.length;for(;a[h-1]==="=";)--h;const f=new Uint8Array(h*i/8|0);let g=0,_=0,v=0;for(let I=0;I<h;++I){const R=o[a[I]];if(R===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<i|R,g+=i,g>=8&&(g-=8,f[v++]=255&_>>g)}if(g>=i||255&_<<8-g)throw new SyntaxError("Unexpected end of data");return f},pb=(a,t,i)=>{const s=t[t.length-1]==="=",o=(1<<i)-1;let h="",f=0,g=0;for(let _=0;_<a.length;++_)for(g=g<<8|a[_],f+=8;f>i;)f-=i,h+=t[o&g>>f];if(f&&(h+=t[o&g<<i-f]),s)for(;h.length*i&7;)h+="=";return h},Ft=({name:a,prefix:t,bitsPerChar:i,alphabet:s})=>Co({prefix:t,name:a,encode(o){return pb(o,s,i)},decode(o){return fb(o,s,i,a)}}),db=Co({prefix:"\0",name:"identity",encode:a=>ab(a),decode:a=>ob(a)});var gb=Object.freeze({__proto__:null,identity:db});const vb=Ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var yb=Object.freeze({__proto__:null,base2:vb});const mb=Ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var wb=Object.freeze({__proto__:null,base8:mb});const _b=rn({prefix:"9",name:"base10",alphabet:"0123456789"});var bb=Object.freeze({__proto__:null,base10:_b});const Eb=Ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ib=Ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var xb=Object.freeze({__proto__:null,base16:Eb,base16upper:Ib});const Pb=Ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Sb=Ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ob=Ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Rb=Ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Cb=Ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ab=Ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Tb=Ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nb=Ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Lb=Ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Db=Object.freeze({__proto__:null,base32:Pb,base32upper:Sb,base32pad:Ob,base32padupper:Rb,base32hex:Cb,base32hexupper:Ab,base32hexpad:Tb,base32hexpadupper:Nb,base32z:Lb});const $b=rn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),qb=rn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Mb=Object.freeze({__proto__:null,base36:$b,base36upper:qb});const jb=rn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zb=rn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ub=Object.freeze({__proto__:null,base58btc:jb,base58flickr:zb});const Hb=Ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),kb=Ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kb=Ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bb=Ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Fb=Object.freeze({__proto__:null,base64:Hb,base64pad:kb,base64url:Kb,base64urlpad:Bb});const Nf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Vb=Nf.reduce((a,t,i)=>(a[i]=t,a),[]),Gb=Nf.reduce((a,t,i)=>(a[t.codePointAt(0)]=i,a),[]);function Wb(a){return a.reduce((t,i)=>(t+=Vb[i],t),"")}function Jb(a){const t=[];for(const i of a){const s=Gb[i.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${i}`);t.push(s)}return new Uint8Array(t)}const Qb=Co({prefix:"🚀",name:"base256emoji",encode:Wb,decode:Jb});var Yb=Object.freeze({__proto__:null,base256emoji:Qb}),Xb=Lf,vl=128,Zb=127,e1=~Zb,t1=Math.pow(2,31);function Lf(a,t,i){t=t||[],i=i||0;for(var s=i;a>=t1;)t[i++]=a&255|vl,a/=128;for(;a&e1;)t[i++]=a&255|vl,a>>>=7;return t[i]=a|0,Lf.bytes=i-s+1,t}var r1=bc,i1=128,yl=127;function bc(a,s){var i=0,s=s||0,o=0,h=s,f,g=a.length;do{if(h>=g)throw bc.bytes=0,new RangeError("Could not decode varint");f=a[h++],i+=o<28?(f&yl)<<o:(f&yl)*Math.pow(2,o),o+=7}while(f>=i1);return bc.bytes=h-s,i}var s1=Math.pow(2,7),n1=Math.pow(2,14),o1=Math.pow(2,21),a1=Math.pow(2,28),c1=Math.pow(2,35),u1=Math.pow(2,42),h1=Math.pow(2,49),l1=Math.pow(2,56),f1=Math.pow(2,63),p1=function(a){return a<s1?1:a<n1?2:a<o1?3:a<a1?4:a<c1?5:a<u1?6:a<h1?7:a<l1?8:a<f1?9:10},d1={encode:Xb,decode:r1,encodingLength:p1},Df=d1;const ml=(a,t,i=0)=>(Df.encode(a,t,i),t),wl=a=>Df.encodingLength(a),Ec=(a,t)=>{const i=t.byteLength,s=wl(a),o=s+wl(i),h=new Uint8Array(o+i);return ml(a,h,0),ml(i,h,s),h.set(t,o),new g1(a,i,t,h)};class g1{constructor(t,i,s,o){this.code=t,this.size=i,this.digest=s,this.bytes=o}}const $f=({name:a,code:t,encode:i})=>new v1(a,t,i);class v1{constructor(t,i,s){this.name=t,this.code=i,this.encode=s}digest(t){if(t instanceof Uint8Array){const i=this.encode(t);return i instanceof Uint8Array?Ec(this.code,i):i.then(s=>Ec(this.code,s))}else throw Error("Unknown type, must be binary type")}}const qf=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),y1=$f({name:"sha2-256",code:18,encode:qf("SHA-256")}),m1=$f({name:"sha2-512",code:19,encode:qf("SHA-512")});var w1=Object.freeze({__proto__:null,sha256:y1,sha512:m1});const Mf=0,_1="identity",jf=Af,b1=a=>Ec(Mf,jf(a)),E1={code:Mf,name:_1,encode:jf,digest:b1};var I1=Object.freeze({__proto__:null,identity:E1});new TextEncoder,new TextDecoder;const _l={...gb,...yb,...wb,...bb,...xb,...Db,...Mb,...Ub,...Fb,...Yb};({...w1,...I1});function zf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function x1(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?zf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Uf(a,t,i,s){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:i},decoder:{decode:s}}}const bl=Uf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),uc=Uf("ascii","a",a=>{let t="a";for(let i=0;i<a.length;i++)t+=String.fromCharCode(a[i]);return t},a=>{a=a.substring(1);const t=x1(a.length);for(let i=0;i<a.length;i++)t[i]=a.charCodeAt(i);return t}),P1={utf8:bl,"utf-8":bl,hex:_l.base16,latin1:uc,ascii:uc,binary:uc,..._l};function S1(a,t="utf8"){const i=P1[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?zf(globalThis.Buffer.from(a,"utf-8")):i.decoder.decode(`${i.prefix}${a}`)}const Hf="wc",O1=2,$c="core",Pi=`${Hf}@2:${$c}:`,R1={name:$c,logger:"error"},C1={database:":memory:"},A1="crypto",El="client_ed25519_seed",T1=se.ONE_DAY,N1="keychain",L1="0.3",D1="messages",$1="0.3",q1=se.SIX_HOURS,M1="publisher",kf="irn",j1="error",Kf="wss://relay.walletconnect.com",Il="wss://relay.walletconnect.org",z1="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},U1="_subscription",ai={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},H1=se.ONE_SECOND,k1="2.11.0",K1=1e4,B1="0.3",F1="WALLETCONNECT_CLIENT_ID",$r={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},V1="subscription",G1="0.3",W1=se.FIVE_SECONDS*1e3,J1="pairing",Q1="0.3",Bs={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},Qs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Vr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Y1="history",X1="0.3",Z1="expirer",Rr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},eE="0.3",hc="verify-api",vs="https://verify.walletconnect.com",Ic="https://verify.walletconnect.org",tE=[vs,Ic],rE="echo",iE="https://echo.walletconnect.com";class sE{constructor(t,i){this.core=t,this.logger=i,this.keychain=new Map,this.name=N1,this.version=L1,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:h}=Y("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,rf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?sf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class nE{constructor(t,i,s){this.core=t,this.logger=i,this.name=A1,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=al(o);return Ef(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=N0();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),f=al(h),g=mc();return await R_(g,o,T1,f)},this.generateSharedKey=(o,h,f)=>{this.isInitialized();const g=this.getPrivateKey(o),_=L0(g,h);return this.setSymKey(_,f)},this.setSymKey=async(o,h)=>{this.isInitialized();const f=h||D0(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,f)=>{this.isInitialized();const g=$0(f),_=Bi(h);if(zh(g)){const A=g.senderPublicKey,z=g.receiverPublicKey;o=await this.generateSharedKey(A,z)}const v=this.getSymKey(o),{type:I,senderPublicKey:R}=g;return q0({type:I,symKey:v,message:_,senderPublicKey:R})},this.decode=async(o,h,f)=>{this.isInitialized();const g=M0(h,f);if(zh(g)){const _=g.receiverPublicKey,v=g.senderPublicKey;o=await this.generateSharedKey(_,v)}try{const _=this.getSymKey(o),v=j0({symKey:_,encoded:h});return tn(v)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const h=Uh(o);return z0(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Uh(o);return h.senderPublicKey?xo(h.senderPublicKey,U0):void 0},this.core=t,this.logger=Re.generateChildLogger(i,this.name),this.keychain=s||new sE(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(t,i){return await this.keychain.set(t,i),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(El)}catch{t=mc(),await this.keychain.set(El,t)}return S1(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class oE extends n_{constructor(t,i){super(t,i),this.logger=t,this.core=i,this.messages=new Map,this.name=D1,this.version=$1,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const h=ys(o);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[h]<"u"||(f[h]=o,this.messages.set(s,f),await this.persist()),h},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const h=this.get(s),f=ys(o);return typeof h[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=i}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,rf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?sf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class aE extends o_{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.events=new mr.EventEmitter,this.name=M1,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,h)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:h}});try{const g=(h==null?void 0:h.ttl)||q1,_=wc(h),v=(h==null?void 0:h.prompt)||!1,I=(h==null?void 0:h.tag)||0,R=(h==null?void 0:h.id)||Of().toString(),A={topic:s,message:o,opts:{ttl:g,relay:_,prompt:v,tag:I,id:R}},z=setTimeout(()=>this.queue.set(R,A),this.publishTimeout);try{await await Zs(this.rpcPublish(s,o,g,_,v,I,R),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(R),this.relayer.events.emit(Jt.publish,A)}catch(T){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=h==null?void 0:h.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(R),T;return}finally{clearTimeout(z)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:h}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Re.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,i,s,o,h,f,g){var _,v,I,R;const A={method:go(o.protocol).publish,params:{topic:t,message:i,ttl:s,prompt:h,tag:f},id:g};return xi((_=A.params)==null?void 0:_.prompt)&&((v=A.params)==null||delete v.prompt),xi((I=A.params)==null?void 0:I.tag)&&((R=A.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.request(A)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:i,message:s,opts:o}=t;await this.publish(i,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Es.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class cE{constructor(){this.map=new Map,this.set=(t,i)=>{const s=this.get(t);this.exists(t,i)||this.map.set(t,[...s,i])},this.get=t=>this.map.get(t)||[],this.exists=(t,i)=>this.get(t).includes(i),this.delete=(t,i)=>{if(typeof i>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,i))return;const o=s.filter(h=>h!==i);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var uE=Object.defineProperty,hE=Object.defineProperties,lE=Object.getOwnPropertyDescriptors,xl=Object.getOwnPropertySymbols,fE=Object.prototype.hasOwnProperty,pE=Object.prototype.propertyIsEnumerable,Pl=(a,t,i)=>t in a?uE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Fs=(a,t)=>{for(var i in t||(t={}))fE.call(t,i)&&Pl(a,i,t[i]);if(xl)for(var i of xl(t))pE.call(t,i)&&Pl(a,i,t[i]);return a},lc=(a,t)=>hE(a,lE(t));class dE extends u_{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.subscriptions=new Map,this.topicMap=new cE,this.events=new mr.EventEmitter,this.name=V1,this.version=G1,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Pi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const h=wc(o),f={topic:s,relay:h};this.pending.set(s,f);const g=await this.rpcSubscribe(s,h);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),g}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,h)=>{const f=new se.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=W1&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Re.generateChildLogger(i,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,i){let s=!1;try{s=this.getSubscription(t).topic===i}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,i){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,i)))}async unsubscribeById(t,i,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:s}});try{const o=wc(s);await this.rpcUnsubscribe(t,i,o);const h=Wt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,i){const s={method:go(i.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Zs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return ys(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const i=t[0].relay,s={method:go(i.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Zs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,i,s){const o={method:go(s.protocol).unsubscribe,params:{topic:t,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,i){this.setSubscription(t,lc(Fs({},i),{id:t})),this.pending.delete(i.topic)}onBatchSubscribe(t){t.length&&t.forEach(i=>{this.setSubscription(i.id,Fs({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(t,i,s){this.events.removeAllListeners(i),this.hasSubscription(i,t)&&this.deleteSubscription(i,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,i){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:i}),this.addSubscription(t,i))}addSubscription(t,i){this.subscriptions.set(t,Fs({},i)),this.topicMap.set(i.topic,t),this.events.emit($r.created,i)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const i=this.subscriptions.get(t);if(!i){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return i}deleteSubscription(t,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:i});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit($r.deleted,lc(Fs({},s),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit($r.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit($r.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:i}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const i=await this.rpcBatchSubscribe(t);_s(i)&&this.onBatchSubscribe(i.map((s,o)=>lc(Fs({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(i=>{t.push(i)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Es.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on($r.created,async t=>{const i=$r.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()}),this.events.on($r.deleted,async t=>{const i=$r.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),t())},this.pollingInterval)})}}var gE=Object.defineProperty,Sl=Object.getOwnPropertySymbols,vE=Object.prototype.hasOwnProperty,yE=Object.prototype.propertyIsEnumerable,Ol=(a,t,i)=>t in a?gE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,mE=(a,t)=>{for(var i in t||(t={}))vE.call(t,i)&&Ol(a,i,t[i]);if(Sl)for(var i of Sl(t))yE.call(t,i)&&Ol(a,i,t[i]);return a};class wE extends a_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new mr.EventEmitter,this.name=z1,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=i=>{this.onProviderPayload(i)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(Jt.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ai.payload,this.onPayloadHandler),this.provider.on(ai.connect,this.onConnectHandler),this.provider.on(ai.disconnect,this.onDisconnectHandler),this.provider.on(ai.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:t.logger||j1})),this.messages=new oE(this.logger,t.core),this.subscriber=new dE(this,this.logger),this.publisher=new aE(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Kf,this.projectId=t.projectId,this.bundleId=H0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Il}...`),await this.restartTransport(Il)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},K1)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,i,s){this.isInitialized(),await this.publisher.publish(t,i,s),await this.recordMessageEvent({topic:t,message:i,publishedAt:Date.now()})}async subscribe(t,i){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(o)return o;let h;const f=g=>{g.topic===t&&(this.subscriber.off($r.created,f),h())};return await Promise.all([new Promise(g=>{h=g,this.subscriber.on($r.created,f)}),new Promise(async g=>{o=await this.subscriber.subscribe(t,i),g()})]),o}async unsubscribe(t,i){this.isInitialized(),await this.subscriber.unsubscribe(t,i)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Zs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(i=>{if(!this.initialized)return i();this.subscriber.once($r.resubscribed,()=>{i()})}),new Promise(async(i,s)=>{try{await Zs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}i()})])}catch(i){this.logger.error(i);const s=i;if(!this.isConnectionStalled(s.message))throw i;this.provider.events.emit(ai.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Hh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(i=>t.includes(i))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new hi(new J_(k0({sdkVersion:k1,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:i,message:s}=t;await this.messages.set(i,s)}async shouldIgnoreMessageEvent(t){const{topic:i,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(i))return this.logger.debug(`Ignoring message for non-subscribed topic ${i}`),!0;const o=this.messages.has(i,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Dc(t)){if(!t.method.endsWith(U1))return;const i=t.params,{topic:s,message:o,publishedAt:h}=i.data,f={topic:s,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(mE({type:"event",event:i.id},f)),this.events.emit(i.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else Ro(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const i=So(t.id,!0);await this.provider.connection.send(i)}unregisterProviderListeners(){this.provider.off(ai.payload,this.onPayloadHandler),this.provider.off(ai.connect,this.onConnectHandler),this.provider.off(ai.disconnect,this.onDisconnectHandler),this.provider.off(ai.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(i=>this.logger.error(i))});let t=await Hh();K0(async i=>{this.initialized&&t!==i&&(t=i,i?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},se.toMiliseconds(H1)))}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var _E=Object.defineProperty,Rl=Object.getOwnPropertySymbols,bE=Object.prototype.hasOwnProperty,EE=Object.prototype.propertyIsEnumerable,Cl=(a,t,i)=>t in a?_E(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Al=(a,t)=>{for(var i in t||(t={}))bE.call(t,i)&&Cl(a,i,t[i]);if(Rl)for(var i of Rl(t))EE.call(t,i)&&Cl(a,i,t[i]);return a};class Ao extends c_{constructor(t,i,s,o=Pi,h=void 0){super(t,i,s,o),this.core=t,this.logger=i,this.name=s,this.map=new Map,this.version=B1,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!xi(f)?this.map.set(this.getKey(f),f):A0(f)?this.map.set(f.id,f):T0(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(_=>Y_(g[_],f[_]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const _=Al(Al({},this.getData(f)),g);this.map.set(f,_),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Re.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const i=this.map.get(t);if(!i){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:i}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class IE{constructor(t,i){this.core=t,this.logger=i,this.name=J1,this.version=Q1,this.events=new Ac,this.initialized=!1,this.storagePrefix=Pi,this.ignoredPayloadTypes=[Zl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=mc(),o=await this.core.crypto.setSymKey(s),h=qr(se.FIVE_MINUTES),f={protocol:kf},g={topic:o,expiry:h,relay:f,active:!1},_=B0({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:f});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:h,relay:f}=kh(s.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const _=qr(se.FIVE_MINUTES),v={topic:o,relay:f,expiry:_,active:!1};return await this.pairings.set(o,v),this.core.expirer.set(o,_),s.activatePairing&&await this.activate({topic:o}),this.events.emit(Qs.create,v),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:f})),v},this.activate=async({topic:s})=>{this.isInitialized();const o=qr(se.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:g,reject:_}=ds();this.events.once(Dt("pairing_ping",h),({error:v})=>{v?_(v):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Wt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,h)=>{const f=ws(o,h),g=await this.core.crypto.encode(s,f),_=Bs[o].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,_),f.id},this.sendResult=async(s,o,h)=>{const f=So(s,h),g=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,s),v=Bs[_.request.method].res;await this.core.relayer.publish(o,g,v),await this.core.history.resolve(f)},this.sendError=async(s,o,h)=>{const f=Oo(s,h),g=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,s),v=Bs[_.request.method]?Bs[_.request.method].res:Bs.unregistered_method.res;await this.core.relayer.publish(o,g,v),await this.core.history.resolve(f)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Wt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ii(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:h}=s,f=(await this.core.history.get(o,h.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,o)=>{const{id:h}=o;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit(Qs.ping,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,o)=>{const{id:h}=o;setTimeout(()=>{ui(o)?this.events.emit(Dt("pairing_ping",h),{}):Mr(o)&&this.events.emit(Dt("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(Qs.delete,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:h,method:f}=o;try{if(this.registeredMethods.includes(f))return;const g=Wt("WC_METHOD_UNSUPPORTED",f);await this.sendError(h,s,g),this.logger.error(g)}catch(g){await this.sendError(h,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Wt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!lr(s)){const{message:f}=Y("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!F0(s.uri)){const{message:f}=Y("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const h=kh(s.uri);if(!((o=h==null?void 0:h.relay)!=null&&o.protocol)){const{message:f}=Y("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(h!=null&&h.symKey)){const{message:f}=Y("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!lr(s)){const{message:h}=Y("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!lr(s)){const{message:h}=Y("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!gs(s,!1)){const{message:o}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ii(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=Y("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Re.generateChildLogger(i,this.name),this.pairings=new Ao(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:i,message:s}=t;if(!this.pairings.keys.includes(i)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(i,s);try{Dc(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):Ro(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Rr.expired,async t=>{const{topic:i}=ef(t.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit(Qs.expire,{topic:i}))})}}class xE extends s_{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.records=new Map,this.events=new mr.EventEmitter,this.name=Y1,this.version=X1,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:h}),this.records.has(o.id))return;const f={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:h,expiry:qr(se.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Vr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Mr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Vr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===s){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Vr.deleted,h)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const s={topic:i.topic,request:ws(i.request.method,i.request.params,i.id),chainId:i.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const i=this.records.get(t);if(!i){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Vr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:i}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Vr.created,t=>{const i=Vr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Vr.updated,t=>{const i=Vr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Vr.deleted,t=>{const i=Vr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.core.heartbeat.on(Es.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{se.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class PE extends h_{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.expirations=new Map,this.events=new mr.EventEmitter,this.name=Z1,this.version=eE,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const h=this.formatTarget(s),f={target:h,expiry:o};this.expirations.set(h,f),this.checkExpiry(h,f),this.events.emit(Rr.created,{target:h,expiration:f})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Rr.deleted,{target:o,expiration:h})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return V0(t);if(typeof t=="number")return G0(t);const{message:i}=Y("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(i)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:i}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const i=this.expirations.get(t);if(!i){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return i}checkExpiry(t,i){const{expiry:s}=i;se.toMiliseconds(s)-Date.now()<=0&&this.expire(t,i)}expire(t,i){this.expirations.delete(t),this.events.emit(Rr.expired,{target:t,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,i)=>this.checkExpiry(i,t))}registerEventListeners(){this.core.heartbeat.on(Es.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Rr.created,t=>{const i=Rr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Rr.expired,t=>{const i=Rr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Rr.deleted,t=>{const i=Rr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class SE extends l_{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.name=hc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||W0()||!tf())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Ic;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let h;try{h=await this.fetchAttestation(s.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(f),h=await this.fetchAttestation(s.attestationId,Ic)}return h},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const h=this.startAbortTimer(se.ONE_SECOND*2),f=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(h),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(h=>{if(document.getElementById(hc))return h();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=hc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=h}),new Promise((h,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},se.toMiliseconds(se.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||vs;return tE.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${vs}`),o=vs),o},this.logger=Re.generateChildLogger(i,this.name),this.verifyUrl=vs,this.abortController=new AbortController,this.isDevEnv=J0()&&rb.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),se.toMiliseconds(t))}}class OE extends f_{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.context=rE,this.registerDeviceToken=async s=>{const{clientId:o,token:h,notificationType:f,enableEncrypted:g=!1}=s,_=`${iE}/${this.projectId}/clients`;await tb(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:f,token:h,always_raw:g})})},this.logger=Re.generateChildLogger(i,this.context)}}var RE=Object.defineProperty,Tl=Object.getOwnPropertySymbols,CE=Object.prototype.hasOwnProperty,AE=Object.prototype.propertyIsEnumerable,Nl=(a,t,i)=>t in a?RE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Ll=(a,t)=>{for(var i in t||(t={}))CE.call(t,i)&&Nl(a,i,t[i]);if(Tl)for(var i of Tl(t))AE.call(t,i)&&Nl(a,i,t[i]);return a};class qc extends i_{constructor(t){super(t),this.protocol=Hf,this.version=O1,this.name=$c,this.events=new mr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Kf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||R1.logger}));this.logger=Re.generateChildLogger(i,this.name),this.heartbeat=new Es.HeartBeat,this.crypto=new nE(this,this.logger,t==null?void 0:t.keychain),this.history=new xE(this,this.logger),this.expirer=new PE(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Ww(Ll(Ll({},C1),t==null?void 0:t.storageOptions)),this.relayer=new wE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new IE(this,this.logger),this.verify=new SE(this.projectId||"",this.logger),this.echoClient=new OE(this.projectId||"",this.logger)}static async init(t){const i=new qc(t);await i.initialize();const s=await i.crypto.getClientId();return await i.storage.setItem(F1,s),i}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const TE=qc,Bf="wc",Ff=2,Vf="client",Mc=`${Bf}@${Ff}:${Vf}:`,fc={name:Vf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Dl="WALLETCONNECT_DEEPLINK_CHOICE",NE="proposal",Gf="Proposal expired",LE="session",lo=se.SEVEN_DAYS,DE="engine",Vs={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},pc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},ci={idle:"IDLE",active:"ACTIVE"},$E="request",qE=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var ME=Object.defineProperty,jE=Object.defineProperties,zE=Object.getOwnPropertyDescriptors,$l=Object.getOwnPropertySymbols,UE=Object.prototype.hasOwnProperty,HE=Object.prototype.propertyIsEnumerable,ql=(a,t,i)=>t in a?ME(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,ur=(a,t)=>{for(var i in t||(t={}))UE.call(t,i)&&ql(a,i,t[i]);if($l)for(var i of $l(t))HE.call(t,i)&&ql(a,i,t[i]);return a},Gs=(a,t)=>jE(a,zE(t));class kE extends d_{constructor(t){super(t),this.name=DE,this.events=new Ac,this.initialized=!1,this.ignoredPayloadTypes=[Zl],this.requestQueue={state:ci.idle,queue:[]},this.sessionRequestQueue={state:ci.idle,queue:[]},this.requestQueueDelay=se.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Vs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const s=Gs(ur({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:f,sessionProperties:g,relays:_}=s;let v=o,I,R=!1;if(v&&(R=this.client.core.pairing.pairings.get(v).active),!v||!R){const{topic:fe,uri:pe}=await this.client.core.pairing.create();v=fe,I=pe}const A=await this.client.core.crypto.generateKeyPair(),z=ur({requiredNamespaces:h,optionalNamespaces:f,relays:_??[{protocol:kf}],proposer:{publicKey:A,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:T,resolve:F,done:re}=ds(se.FIVE_MINUTES,Gf);if(this.events.once(Dt("session_connect"),async({error:fe,session:pe})=>{if(fe)T(fe);else if(pe){pe.self.publicKey=A;const de=Gs(ur({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:pe.peer.metadata}),F(de)}}),!v){const{message:fe}=Y("NO_MATCHING_KEY",`connect() pairing topic: ${v}`);throw new Error(fe)}const he=await this.sendRequest({topic:v,method:"wc_sessionPropose",params:z}),le=qr(se.FIVE_MINUTES);return await this.setProposal(he,ur({id:he,expiry:le},z)),{uri:I,approval:re}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:s,relayProtocol:o,namespaces:h,sessionProperties:f}=i,g=this.client.proposal.get(s);let{pairingTopic:_,proposer:v,requiredNamespaces:I,optionalNamespaces:R}=g;_=_||"",vo(I)||(I=Y0(h,"approve()"));const A=await this.client.core.crypto.generateKeyPair(),z=v.publicKey,T=await this.client.core.crypto.generateSharedKey(A,z);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:v.metadata}),await this.sendResult({id:s,topic:_,result:{relay:{protocol:o??"irn"},responderPublicKey:A}}),await this.client.proposal.delete(s,Wt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const F=ur({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:I,optionalNamespaces:R,pairingTopic:_,controller:{publicKey:A,metadata:this.client.metadata},expiry:qr(lo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(T),await this.sendRequest({topic:T,method:"wc_sessionSettle",params:F,throwOnFailedPublish:!0});const re=Gs(ur({},F),{topic:T,pairingTopic:_,acknowledged:!1,self:F.controller,peer:{publicKey:v.publicKey,metadata:v.metadata},controller:A});return await this.client.session.set(T,re),await this.setExpiry(T,qr(lo)),{topic:T,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(T)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:s,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,o),await this.client.proposal.delete(s,Wt("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:s,namespaces:o}=i,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:g,reject:_}=ds();return this.events.once(Dt("session_update",h),({error:v})=>{v?_(v):g()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:f}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:s}=i,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:f,reject:g}=ds();return this.events.once(Dt("session_extend",o),({error:_})=>{_?g(_):f()}),await this.setExpiry(s,qr(lo)),{acknowledged:h}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:s,request:o,topic:h,expiry:f}=i,g=Lc(),{done:_,resolve:v,reject:I}=ds(f,"Request expired. Please try again.");return this.events.once(Dt("session_request",g),({error:R,result:A})=>{R?I(R):v(A)}),await Promise.all([new Promise(async R=>{await this.sendRequest({clientRpcId:g,topic:h,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(A=>I(A)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:s,id:g}),R()}),new Promise(async R=>{const A=await X0(this.client.core.storage,Dl);Z0({id:g,topic:h,wcDeepLink:A}),R()}),_()]).then(R=>R[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:s,response:o}=i,{id:h}=o;ui(o)?await this.sendResult({id:h,topic:s,result:o.result,throwOnFailedPublish:!0}):Mr(o)&&await this.sendError(h,s,o.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:f,reject:g}=ds();this.events.once(Dt("session_ping",o),({error:_})=>{_?g(_):f()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:s,event:o,chainId:h}=i;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Wt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(s=>ew(s,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const s=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var f,g;return((f=h.peerMetadata)==null?void 0:f.url)&&((g=h.peerMetadata)==null?void 0:g.url)===i.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(i,s)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,Wt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(Dl).catch(h=>this.client.logger.warn(h)),this.getPendingSessionRequests().forEach(h=>{h.topic===i&&this.deletePendingSessionRequest(h.id,Wt("USER_DISCONNECTED"))})},this.deleteProposal=async(i,s)=>{await Promise.all([this.client.proposal.delete(i,Wt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,s),o?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==i),o&&(this.sessionRequestQueue.state=ci.idle)},this.setExpiry=async(i,s)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:s}),this.client.core.expirer.set(i,s)},this.setProposal=async(i,s)=>{await this.client.proposal.set(i,s),this.client.core.expirer.set(i,s.expiry)},this.setPendingSessionRequest=async i=>{const s=Vs.wc_sessionRequest.req.ttl,{id:o,topic:h,params:f,verifyContext:g}=i;await this.client.pendingRequest.set(o,{id:o,topic:h,params:f,verifyContext:g}),s&&this.client.core.expirer.set(o,qr(s))},this.sendRequest=async i=>{const{topic:s,method:o,params:h,expiry:f,relayRpcId:g,clientRpcId:_,throwOnFailedPublish:v}=i,I=ws(o,h,_);if(tf()&&qE.includes(o)){const z=ys(JSON.stringify(I));this.client.core.verify.register({attestationId:z})}const R=await this.client.core.crypto.encode(s,I),A=Vs[o].req;return f&&(A.ttl=f),g&&(A.id=g),this.client.core.history.set(s,I),v?(A.internal=Gs(ur({},A.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,R,A)):this.client.core.relayer.publish(s,R,A).catch(z=>this.client.logger.error(z)),I.id},this.sendResult=async i=>{const{id:s,topic:o,result:h,throwOnFailedPublish:f}=i,g=So(s,h),_=await this.client.core.crypto.encode(o,g),v=await this.client.core.history.get(o,s),I=Vs[v.request.method].res;f?(I.internal=Gs(ur({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,_,I)):this.client.core.relayer.publish(o,_,I).catch(R=>this.client.logger.error(R)),await this.client.core.history.resolve(g)},this.sendError=async(i,s,o)=>{const h=Oo(i,o),f=await this.client.core.crypto.encode(s,h),g=await this.client.core.history.get(s,i),_=Vs[g.request.method].res;this.client.core.relayer.publish(s,f,_),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],s=[];this.client.session.getAll().forEach(o=>{Ii(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ii(o.expiry)&&s.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ci.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ci.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=ci.idle},this.processRequest=i=>{const{topic:s,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:o}=i,h=(await this.client.core.history.get(s,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:s}=i,{message:o}=Y("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,s)=>{const{params:o,id:h}=s;try{this.isValidConnect(ur({},s.params));const f=qr(se.FIVE_MINUTES),g=ur({id:h,pairingTopic:i,expiry:f},o);await this.setProposal(h,g);const _=ys(JSON.stringify(s)),v=await this.getVerifyContext(_,g.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:g,verifyContext:v})}catch(f){await this.sendError(h,i,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(i,s)=>{const{id:o}=s;if(ui(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const _=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const v=await this.client.core.crypto.generateSharedKey(g,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:v});const I=await this.client.core.relayer.subscribe(v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:i})}else Mr(s)&&(await this.client.proposal.delete(o,Wt("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:f,controller:g,expiry:_,namespaces:v,requiredNamespaces:I,optionalNamespaces:R,sessionProperties:A,pairingTopic:z}=s.params,T=ur({topic:i,relay:f,expiry:_,namespaces:v,acknowledged:!0,pairingTopic:z,requiredNamespaces:I,optionalNamespaces:R,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},A&&{sessionProperties:A});await this.sendResult({id:s.id,topic:i,result:!0}),this.events.emit(Dt("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(f){await this.sendError(o,i,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(i,s)=>{const{id:o}=s;ui(s)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Dt("session_approve",o),{})):Mr(s)&&(await this.client.session.delete(i,Wt("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(i,s)=>{const{params:o,id:h}=s;try{const f=`${i}_session_update`,g=uo.get(f);if(g&&this.isRequestOutOfSync(g,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(ur({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:i,result:!0}),this.client.events.emit("session_update",{id:h,topic:i,params:o}),uo.set(f,h)}catch(f){await this.sendError(h,i,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(i,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,s)=>{const{id:o}=s;ui(s)?this.events.emit(Dt("session_update",o),{}):Mr(s)&&this.events.emit(Dt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(i,s)=>{const{id:o}=s;try{this.isValidExtend({topic:i}),await this.setExpiry(i,qr(lo)),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,s)=>{const{id:o}=s;ui(s)?this.events.emit(Dt("session_extend",o),{}):Mr(s)&&this.events.emit(Dt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(i,s)=>{const{id:o}=s;try{this.isValidPing({topic:i}),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,s)=>{const{id:o}=s;setTimeout(()=>{ui(s)?this.events.emit(Dt("session_ping",o),{}):Mr(s)&&this.events.emit(Dt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(i,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:i,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Jt.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult({id:o,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidRequest(ur({topic:i},h));const f=ys(JSON.stringify(ws("wc_sessionRequest",h,o))),g=this.client.session.get(i),_=await this.getVerifyContext(f,g.peer.metadata),v={id:o,topic:i,params:h,verifyContext:_};await this.setPendingSessionRequest(v),this.addSessionRequestToSessionRequestQueue(v),this.processSessionRequestQueue()}catch(f){await this.sendError(o,i,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(i,s)=>{const{id:o}=s;ui(s)?this.events.emit(Dt("session_request",o),{result:s.result}):Mr(s)&&this.events.emit(Dt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(i,s)=>{const{id:o,params:h}=s;try{const f=`${i}_session_event_${h.event.name}`,g=uo.get(f);if(g&&this.isRequestOutOfSync(g,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ur({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h}),uo.set(f,o)}catch(f){await this.sendError(o,i,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ci.idle,this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ci.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ci.active,this.client.events.emit("session_request",i)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=i=>{if(i.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===i.topic);s&&this.onSessionProposeRequest(i.topic,ws("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async i=>{if(!lr(i)){const{message:_}=Y("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:f,relays:g}=i;if(xi(s)||await this.isValidPairingTopic(s),!tw(g,!0)){const{message:_}=Y("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(_)}!xi(o)&&vo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!xi(h)&&vo(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),xi(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(i,s)=>{const o=rw(i,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!lr(i))throw new Error(Y("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:s,namespaces:o,relayProtocol:h,sessionProperties:f}=i;await this.isValidProposalId(s);const g=this.client.proposal.get(s),_=tc(o,"approve()");if(_)throw new Error(_.message);const v=Kh(g.requiredNamespaces,o,"approve()");if(v)throw new Error(v.message);if(!gs(h,!0)){const{message:I}=Y("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(I)}xi(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async i=>{if(!lr(i)){const{message:h}=Y("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:s,reason:o}=i;if(await this.isValidProposalId(s),!iw(o)){const{message:h}=Y("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!lr(i)){const{message:v}=Y("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(v)}const{relay:s,controller:o,namespaces:h,expiry:f}=i;if(!sw(s)){const{message:v}=Y("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(v)}const g=nw(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const _=tc(h,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Ii(f)){const{message:v}=Y("EXPIRED","onSessionSettleRequest()");throw new Error(v)}},this.isValidUpdate=async i=>{if(!lr(i)){const{message:_}=Y("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(_)}const{topic:s,namespaces:o}=i;await this.isValidSessionTopic(s);const h=this.client.session.get(s),f=tc(o,"update()");if(f)throw new Error(f.message);const g=Kh(h.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async i=>{if(!lr(i)){const{message:o}=Y("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionTopic(s)},this.isValidRequest=async i=>{if(!lr(i)){const{message:_}=Y("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(_)}const{topic:s,request:o,chainId:h,expiry:f}=i;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Bh(g,h)){const{message:_}=Y("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(_)}if(!ow(o)){const{message:_}=Y("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!aw(g,h,o.method)){const{message:_}=Y("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(f&&!cw(f,pc)){const{message:_}=Y("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${pc.min} and ${pc.max}`);throw new Error(_)}},this.isValidRespond=async i=>{var s;if(!lr(i)){const{message:f}=Y("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(f)}const{topic:o,response:h}=i;try{await this.isValidSessionTopic(o)}catch(f){throw(s=i==null?void 0:i.response)!=null&&s.id&&this.cleanupAfterResponse(i),f}if(!uw(h)){const{message:f}=Y("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(f)}},this.isValidPing=async i=>{if(!lr(i)){const{message:o}=Y("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async i=>{if(!lr(i)){const{message:g}=Y("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(g)}const{topic:s,event:o,chainId:h}=i;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Bh(f,h)){const{message:g}=Y("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(g)}if(!hw(o)){const{message:g}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!lw(f,h,o.name)){const{message:g}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async i=>{if(!lr(i)){const{message:o}=Y("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(i,s)=>{const o={verified:{verifyUrl:s.verifyUrl||vs,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:s.verifyUrl});h&&(o.verified.origin=h.origin,o.verified.isScam=h.isScam,o.verified.validation=h.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,s)=>{Object.values(i).forEach(o=>{if(!gs(o,!1)){const{message:h}=Y("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:i,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(i,s);try{Dc(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):Ro(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Rr.expired,async t=>{const{topic:i,id:s}=ef(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,Y("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(Qs.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!gs(t,!1)){const{message:i}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:i}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(i)}if(Ii(this.client.core.pairing.pairings.get(t).expiry)){const{message:i}=Y("EXPIRED",`pairing topic: ${t}`);throw new Error(i)}}async isValidSessionTopic(t){if(!gs(t,!1)){const{message:i}=Y("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(i)}if(!this.client.session.keys.includes(t)){const{message:i}=Y("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(i)}if(Ii(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:i}=Y("EXPIRED",`session topic: ${t}`);throw new Error(i)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(gs(t,!1)){const{message:i}=Y("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(i)}else{const{message:i}=Y("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(i)}}async isValidProposalId(t){if(!fw(t)){const{message:i}=Y("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(i)}if(!this.client.proposal.keys.includes(t)){const{message:i}=Y("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(i)}if(Ii(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:i}=Y("EXPIRED",`proposal id: ${t}`);throw new Error(i)}}}class KE extends Ao{constructor(t,i){super(t,i,NE,Mc),this.core=t,this.logger=i}}class BE extends Ao{constructor(t,i){super(t,i,LE,Mc),this.core=t,this.logger=i}}class FE extends Ao{constructor(t,i){super(t,i,$E,Mc,s=>s.id),this.core=t,this.logger=i}}let VE=class Wf extends p_{constructor(t){super(t),this.protocol=Bf,this.version=Ff,this.name=fc.name,this.events=new mr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||fc.name,this.metadata=(t==null?void 0:t.metadata)||Q0();const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||fc.logger}));this.core=(t==null?void 0:t.core)||new TE(t),this.logger=Re.generateChildLogger(i,this.name),this.session=new BE(this.core,this.logger),this.proposal=new KE(this.core,this.logger),this.pendingRequest=new FE(this.core,this.logger),this.engine=new kE(this)}static async init(t){const i=new Wf(t);return await i.initialize(),i}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var xc={exports:{}};(function(a,t){var i=typeof self<"u"?self:jr,s=function(){function h(){this.fetch=!1,this.DOMException=i.DOMException}return h.prototype=i,new h}();(function(h){(function(f){var g={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function _(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],I=ArrayBuffer.isView||function(m){return m&&v.indexOf(Object.prototype.toString.call(m))>-1};function R(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function A(m){return typeof m!="string"&&(m=String(m)),m}function z(m){var x={next:function(){var X=m.shift();return{done:X===void 0,value:X}}};return g.iterable&&(x[Symbol.iterator]=function(){return x}),x}function T(m){this.map={},m instanceof T?m.forEach(function(x,X){this.append(X,x)},this):Array.isArray(m)?m.forEach(function(x){this.append(x[0],x[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(x){this.append(x,m[x])},this)}T.prototype.append=function(m,x){m=R(m),x=A(x);var X=this.map[m];this.map[m]=X?X+", "+x:x},T.prototype.delete=function(m){delete this.map[R(m)]},T.prototype.get=function(m){return m=R(m),this.has(m)?this.map[m]:null},T.prototype.has=function(m){return this.map.hasOwnProperty(R(m))},T.prototype.set=function(m,x){this.map[R(m)]=A(x)},T.prototype.forEach=function(m,x){for(var X in this.map)this.map.hasOwnProperty(X)&&m.call(x,this.map[X],X,this)},T.prototype.keys=function(){var m=[];return this.forEach(function(x,X){m.push(X)}),z(m)},T.prototype.values=function(){var m=[];return this.forEach(function(x){m.push(x)}),z(m)},T.prototype.entries=function(){var m=[];return this.forEach(function(x,X){m.push([X,x])}),z(m)},g.iterable&&(T.prototype[Symbol.iterator]=T.prototype.entries);function F(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function re(m){return new Promise(function(x,X){m.onload=function(){x(m.result)},m.onerror=function(){X(m.error)}})}function he(m){var x=new FileReader,X=re(x);return x.readAsArrayBuffer(m),X}function le(m){var x=new FileReader,X=re(x);return x.readAsText(m),X}function fe(m){for(var x=new Uint8Array(m),X=new Array(x.length),ce=0;ce<x.length;ce++)X[ce]=String.fromCharCode(x[ce]);return X.join("")}function pe(m){if(m.slice)return m.slice(0);var x=new Uint8Array(m.byteLength);return x.set(new Uint8Array(m)),x.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&_(m)?(this._bodyArrayBuffer=pe(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||I(m))?this._bodyArrayBuffer=pe(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=F(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?F(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var m=F(this);if(m)return m;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var $=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(m){var x=m.toUpperCase();return $.indexOf(x)>-1?x:m}function W(m,x){x=x||{};var X=x.body;if(m instanceof W){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,x.headers||(this.headers=new T(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!X&&m._bodyInit!=null&&(X=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new T(x.headers)),this.method=H(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ye(m){var x=new FormData;return m.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),V=ce.shift().replace(/\+/g," "),k=ce.join("=").replace(/\+/g," ");x.append(decodeURIComponent(V),decodeURIComponent(k))}}),x}function ie(m){var x=new T,X=m.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),k=V.shift().trim();if(k){var B=V.join(":").trim();x.append(k,B)}}),x}de.call(W.prototype);function ue(m,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new T(x.headers),this.url=x.url||"",this._initBody(m)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new T(this.headers),url:this.url})},ue.error=function(){var m=new ue(null,{status:0,statusText:""});return m.type="error",m};var Te=[301,302,303,307,308];ue.redirect=function(m,x){if(Te.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:x,headers:{location:m}})},f.DOMException=h.DOMException;try{new f.DOMException}catch{f.DOMException=function(x,X){this.message=x,this.name=X;var ce=Error(x);this.stack=ce.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function Ue(m,x){return new Promise(function(X,ce){var V=new W(m,x);if(V.signal&&V.signal.aborted)return ce(new f.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function B(){k.abort()}k.onload=function(){var G={status:k.status,statusText:k.statusText,headers:ie(k.getAllResponseHeaders()||"")};G.url="responseURL"in k?k.responseURL:G.headers.get("X-Request-URL");var Qe="response"in k?k.response:k.responseText;X(new ue(Qe,G))},k.onerror=function(){ce(new TypeError("Network request failed"))},k.ontimeout=function(){ce(new TypeError("Network request failed"))},k.onabort=function(){ce(new f.DOMException("Aborted","AbortError"))},k.open(V.method,V.url,!0),V.credentials==="include"?k.withCredentials=!0:V.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&g.blob&&(k.responseType="blob"),V.headers.forEach(function(G,Qe){k.setRequestHeader(Qe,G)}),V.signal&&(V.signal.addEventListener("abort",B),k.onreadystatechange=function(){k.readyState===4&&V.signal.removeEventListener("abort",B)}),k.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return Ue.polyfill=!0,h.fetch||(h.fetch=Ue,h.Headers=T,h.Request=W,h.Response=ue),f.Headers=T,f.Request=W,f.Response=ue,f.fetch=Ue,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,a.exports=t})(xc,xc.exports);var GE=xc.exports;const Ml=Io(GE),WE={Accept:"application/json","Content-Type":"application/json"},JE="POST",jl={headers:WE,method:JE},zl=10;class Oi{constructor(t,i=!1){if(this.url=t,this.disableProviderPing=i,this.events=new mr.EventEmitter,this.isAvailable=!1,this.registering=!1,!ll(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,i){this.isAvailable||await this.register();try{const s=Bi(t),h=await(await Ml(this.url,Object.assign(Object.assign({},jl),{body:s}))).json();this.onPayload({data:h})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!ll(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((s,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const i=Bi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ml(t,Object.assign(Object.assign({},jl),{body:i}))}this.onOpen()}catch(i){const s=this.parseError(i);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?tn(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const s=this.parseError(i),o=s.message||s.toString(),h=Oo(t,o);this.events.emit("payload",h)}parseError(t,i=this.url){return Pf(t,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>zl&&this.events.setMaxListeners(zl)}}const Ul="error",QE="wss://relay.walletconnect.com",YE="wc",XE="universal_provider",Hl=`${YE}@2:${XE}:`,ZE="https://rpc.walletconnect.com/v1/",li={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var i,s="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",v=500,I="__lodash_placeholder__",R=1,A=2,z=4,T=1,F=2,re=1,he=2,le=4,fe=8,pe=16,de=32,$=64,H=128,W=256,ye=512,ie=30,ue="...",Te=800,Ue=16,m=1,x=2,X=3,ce=1/0,V=9007199254740991,k=17976931348623157e292,B=NaN,G=4294967295,Qe=G-1,Be=G>>>1,zr=[["ary",H],["bind",re],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ye],["partial",de],["partialRight",$],["rearg",W]],Ie="[object Arguments]",xt="[object Array]",D="[object AsyncFunction]",L="[object Boolean]",C="[object Date]",u="[object DOMException]",E="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",be="[object Map]",Ne="[object Number]",De="[object Null]",Se="[object Object]",Pt="[object Promise]",wt="[object Proxy]",at="[object RegExp]",qe="[object Set]",Xe="[object String]",Ze="[object Symbol]",ct="[object Undefined]",He="[object WeakMap]",et="[object WeakSet]",Le="[object ArrayBuffer]",Fe="[object DataView]",lt="[object Float32Array]",je="[object Float64Array]",St="[object Int8Array]",$t="[object Int16Array]",kt="[object Int32Array]",Kt="[object Uint8Array]",jt="[object Uint8ClampedArray]",Qt="[object Uint16Array]",ir="[object Uint32Array]",Ur=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Gr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,ft=RegExp(fi.source),it=RegExp(Ri.source),pt=/<%-([\s\S]+?)%>/g,dt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,st=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(gt.source),vt=/^\s+/,_t=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,To=/[()=,{}\[\]\/\s]/,No=/\\(\\)?/g,Lo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wr=/\w*$/,Do=/^[-+]0x[0-9a-f]+$/i,$o=/^0b[01]+$/i,qo=/^\[object .+?Constructor\]$/,Mo=/^0o[0-7]+$/i,jo=/^(?:0|[1-9]\d*)$/,Wr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wi=/($^)/,zo=/['\n\r\u2028\u2029\\]/g,Ji="\\ud800-\\udfff",Uo="\\u0300-\\u036f",Ho="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",sn=Uo+Ho+Qi,nn="\\u2700-\\u27bf",Cr="a-z\\xdf-\\xf6\\xf8-\\xff",ko="\\xac\\xb1\\xd7\\xf7",Ko="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Bo="\\u2000-\\u206f",Fo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",on="A-Z\\xc0-\\xd6\\xd8-\\xde",an="\\ufe0e\\ufe0f",Ci=ko+Ko+Bo+Fo,Is="['’]",Ai="["+Ji+"]",xs="["+Ci+"]",Ti="["+sn+"]",cn="\\d+",Vo="["+nn+"]",un="["+Cr+"]",hn="[^"+Ji+Ci+cn+nn+Cr+on+"]",Yi="\\ud83c[\\udffb-\\udfff]",Go="(?:"+Ti+"|"+Yi+")",ln="[^"+Ji+"]",Xi="(?:\\ud83c[\\udde6-\\uddff]){2}",pi="[\\ud800-\\udbff][\\udc00-\\udfff]",fr="["+on+"]",fn="\\u200d",pn="(?:"+un+"|"+hn+")",Hr="(?:"+fr+"|"+hn+")",dn="(?:"+Is+"(?:d|ll|m|re|s|t|ve))?",gn="(?:"+Is+"(?:D|LL|M|RE|S|T|VE))?",vn=Go+"?",yn="["+an+"]?",Wo="(?:"+fn+"(?:"+[ln,Xi,pi].join("|")+")"+yn+vn+")*",Jr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",mn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",wn=yn+vn+Wo,Zi="(?:"+[Vo,Xi,pi].join("|")+")"+wn,Jo="(?:"+[ln+Ti+"?",Ti,Xi,pi,Ai].join("|")+")",Ps=RegExp(Is,"g"),Qo=RegExp(Ti,"g"),es=RegExp(Yi+"(?="+Yi+")|"+Jo+wn,"g"),_n=RegExp([fr+"?"+un+"+"+dn+"(?="+[xs,fr,"$"].join("|")+")",Hr+"+"+gn+"(?="+[xs,fr+pn,"$"].join("|")+")",fr+"?"+pn+"+"+dn,fr+"+"+gn,mn,Jr,cn,Zi].join("|"),"g"),bn=RegExp("["+fn+Ji+sn+an+"]"),Ni=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,En=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Yo=-1,Ve={};Ve[lt]=Ve[je]=Ve[St]=Ve[$t]=Ve[kt]=Ve[Kt]=Ve[jt]=Ve[Qt]=Ve[ir]=!0,Ve[Ie]=Ve[xt]=Ve[Le]=Ve[L]=Ve[Fe]=Ve[C]=Ve[E]=Ve[ee]=Ve[be]=Ve[Ne]=Ve[Se]=Ve[at]=Ve[qe]=Ve[Xe]=Ve[He]=!1;var ke={};ke[Ie]=ke[xt]=ke[Le]=ke[Fe]=ke[L]=ke[C]=ke[lt]=ke[je]=ke[St]=ke[$t]=ke[kt]=ke[be]=ke[Ne]=ke[Se]=ke[at]=ke[qe]=ke[Xe]=ke[Ze]=ke[Kt]=ke[jt]=ke[Qt]=ke[ir]=!0,ke[E]=ke[ee]=ke[He]=!1;var y={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,me=parseInt,tt=typeof Ws=="object"&&Ws&&Ws.Object===Object&&Ws,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Ce=tt||Nt||Function("return this")(),We=t&&!t.nodeType&&t,bt=We&&!0&&a&&!a.nodeType&&a,sr=bt&&bt.exports===We,Lt=sr&&tt.process,rt=function(){try{var S=bt&&bt.require&&bt.require("util").types;return S||Lt&&Lt.binding&&Lt.binding("util")}catch{}}(),Xt=rt&&rt.isArrayBuffer,Ar=rt&&rt.isDate,_r=rt&&rt.isMap,kr=rt&&rt.isRegExp,Ss=rt&&rt.isSet,Li=rt&&rt.isTypedArray;function zt(S,q,N){switch(N.length){case 0:return S.call(q);case 1:return S.call(q,N[0]);case 2:return S.call(q,N[0],N[1]);case 3:return S.call(q,N[0],N[1],N[2])}return S.apply(q,N)}function Yf(S,q,N,Z){for(var ve=-1,$e=S==null?0:S.length;++ve<$e;){var qt=S[ve];q(Z,qt,N(qt),S)}return Z}function br(S,q){for(var N=-1,Z=S==null?0:S.length;++N<Z&&q(S[N],N,S)!==!1;);return S}function Xf(S,q){for(var N=S==null?0:S.length;N--&&q(S[N],N,S)!==!1;);return S}function Uc(S,q){for(var N=-1,Z=S==null?0:S.length;++N<Z;)if(!q(S[N],N,S))return!1;return!0}function di(S,q){for(var N=-1,Z=S==null?0:S.length,ve=0,$e=[];++N<Z;){var qt=S[N];q(qt,N,S)&&($e[ve++]=qt)}return $e}function In(S,q){var N=S==null?0:S.length;return!!N&&ts(S,q,0)>-1}function Xo(S,q,N){for(var Z=-1,ve=S==null?0:S.length;++Z<ve;)if(N(q,S[Z]))return!0;return!1}function nt(S,q){for(var N=-1,Z=S==null?0:S.length,ve=Array(Z);++N<Z;)ve[N]=q(S[N],N,S);return ve}function gi(S,q){for(var N=-1,Z=q.length,ve=S.length;++N<Z;)S[ve+N]=q[N];return S}function Zo(S,q,N,Z){var ve=-1,$e=S==null?0:S.length;for(Z&&$e&&(N=S[++ve]);++ve<$e;)N=q(N,S[ve],ve,S);return N}function Zf(S,q,N,Z){var ve=S==null?0:S.length;for(Z&&ve&&(N=S[--ve]);ve--;)N=q(N,S[ve],ve,S);return N}function ea(S,q){for(var N=-1,Z=S==null?0:S.length;++N<Z;)if(q(S[N],N,S))return!0;return!1}var ep=ta("length");function tp(S){return S.split("")}function rp(S){return S.match(Tt)||[]}function Hc(S,q,N){var Z;return N(S,function(ve,$e,qt){if(q(ve,$e,qt))return Z=$e,!1}),Z}function xn(S,q,N,Z){for(var ve=S.length,$e=N+(Z?1:-1);Z?$e--:++$e<ve;)if(q(S[$e],$e,S))return $e;return-1}function ts(S,q,N){return q===q?dp(S,q,N):xn(S,kc,N)}function ip(S,q,N,Z){for(var ve=N-1,$e=S.length;++ve<$e;)if(Z(S[ve],q))return ve;return-1}function kc(S){return S!==S}function Kc(S,q){var N=S==null?0:S.length;return N?ia(S,q)/N:B}function ta(S){return function(q){return q==null?i:q[S]}}function ra(S){return function(q){return S==null?i:S[q]}}function Bc(S,q,N,Z,ve){return ve(S,function($e,qt,Je){N=Z?(Z=!1,$e):q(N,$e,qt,Je)}),N}function sp(S,q){var N=S.length;for(S.sort(q);N--;)S[N]=S[N].value;return S}function ia(S,q){for(var N,Z=-1,ve=S.length;++Z<ve;){var $e=q(S[Z]);$e!==i&&(N=N===i?$e:N+$e)}return N}function sa(S,q){for(var N=-1,Z=Array(S);++N<S;)Z[N]=q(N);return Z}function np(S,q){return nt(q,function(N){return[N,S[N]]})}function Fc(S){return S&&S.slice(0,Jc(S)+1).replace(vt,"")}function pr(S){return function(q){return S(q)}}function na(S,q){return nt(q,function(N){return S[N]})}function Os(S,q){return S.has(q)}function Vc(S,q){for(var N=-1,Z=S.length;++N<Z&&ts(q,S[N],0)>-1;);return N}function Gc(S,q){for(var N=S.length;N--&&ts(q,S[N],0)>-1;);return N}function op(S,q){for(var N=S.length,Z=0;N--;)S[N]===q&&++Z;return Z}var ap=ra(y),cp=ra(P);function up(S){return"\\"+Q[S]}function hp(S,q){return S==null?i:S[q]}function rs(S){return bn.test(S)}function lp(S){return Ni.test(S)}function fp(S){for(var q,N=[];!(q=S.next()).done;)N.push(q.value);return N}function oa(S){var q=-1,N=Array(S.size);return S.forEach(function(Z,ve){N[++q]=[ve,Z]}),N}function Wc(S,q){return function(N){return S(q(N))}}function vi(S,q){for(var N=-1,Z=S.length,ve=0,$e=[];++N<Z;){var qt=S[N];(qt===q||qt===I)&&(S[N]=I,$e[ve++]=N)}return $e}function Pn(S){var q=-1,N=Array(S.size);return S.forEach(function(Z){N[++q]=Z}),N}function pp(S){var q=-1,N=Array(S.size);return S.forEach(function(Z){N[++q]=[Z,Z]}),N}function dp(S,q,N){for(var Z=N-1,ve=S.length;++Z<ve;)if(S[Z]===q)return Z;return-1}function gp(S,q,N){for(var Z=N+1;Z--;)if(S[Z]===q)return Z;return Z}function is(S){return rs(S)?yp(S):ep(S)}function Tr(S){return rs(S)?mp(S):tp(S)}function Jc(S){for(var q=S.length;q--&&_t.test(S.charAt(q)););return q}var vp=ra(U);function yp(S){for(var q=es.lastIndex=0;es.test(S);)++q;return q}function mp(S){return S.match(es)||[]}function wp(S){return S.match(_n)||[]}var _p=function S(q){q=q==null?Ce:ss.defaults(Ce.Object(),q,ss.pick(Ce,En));var N=q.Array,Z=q.Date,ve=q.Error,$e=q.Function,qt=q.Math,Je=q.Object,aa=q.RegExp,bp=q.String,Er=q.TypeError,Sn=N.prototype,Ep=$e.prototype,ns=Je.prototype,On=q["__core-js_shared__"],Rn=Ep.toString,ze=ns.hasOwnProperty,Ip=0,Qc=function(){var e=/[^.]+$/.exec(On&&On.keys&&On.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Cn=ns.toString,xp=Rn.call(Je),Pp=Ce._,Sp=aa("^"+Rn.call(ze).replace(gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),An=sr?q.Buffer:i,yi=q.Symbol,Tn=q.Uint8Array,Yc=An?An.allocUnsafe:i,Nn=Wc(Je.getPrototypeOf,Je),Xc=Je.create,Zc=ns.propertyIsEnumerable,Ln=Sn.splice,eu=yi?yi.isConcatSpreadable:i,Rs=yi?yi.iterator:i,Di=yi?yi.toStringTag:i,Dn=function(){try{var e=zi(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Op=q.clearTimeout!==Ce.clearTimeout&&q.clearTimeout,Rp=Z&&Z.now!==Ce.Date.now&&Z.now,Cp=q.setTimeout!==Ce.setTimeout&&q.setTimeout,$n=qt.ceil,qn=qt.floor,ca=Je.getOwnPropertySymbols,Ap=An?An.isBuffer:i,tu=q.isFinite,Tp=Sn.join,Np=Wc(Je.keys,Je),Mt=qt.max,Vt=qt.min,Lp=Z.now,Dp=q.parseInt,ru=qt.random,$p=Sn.reverse,ua=zi(q,"DataView"),Cs=zi(q,"Map"),ha=zi(q,"Promise"),os=zi(q,"Set"),As=zi(q,"WeakMap"),Ts=zi(Je,"create"),Mn=As&&new As,as={},qp=Ui(ua),Mp=Ui(Cs),jp=Ui(ha),zp=Ui(os),Up=Ui(As),jn=yi?yi.prototype:i,Ns=jn?jn.valueOf:i,iu=jn?jn.toString:i;function p(e){if(mt(e)&&!we(e)&&!(e instanceof Oe)){if(e instanceof Ir)return e;if(ze.call(e,"__wrapped__"))return sh(e)}return new Ir(e)}var cs=function(){function e(){}return function(r){if(!ht(r))return{};if(Xc)return Xc(r);e.prototype=r;var n=new e;return e.prototype=i,n}}();function zn(){}function Ir(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=i}p.templateSettings={escape:pt,evaluate:dt,interpolate:ut,variable:"",imports:{_:p}},p.prototype=zn.prototype,p.prototype.constructor=p,Ir.prototype=cs(zn.prototype),Ir.prototype.constructor=Ir;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Hp(){var e=new Oe(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function kp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Kp(){var e=this.__wrapped__.value(),r=this.__dir__,n=we(e),c=r<0,l=n?e.length:0,d=tg(0,l,this.__views__),w=d.start,b=d.end,O=b-w,M=c?b:w-1,j=this.__iteratees__,K=j.length,J=0,te=Vt(O,this.__takeCount__);if(!n||!c&&l==O&&te==O)return Ou(e,this.__actions__);var oe=[];e:for(;O--&&J<te;){M+=r;for(var Ee=-1,ae=e[M];++Ee<K;){var Pe=j[Ee],Ae=Pe.iteratee,vr=Pe.type,tr=Ae(ae);if(vr==x)ae=tr;else if(!tr){if(vr==m)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=cs(zn.prototype),Oe.prototype.constructor=Oe;function $i(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var c=e[r];this.set(c[0],c[1])}}function Bp(){this.__data__=Ts?Ts(null):{},this.size=0}function Fp(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function Vp(e){var r=this.__data__;if(Ts){var n=r[e];return n===_?i:n}return ze.call(r,e)?r[e]:i}function Gp(e){var r=this.__data__;return Ts?r[e]!==i:ze.call(r,e)}function Wp(e,r){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ts&&r===i?_:r,this}$i.prototype.clear=Bp,$i.prototype.delete=Fp,$i.prototype.get=Vp,$i.prototype.has=Gp,$i.prototype.set=Wp;function Qr(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var c=e[r];this.set(c[0],c[1])}}function Jp(){this.__data__=[],this.size=0}function Qp(e){var r=this.__data__,n=Un(r,e);if(n<0)return!1;var c=r.length-1;return n==c?r.pop():Ln.call(r,n,1),--this.size,!0}function Yp(e){var r=this.__data__,n=Un(r,e);return n<0?i:r[n][1]}function Xp(e){return Un(this.__data__,e)>-1}function Zp(e,r){var n=this.__data__,c=Un(n,e);return c<0?(++this.size,n.push([e,r])):n[c][1]=r,this}Qr.prototype.clear=Jp,Qr.prototype.delete=Qp,Qr.prototype.get=Yp,Qr.prototype.has=Xp,Qr.prototype.set=Zp;function Yr(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var c=e[r];this.set(c[0],c[1])}}function ed(){this.size=0,this.__data__={hash:new $i,map:new(Cs||Qr),string:new $i}}function td(e){var r=Xn(this,e).delete(e);return this.size-=r?1:0,r}function rd(e){return Xn(this,e).get(e)}function id(e){return Xn(this,e).has(e)}function sd(e,r){var n=Xn(this,e),c=n.size;return n.set(e,r),this.size+=n.size==c?0:1,this}Yr.prototype.clear=ed,Yr.prototype.delete=td,Yr.prototype.get=rd,Yr.prototype.has=id,Yr.prototype.set=sd;function qi(e){var r=-1,n=e==null?0:e.length;for(this.__data__=new Yr;++r<n;)this.add(e[r])}function nd(e){return this.__data__.set(e,_),this}function od(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=nd,qi.prototype.has=od;function Nr(e){var r=this.__data__=new Qr(e);this.size=r.size}function ad(){this.__data__=new Qr,this.size=0}function cd(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}function ud(e){return this.__data__.get(e)}function hd(e){return this.__data__.has(e)}function ld(e,r){var n=this.__data__;if(n instanceof Qr){var c=n.__data__;if(!Cs||c.length<o-1)return c.push([e,r]),this.size=++n.size,this;n=this.__data__=new Yr(c)}return n.set(e,r),this.size=n.size,this}Nr.prototype.clear=ad,Nr.prototype.delete=cd,Nr.prototype.get=ud,Nr.prototype.has=hd,Nr.prototype.set=ld;function su(e,r){var n=we(e),c=!n&&Hi(e),l=!n&&!c&&Ei(e),d=!n&&!c&&!l&&fs(e),w=n||c||l||d,b=w?sa(e.length,bp):[],O=b.length;for(var M in e)(r||ze.call(e,M))&&!(w&&(M=="length"||l&&(M=="offset"||M=="parent")||d&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||ti(M,O)))&&b.push(M);return b}function nu(e){var r=e.length;return r?e[ba(0,r-1)]:i}function fd(e,r){return Zn(nr(e),Mi(r,0,e.length))}function pd(e){return Zn(nr(e))}function la(e,r,n){(n!==i&&!Lr(e[r],n)||n===i&&!(r in e))&&Xr(e,r,n)}function Ls(e,r,n){var c=e[r];(!(ze.call(e,r)&&Lr(c,n))||n===i&&!(r in e))&&Xr(e,r,n)}function Un(e,r){for(var n=e.length;n--;)if(Lr(e[n][0],r))return n;return-1}function dd(e,r,n,c){return mi(e,function(l,d,w){r(c,l,n(l),w)}),c}function ou(e,r){return e&&Br(r,Ut(r),e)}function gd(e,r){return e&&Br(r,ar(r),e)}function Xr(e,r,n){r=="__proto__"&&Dn?Dn(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}function fa(e,r){for(var n=-1,c=r.length,l=N(c),d=e==null;++n<c;)l[n]=d?i:Va(e,r[n]);return l}function Mi(e,r,n){return e===e&&(n!==i&&(e=e<=n?e:n),r!==i&&(e=e>=r?e:r)),e}function xr(e,r,n,c,l,d){var w,b=r&R,O=r&A,M=r&z;if(n&&(w=l?n(e,c,l,d):n(e)),w!==i)return w;if(!ht(e))return e;var j=we(e);if(j){if(w=ig(e),!b)return nr(e,w)}else{var K=Gt(e),J=K==ee||K==ge;if(Ei(e))return Au(e,b);if(K==Se||K==Ie||J&&!l){if(w=O||J?{}:Ju(e),!b)return O?Vd(e,gd(w,e)):Fd(e,ou(w,e))}else{if(!ke[K])return l?e:{};w=sg(e,K,b)}}d||(d=new Nr);var te=d.get(e);if(te)return te;d.set(e,w),xh(e)?e.forEach(function(ae){w.add(xr(ae,r,n,ae,e,d))}):Eh(e)&&e.forEach(function(ae,Pe){w.set(Pe,xr(ae,r,n,Pe,e,d))});var oe=M?O?Na:Ta:O?ar:Ut,Ee=j?i:oe(e);return br(Ee||e,function(ae,Pe){Ee&&(Pe=ae,ae=e[Pe]),Ls(w,Pe,xr(ae,r,n,Pe,e,d))}),w}function vd(e){var r=Ut(e);return function(n){return au(n,e,r)}}function au(e,r,n){var c=n.length;if(e==null)return!c;for(e=Je(e);c--;){var l=n[c],d=r[l],w=e[l];if(w===i&&!(l in e)||!d(w))return!1}return!0}function cu(e,r,n){if(typeof e!="function")throw new Er(f);return Us(function(){e.apply(i,n)},r)}function Ds(e,r,n,c){var l=-1,d=In,w=!0,b=e.length,O=[],M=r.length;if(!b)return O;n&&(r=nt(r,pr(n))),c?(d=Xo,w=!1):r.length>=o&&(d=Os,w=!1,r=new qi(r));e:for(;++l<b;){var j=e[l],K=n==null?j:n(j);if(j=c||j!==0?j:0,w&&K===K){for(var J=M;J--;)if(r[J]===K)continue e;O.push(j)}else d(r,K,c)||O.push(j)}return O}var mi=$u(Kr),uu=$u(da,!0);function yd(e,r){var n=!0;return mi(e,function(c,l,d){return n=!!r(c,l,d),n}),n}function Hn(e,r,n){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=r(d);if(w!=null&&(b===i?w===w&&!gr(w):n(w,b)))var b=w,O=d}return O}function md(e,r,n,c){var l=e.length;for(n=_e(n),n<0&&(n=-n>l?0:l+n),c=c===i||c>l?l:_e(c),c<0&&(c+=l),c=n>c?0:Sh(c);n<c;)e[n++]=r;return e}function hu(e,r){var n=[];return mi(e,function(c,l,d){r(c,l,d)&&n.push(c)}),n}function Bt(e,r,n,c,l){var d=-1,w=e.length;for(n||(n=og),l||(l=[]);++d<w;){var b=e[d];r>0&&n(b)?r>1?Bt(b,r-1,n,c,l):gi(l,b):c||(l[l.length]=b)}return l}var pa=qu(),lu=qu(!0);function Kr(e,r){return e&&pa(e,r,Ut)}function da(e,r){return e&&lu(e,r,Ut)}function kn(e,r){return di(r,function(n){return ri(e[n])})}function ji(e,r){r=_i(r,e);for(var n=0,c=r.length;e!=null&&n<c;)e=e[Fr(r[n++])];return n&&n==c?e:i}function fu(e,r,n){var c=r(e);return we(e)?c:gi(c,n(e))}function Zt(e){return e==null?e===i?ct:De:Di&&Di in Je(e)?eg(e):pg(e)}function ga(e,r){return e>r}function wd(e,r){return e!=null&&ze.call(e,r)}function _d(e,r){return e!=null&&r in Je(e)}function bd(e,r,n){return e>=Vt(r,n)&&e<Mt(r,n)}function va(e,r,n){for(var c=n?Xo:In,l=e[0].length,d=e.length,w=d,b=N(d),O=1/0,M=[];w--;){var j=e[w];w&&r&&(j=nt(j,pr(r))),O=Vt(j.length,O),b[w]=!n&&(r||l>=120&&j.length>=120)?new qi(w&&j):i}j=e[0];var K=-1,J=b[0];e:for(;++K<l&&M.length<O;){var te=j[K],oe=r?r(te):te;if(te=n||te!==0?te:0,!(J?Os(J,oe):c(M,oe,n))){for(w=d;--w;){var Ee=b[w];if(!(Ee?Os(Ee,oe):c(e[w],oe,n)))continue e}J&&J.push(oe),M.push(te)}}return M}function Ed(e,r,n,c){return Kr(e,function(l,d,w){r(c,n(l),d,w)}),c}function $s(e,r,n){r=_i(r,e),e=Zu(e,r);var c=e==null?e:e[Fr(Sr(r))];return c==null?i:zt(c,e,n)}function pu(e){return mt(e)&&Zt(e)==Ie}function Id(e){return mt(e)&&Zt(e)==Le}function xd(e){return mt(e)&&Zt(e)==C}function qs(e,r,n,c,l){return e===r?!0:e==null||r==null||!mt(e)&&!mt(r)?e!==e&&r!==r:Pd(e,r,n,c,qs,l)}function Pd(e,r,n,c,l,d){var w=we(e),b=we(r),O=w?xt:Gt(e),M=b?xt:Gt(r);O=O==Ie?Se:O,M=M==Ie?Se:M;var j=O==Se,K=M==Se,J=O==M;if(J&&Ei(e)){if(!Ei(r))return!1;w=!0,j=!1}if(J&&!j)return d||(d=new Nr),w||fs(e)?Vu(e,r,n,c,l,d):Xd(e,r,O,n,c,l,d);if(!(n&T)){var te=j&&ze.call(e,"__wrapped__"),oe=K&&ze.call(r,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?r.value():r;return d||(d=new Nr),l(Ee,ae,n,c,d)}}return J?(d||(d=new Nr),Zd(e,r,n,c,l,d)):!1}function Sd(e){return mt(e)&&Gt(e)==be}function ya(e,r,n,c){var l=n.length,d=l,w=!c;if(e==null)return!d;for(e=Je(e);l--;){var b=n[l];if(w&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++l<d;){b=n[l];var O=b[0],M=e[O],j=b[1];if(w&&b[2]){if(M===i&&!(O in e))return!1}else{var K=new Nr;if(c)var J=c(M,j,O,e,r,K);if(!(J===i?qs(j,M,T|F,c,K):J))return!1}}return!0}function du(e){if(!ht(e)||cg(e))return!1;var r=ri(e)?Sp:qo;return r.test(Ui(e))}function Od(e){return mt(e)&&Zt(e)==at}function Rd(e){return mt(e)&&Gt(e)==qe}function Cd(e){return mt(e)&&no(e.length)&&!!Ve[Zt(e)]}function gu(e){return typeof e=="function"?e:e==null?cr:typeof e=="object"?we(e)?mu(e[0],e[1]):yu(e):Mh(e)}function ma(e){if(!zs(e))return Np(e);var r=[];for(var n in Je(e))ze.call(e,n)&&n!="constructor"&&r.push(n);return r}function Ad(e){if(!ht(e))return fg(e);var r=zs(e),n=[];for(var c in e)c=="constructor"&&(r||!ze.call(e,c))||n.push(c);return n}function wa(e,r){return e<r}function vu(e,r){var n=-1,c=or(e)?N(e.length):[];return mi(e,function(l,d,w){c[++n]=r(l,d,w)}),c}function yu(e){var r=Da(e);return r.length==1&&r[0][2]?Yu(r[0][0],r[0][1]):function(n){return n===e||ya(n,e,r)}}function mu(e,r){return qa(e)&&Qu(r)?Yu(Fr(e),r):function(n){var c=Va(n,e);return c===i&&c===r?Ga(n,e):qs(r,c,T|F)}}function Kn(e,r,n,c,l){e!==r&&pa(r,function(d,w){if(l||(l=new Nr),ht(d))Td(e,r,w,n,Kn,c,l);else{var b=c?c(ja(e,w),d,w+"",e,r,l):i;b===i&&(b=d),la(e,w,b)}},ar)}function Td(e,r,n,c,l,d,w){var b=ja(e,n),O=ja(r,n),M=w.get(O);if(M){la(e,n,M);return}var j=d?d(b,O,n+"",e,r,w):i,K=j===i;if(K){var J=we(O),te=!J&&Ei(O),oe=!J&&!te&&fs(O);j=O,J||te||oe?we(b)?j=b:Et(b)?j=nr(b):te?(K=!1,j=Au(O,!0)):oe?(K=!1,j=Tu(O,!0)):j=[]:Hs(O)||Hi(O)?(j=b,Hi(b)?j=Oh(b):(!ht(b)||ri(b))&&(j=Ju(O))):K=!1}K&&(w.set(O,j),l(j,O,c,d,w),w.delete(O)),la(e,n,j)}function wu(e,r){var n=e.length;if(n)return r+=r<0?n:0,ti(r,n)?e[r]:i}function _u(e,r,n){r.length?r=nt(r,function(d){return we(d)?function(w){return ji(w,d.length===1?d[0]:d)}:d}):r=[cr];var c=-1;r=nt(r,pr(ne()));var l=vu(e,function(d,w,b){var O=nt(r,function(M){return M(d)});return{criteria:O,index:++c,value:d}});return sp(l,function(d,w){return Bd(d,w,n)})}function Nd(e,r){return bu(e,r,function(n,c){return Ga(e,c)})}function bu(e,r,n){for(var c=-1,l=r.length,d={};++c<l;){var w=r[c],b=ji(e,w);n(b,w)&&Ms(d,_i(w,e),b)}return d}function Ld(e){return function(r){return ji(r,e)}}function _a(e,r,n,c){var l=c?ip:ts,d=-1,w=r.length,b=e;for(e===r&&(r=nr(r)),n&&(b=nt(e,pr(n)));++d<w;)for(var O=0,M=r[d],j=n?n(M):M;(O=l(b,j,O,c))>-1;)b!==e&&Ln.call(b,O,1),Ln.call(e,O,1);return e}function Eu(e,r){for(var n=e?r.length:0,c=n-1;n--;){var l=r[n];if(n==c||l!==d){var d=l;ti(l)?Ln.call(e,l,1):xa(e,l)}}return e}function ba(e,r){return e+qn(ru()*(r-e+1))}function Dd(e,r,n,c){for(var l=-1,d=Mt($n((r-e)/(n||1)),0),w=N(d);d--;)w[c?d:++l]=e,e+=n;return w}function Ea(e,r){var n="";if(!e||r<1||r>V)return n;do r%2&&(n+=e),r=qn(r/2),r&&(e+=e);while(r);return n}function xe(e,r){return za(Xu(e,r,cr),e+"")}function $d(e){return nu(ps(e))}function qd(e,r){var n=ps(e);return Zn(n,Mi(r,0,n.length))}function Ms(e,r,n,c){if(!ht(e))return e;r=_i(r,e);for(var l=-1,d=r.length,w=d-1,b=e;b!=null&&++l<d;){var O=Fr(r[l]),M=n;if(O==="__proto__"||O==="constructor"||O==="prototype")return e;if(l!=w){var j=b[O];M=c?c(j,O,b):i,M===i&&(M=ht(j)?j:ti(r[l+1])?[]:{})}Ls(b,O,M),b=b[O]}return e}var Iu=Mn?function(e,r){return Mn.set(e,r),e}:cr,Md=Dn?function(e,r){return Dn(e,"toString",{configurable:!0,enumerable:!1,value:Ja(r),writable:!0})}:cr;function jd(e){return Zn(ps(e))}function Pr(e,r,n){var c=-1,l=e.length;r<0&&(r=-r>l?0:l+r),n=n>l?l:n,n<0&&(n+=l),l=r>n?0:n-r>>>0,r>>>=0;for(var d=N(l);++c<l;)d[c]=e[c+r];return d}function zd(e,r){var n;return mi(e,function(c,l,d){return n=r(c,l,d),!n}),!!n}function Bn(e,r,n){var c=0,l=e==null?c:e.length;if(typeof r=="number"&&r===r&&l<=Be){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!gr(w)&&(n?w<=r:w<r)?c=d+1:l=d}return l}return Ia(e,r,cr,n)}function Ia(e,r,n,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;r=n(r);for(var w=r!==r,b=r===null,O=gr(r),M=r===i;l<d;){var j=qn((l+d)/2),K=n(e[j]),J=K!==i,te=K===null,oe=K===K,Ee=gr(K);if(w)var ae=c||oe;else M?ae=oe&&(c||J):b?ae=oe&&J&&(c||!te):O?ae=oe&&J&&!te&&(c||!Ee):te||Ee?ae=!1:ae=c?K<=r:K<r;ae?l=j+1:d=j}return Vt(d,Qe)}function xu(e,r){for(var n=-1,c=e.length,l=0,d=[];++n<c;){var w=e[n],b=r?r(w):w;if(!n||!Lr(b,O)){var O=b;d[l++]=w===0?0:w}}return d}function Pu(e){return typeof e=="number"?e:gr(e)?B:+e}function dr(e){if(typeof e=="string")return e;if(we(e))return nt(e,dr)+"";if(gr(e))return iu?iu.call(e):"";var r=e+"";return r=="0"&&1/e==-ce?"-0":r}function wi(e,r,n){var c=-1,l=In,d=e.length,w=!0,b=[],O=b;if(n)w=!1,l=Xo;else if(d>=o){var M=r?null:Qd(e);if(M)return Pn(M);w=!1,l=Os,O=new qi}else O=r?[]:b;e:for(;++c<d;){var j=e[c],K=r?r(j):j;if(j=n||j!==0?j:0,w&&K===K){for(var J=O.length;J--;)if(O[J]===K)continue e;r&&O.push(K),b.push(j)}else l(O,K,n)||(O!==b&&O.push(K),b.push(j))}return b}function xa(e,r){return r=_i(r,e),e=Zu(e,r),e==null||delete e[Fr(Sr(r))]}function Su(e,r,n,c){return Ms(e,r,n(ji(e,r)),c)}function Fn(e,r,n,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&r(e[d],d,e););return n?Pr(e,c?0:d,c?d+1:l):Pr(e,c?d+1:0,c?l:d)}function Ou(e,r){var n=e;return n instanceof Oe&&(n=n.value()),Zo(r,function(c,l){return l.func.apply(l.thisArg,gi([c],l.args))},n)}function Pa(e,r,n){var c=e.length;if(c<2)return c?wi(e[0]):[];for(var l=-1,d=N(c);++l<c;)for(var w=e[l],b=-1;++b<c;)b!=l&&(d[l]=Ds(d[l]||w,e[b],r,n));return wi(Bt(d,1),r,n)}function Ru(e,r,n){for(var c=-1,l=e.length,d=r.length,w={};++c<l;){var b=c<d?r[c]:i;n(w,e[c],b)}return w}function Sa(e){return Et(e)?e:[]}function Oa(e){return typeof e=="function"?e:cr}function _i(e,r){return we(e)?e:qa(e,r)?[e]:ih(Me(e))}var Ud=xe;function bi(e,r,n){var c=e.length;return n=n===i?c:n,!r&&n>=c?e:Pr(e,r,n)}var Cu=Op||function(e){return Ce.clearTimeout(e)};function Au(e,r){if(r)return e.slice();var n=e.length,c=Yc?Yc(n):new e.constructor(n);return e.copy(c),c}function Ra(e){var r=new e.constructor(e.byteLength);return new Tn(r).set(new Tn(e)),r}function Hd(e,r){var n=r?Ra(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function kd(e){var r=new e.constructor(e.source,wr.exec(e));return r.lastIndex=e.lastIndex,r}function Kd(e){return Ns?Je(Ns.call(e)):{}}function Tu(e,r){var n=r?Ra(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Nu(e,r){if(e!==r){var n=e!==i,c=e===null,l=e===e,d=gr(e),w=r!==i,b=r===null,O=r===r,M=gr(r);if(!b&&!M&&!d&&e>r||d&&w&&O&&!b&&!M||c&&w&&O||!n&&O||!l)return 1;if(!c&&!d&&!M&&e<r||M&&n&&l&&!c&&!d||b&&n&&l||!w&&l||!O)return-1}return 0}function Bd(e,r,n){for(var c=-1,l=e.criteria,d=r.criteria,w=l.length,b=n.length;++c<w;){var O=Nu(l[c],d[c]);if(O){if(c>=b)return O;var M=n[c];return O*(M=="desc"?-1:1)}}return e.index-r.index}function Lu(e,r,n,c){for(var l=-1,d=e.length,w=n.length,b=-1,O=r.length,M=Mt(d-w,0),j=N(O+M),K=!c;++b<O;)j[b]=r[b];for(;++l<w;)(K||l<d)&&(j[n[l]]=e[l]);for(;M--;)j[b++]=e[l++];return j}function Du(e,r,n,c){for(var l=-1,d=e.length,w=-1,b=n.length,O=-1,M=r.length,j=Mt(d-b,0),K=N(j+M),J=!c;++l<j;)K[l]=e[l];for(var te=l;++O<M;)K[te+O]=r[O];for(;++w<b;)(J||l<d)&&(K[te+n[w]]=e[l++]);return K}function nr(e,r){var n=-1,c=e.length;for(r||(r=N(c));++n<c;)r[n]=e[n];return r}function Br(e,r,n,c){var l=!n;n||(n={});for(var d=-1,w=r.length;++d<w;){var b=r[d],O=c?c(n[b],e[b],b,n,e):i;O===i&&(O=e[b]),l?Xr(n,b,O):Ls(n,b,O)}return n}function Fd(e,r){return Br(e,$a(e),r)}function Vd(e,r){return Br(e,Gu(e),r)}function Vn(e,r){return function(n,c){var l=we(n)?Yf:dd,d=r?r():{};return l(n,e,ne(c,2),d)}}function us(e){return xe(function(r,n){var c=-1,l=n.length,d=l>1?n[l-1]:i,w=l>2?n[2]:i;for(d=e.length>3&&typeof d=="function"?(l--,d):i,w&&er(n[0],n[1],w)&&(d=l<3?i:d,l=1),r=Je(r);++c<l;){var b=n[c];b&&e(r,b,c,d)}return r})}function $u(e,r){return function(n,c){if(n==null)return n;if(!or(n))return e(n,c);for(var l=n.length,d=r?l:-1,w=Je(n);(r?d--:++d<l)&&c(w[d],d,w)!==!1;);return n}}function qu(e){return function(r,n,c){for(var l=-1,d=Je(r),w=c(r),b=w.length;b--;){var O=w[e?b:++l];if(n(d[O],O,d)===!1)break}return r}}function Gd(e,r,n){var c=r&re,l=js(e);function d(){var w=this&&this!==Ce&&this instanceof d?l:e;return w.apply(c?n:this,arguments)}return d}function Mu(e){return function(r){r=Me(r);var n=rs(r)?Tr(r):i,c=n?n[0]:r.charAt(0),l=n?bi(n,1).join(""):r.slice(1);return c[e]()+l}}function hs(e){return function(r){return Zo($h(Dh(r).replace(Ps,"")),e,"")}}function js(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var n=cs(e.prototype),c=e.apply(n,r);return ht(c)?c:n}}function Wd(e,r,n){var c=js(e);function l(){for(var d=arguments.length,w=N(d),b=d,O=ls(l);b--;)w[b]=arguments[b];var M=d<3&&w[0]!==O&&w[d-1]!==O?[]:vi(w,O);if(d-=M.length,d<n)return ku(e,r,Gn,l.placeholder,i,w,M,i,i,n-d);var j=this&&this!==Ce&&this instanceof l?c:e;return zt(j,this,w)}return l}function ju(e){return function(r,n,c){var l=Je(r);if(!or(r)){var d=ne(n,3);r=Ut(r),n=function(b){return d(l[b],b,l)}}var w=e(r,n,c);return w>-1?l[d?r[w]:w]:i}}function zu(e){return ei(function(r){var n=r.length,c=n,l=Ir.prototype.thru;for(e&&r.reverse();c--;){var d=r[c];if(typeof d!="function")throw new Er(f);if(l&&!w&&Yn(d)=="wrapper")var w=new Ir([],!0)}for(c=w?c:n;++c<n;){d=r[c];var b=Yn(d),O=b=="wrapper"?La(d):i;O&&Ma(O[0])&&O[1]==(H|fe|de|W)&&!O[4].length&&O[9]==1?w=w[Yn(O[0])].apply(w,O[3]):w=d.length==1&&Ma(d)?w[b]():w.thru(d)}return function(){var M=arguments,j=M[0];if(w&&M.length==1&&we(j))return w.plant(j).value();for(var K=0,J=n?r[K].apply(this,M):j;++K<n;)J=r[K].call(this,J);return J}})}function Gn(e,r,n,c,l,d,w,b,O,M){var j=r&H,K=r&re,J=r&he,te=r&(fe|pe),oe=r&ye,Ee=J?i:js(e);function ae(){for(var Pe=arguments.length,Ae=N(Pe),vr=Pe;vr--;)Ae[vr]=arguments[vr];if(te)var tr=ls(ae),yr=op(Ae,tr);if(c&&(Ae=Lu(Ae,c,l,te)),d&&(Ae=Du(Ae,d,w,te)),Pe-=yr,te&&Pe<M){var It=vi(Ae,tr);return ku(e,r,Gn,ae.placeholder,n,Ae,It,b,O,M-Pe)}var Dr=K?n:this,si=J?Dr[e]:e;return Pe=Ae.length,b?Ae=dg(Ae,b):oe&&Pe>1&&Ae.reverse(),j&&O<Pe&&(Ae.length=O),this&&this!==Ce&&this instanceof ae&&(si=Ee||js(si)),si.apply(Dr,Ae)}return ae}function Uu(e,r){return function(n,c){return Ed(n,e,r(c),{})}}function Wn(e,r){return function(n,c){var l;if(n===i&&c===i)return r;if(n!==i&&(l=n),c!==i){if(l===i)return c;typeof n=="string"||typeof c=="string"?(n=dr(n),c=dr(c)):(n=Pu(n),c=Pu(c)),l=e(n,c)}return l}}function Ca(e){return ei(function(r){return r=nt(r,pr(ne())),xe(function(n){var c=this;return e(r,function(l){return zt(l,c,n)})})})}function Jn(e,r){r=r===i?" ":dr(r);var n=r.length;if(n<2)return n?Ea(r,e):r;var c=Ea(r,$n(e/is(r)));return rs(r)?bi(Tr(c),0,e).join(""):c.slice(0,e)}function Jd(e,r,n,c){var l=r&re,d=js(e);function w(){for(var b=-1,O=arguments.length,M=-1,j=c.length,K=N(j+O),J=this&&this!==Ce&&this instanceof w?d:e;++M<j;)K[M]=c[M];for(;O--;)K[M++]=arguments[++b];return zt(J,l?n:this,K)}return w}function Hu(e){return function(r,n,c){return c&&typeof c!="number"&&er(r,n,c)&&(n=c=i),r=ii(r),n===i?(n=r,r=0):n=ii(n),c=c===i?r<n?1:-1:ii(c),Dd(r,n,c,e)}}function Qn(e){return function(r,n){return typeof r=="string"&&typeof n=="string"||(r=Or(r),n=Or(n)),e(r,n)}}function ku(e,r,n,c,l,d,w,b,O,M){var j=r&fe,K=j?w:i,J=j?i:w,te=j?d:i,oe=j?i:d;r|=j?de:$,r&=~(j?$:de),r&le||(r&=~(re|he));var Ee=[e,r,l,te,K,oe,J,b,O,M],ae=n.apply(i,Ee);return Ma(e)&&eh(ae,Ee),ae.placeholder=c,th(ae,e,r)}function Aa(e){var r=qt[e];return function(n,c){if(n=Or(n),c=c==null?0:Vt(_e(c),292),c&&tu(n)){var l=(Me(n)+"e").split("e"),d=r(l[0]+"e"+(+l[1]+c));return l=(Me(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return r(n)}}var Qd=os&&1/Pn(new os([,-0]))[1]==ce?function(e){return new os(e)}:Xa;function Ku(e){return function(r){var n=Gt(r);return n==be?oa(r):n==qe?pp(r):np(r,e(r))}}function Zr(e,r,n,c,l,d,w,b){var O=r&he;if(!O&&typeof e!="function")throw new Er(f);var M=c?c.length:0;if(M||(r&=~(de|$),c=l=i),w=w===i?w:Mt(_e(w),0),b=b===i?b:_e(b),M-=l?l.length:0,r&$){var j=c,K=l;c=l=i}var J=O?i:La(e),te=[e,r,n,c,l,j,K,d,w,b];if(J&&lg(te,J),e=te[0],r=te[1],n=te[2],c=te[3],l=te[4],b=te[9]=te[9]===i?O?0:e.length:Mt(te[9]-M,0),!b&&r&(fe|pe)&&(r&=~(fe|pe)),!r||r==re)var oe=Gd(e,r,n);else r==fe||r==pe?oe=Wd(e,r,b):(r==de||r==(re|de))&&!l.length?oe=Jd(e,r,n,c):oe=Gn.apply(i,te);var Ee=J?Iu:eh;return th(Ee(oe,te),e,r)}function Bu(e,r,n,c){return e===i||Lr(e,ns[n])&&!ze.call(c,n)?r:e}function Fu(e,r,n,c,l,d){return ht(e)&&ht(r)&&(d.set(r,e),Kn(e,r,i,Fu,d),d.delete(r)),e}function Yd(e){return Hs(e)?i:e}function Vu(e,r,n,c,l,d){var w=n&T,b=e.length,O=r.length;if(b!=O&&!(w&&O>b))return!1;var M=d.get(e),j=d.get(r);if(M&&j)return M==r&&j==e;var K=-1,J=!0,te=n&F?new qi:i;for(d.set(e,r),d.set(r,e);++K<b;){var oe=e[K],Ee=r[K];if(c)var ae=w?c(Ee,oe,K,r,e,d):c(oe,Ee,K,e,r,d);if(ae!==i){if(ae)continue;J=!1;break}if(te){if(!ea(r,function(Pe,Ae){if(!Os(te,Ae)&&(oe===Pe||l(oe,Pe,n,c,d)))return te.push(Ae)})){J=!1;break}}else if(!(oe===Ee||l(oe,Ee,n,c,d))){J=!1;break}}return d.delete(e),d.delete(r),J}function Xd(e,r,n,c,l,d,w){switch(n){case Fe:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Le:return!(e.byteLength!=r.byteLength||!d(new Tn(e),new Tn(r)));case L:case C:case Ne:return Lr(+e,+r);case E:return e.name==r.name&&e.message==r.message;case at:case Xe:return e==r+"";case be:var b=oa;case qe:var O=c&T;if(b||(b=Pn),e.size!=r.size&&!O)return!1;var M=w.get(e);if(M)return M==r;c|=F,w.set(e,r);var j=Vu(b(e),b(r),c,l,d,w);return w.delete(e),j;case Ze:if(Ns)return Ns.call(e)==Ns.call(r)}return!1}function Zd(e,r,n,c,l,d){var w=n&T,b=Ta(e),O=b.length,M=Ta(r),j=M.length;if(O!=j&&!w)return!1;for(var K=O;K--;){var J=b[K];if(!(w?J in r:ze.call(r,J)))return!1}var te=d.get(e),oe=d.get(r);if(te&&oe)return te==r&&oe==e;var Ee=!0;d.set(e,r),d.set(r,e);for(var ae=w;++K<O;){J=b[K];var Pe=e[J],Ae=r[J];if(c)var vr=w?c(Ae,Pe,J,r,e,d):c(Pe,Ae,J,e,r,d);if(!(vr===i?Pe===Ae||l(Pe,Ae,n,c,d):vr)){Ee=!1;break}ae||(ae=J=="constructor")}if(Ee&&!ae){var tr=e.constructor,yr=r.constructor;tr!=yr&&"constructor"in e&&"constructor"in r&&!(typeof tr=="function"&&tr instanceof tr&&typeof yr=="function"&&yr instanceof yr)&&(Ee=!1)}return d.delete(e),d.delete(r),Ee}function ei(e){return za(Xu(e,i,ah),e+"")}function Ta(e){return fu(e,Ut,$a)}function Na(e){return fu(e,ar,Gu)}var La=Mn?function(e){return Mn.get(e)}:Xa;function Yn(e){for(var r=e.name+"",n=as[r],c=ze.call(as,r)?n.length:0;c--;){var l=n[c],d=l.func;if(d==null||d==e)return l.name}return r}function ls(e){var r=ze.call(p,"placeholder")?p:e;return r.placeholder}function ne(){var e=p.iteratee||Qa;return e=e===Qa?gu:e,arguments.length?e(arguments[0],arguments[1]):e}function Xn(e,r){var n=e.__data__;return ag(r)?n[typeof r=="string"?"string":"hash"]:n.map}function Da(e){for(var r=Ut(e),n=r.length;n--;){var c=r[n],l=e[c];r[n]=[c,l,Qu(l)]}return r}function zi(e,r){var n=hp(e,r);return du(n)?n:i}function eg(e){var r=ze.call(e,Di),n=e[Di];try{e[Di]=i;var c=!0}catch{}var l=Cn.call(e);return c&&(r?e[Di]=n:delete e[Di]),l}var $a=ca?function(e){return e==null?[]:(e=Je(e),di(ca(e),function(r){return Zc.call(e,r)}))}:Za,Gu=ca?function(e){for(var r=[];e;)gi(r,$a(e)),e=Nn(e);return r}:Za,Gt=Zt;(ua&&Gt(new ua(new ArrayBuffer(1)))!=Fe||Cs&&Gt(new Cs)!=be||ha&&Gt(ha.resolve())!=Pt||os&&Gt(new os)!=qe||As&&Gt(new As)!=He)&&(Gt=function(e){var r=Zt(e),n=r==Se?e.constructor:i,c=n?Ui(n):"";if(c)switch(c){case qp:return Fe;case Mp:return be;case jp:return Pt;case zp:return qe;case Up:return He}return r});function tg(e,r,n){for(var c=-1,l=n.length;++c<l;){var d=n[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":r-=w;break;case"take":r=Vt(r,e+w);break;case"takeRight":e=Mt(e,r-w);break}}return{start:e,end:r}}function rg(e){var r=e.match(Ye);return r?r[1].split(At):[]}function Wu(e,r,n){r=_i(r,e);for(var c=-1,l=r.length,d=!1;++c<l;){var w=Fr(r[c]);if(!(d=e!=null&&n(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&no(l)&&ti(w,l)&&(we(e)||Hi(e)))}function ig(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&ze.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Ju(e){return typeof e.constructor=="function"&&!zs(e)?cs(Nn(e)):{}}function sg(e,r,n){var c=e.constructor;switch(r){case Le:return Ra(e);case L:case C:return new c(+e);case Fe:return Hd(e,n);case lt:case je:case St:case $t:case kt:case Kt:case jt:case Qt:case ir:return Tu(e,n);case be:return new c;case Ne:case Xe:return new c(e);case at:return kd(e);case qe:return new c;case Ze:return Kd(e)}}function ng(e,r){var n=r.length;if(!n)return e;var c=n-1;return r[c]=(n>1?"& ":"")+r[c],r=r.join(n>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+r+`] */
`)}function og(e){return we(e)||Hi(e)||!!(eu&&e&&e[eu])}function ti(e,r){var n=typeof e;return r=r??V,!!r&&(n=="number"||n!="symbol"&&jo.test(e))&&e>-1&&e%1==0&&e<r}function er(e,r,n){if(!ht(n))return!1;var c=typeof r;return(c=="number"?or(n)&&ti(r,n.length):c=="string"&&r in n)?Lr(n[r],e):!1}function qa(e,r){if(we(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||gr(e)?!0:Ot.test(e)||!st.test(e)||r!=null&&e in Je(r)}function ag(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Ma(e){var r=Yn(e),n=p[r];if(typeof n!="function"||!(r in Oe.prototype))return!1;if(e===n)return!0;var c=La(n);return!!c&&e===c[0]}function cg(e){return!!Qc&&Qc in e}var ug=On?ri:ec;function zs(e){var r=e&&e.constructor,n=typeof r=="function"&&r.prototype||ns;return e===n}function Qu(e){return e===e&&!ht(e)}function Yu(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==i||e in Je(n))}}function hg(e){var r=io(e,function(c){return n.size===v&&n.clear(),c}),n=r.cache;return r}function lg(e,r){var n=e[1],c=r[1],l=n|c,d=l<(re|he|H),w=c==H&&n==fe||c==H&&n==W&&e[7].length<=r[8]||c==(H|W)&&r[7].length<=r[8]&&n==fe;if(!(d||w))return e;c&re&&(e[2]=r[2],l|=n&re?0:le);var b=r[3];if(b){var O=e[3];e[3]=O?Lu(O,b,r[4]):b,e[4]=O?vi(e[3],I):r[4]}return b=r[5],b&&(O=e[5],e[5]=O?Du(O,b,r[6]):b,e[6]=O?vi(e[5],I):r[6]),b=r[7],b&&(e[7]=b),c&H&&(e[8]=e[8]==null?r[8]:Vt(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=l,e}function fg(e){var r=[];if(e!=null)for(var n in Je(e))r.push(n);return r}function pg(e){return Cn.call(e)}function Xu(e,r,n){return r=Mt(r===i?e.length-1:r,0),function(){for(var c=arguments,l=-1,d=Mt(c.length-r,0),w=N(d);++l<d;)w[l]=c[r+l];l=-1;for(var b=N(r+1);++l<r;)b[l]=c[l];return b[r]=n(w),zt(e,this,b)}}function Zu(e,r){return r.length<2?e:ji(e,Pr(r,0,-1))}function dg(e,r){for(var n=e.length,c=Vt(r.length,n),l=nr(e);c--;){var d=r[c];e[c]=ti(d,n)?l[d]:i}return e}function ja(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var eh=rh(Iu),Us=Cp||function(e,r){return Ce.setTimeout(e,r)},za=rh(Md);function th(e,r,n){var c=r+"";return za(e,ng(c,gg(rg(c),n)))}function rh(e){var r=0,n=0;return function(){var c=Lp(),l=Ue-(c-n);if(n=c,l>0){if(++r>=Te)return arguments[0]}else r=0;return e.apply(i,arguments)}}function Zn(e,r){var n=-1,c=e.length,l=c-1;for(r=r===i?c:r;++n<r;){var d=ba(n,l),w=e[d];e[d]=e[n],e[n]=w}return e.length=r,e}var ih=hg(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Rt,function(n,c,l,d){r.push(l?d.replace(No,"$1"):c||n)}),r});function Fr(e){if(typeof e=="string"||gr(e))return e;var r=e+"";return r=="0"&&1/e==-ce?"-0":r}function Ui(e){if(e!=null){try{return Rn.call(e)}catch{}try{return e+""}catch{}}return""}function gg(e,r){return br(zr,function(n){var c="_."+n[0];r&n[1]&&!In(e,c)&&e.push(c)}),e.sort()}function sh(e){if(e instanceof Oe)return e.clone();var r=new Ir(e.__wrapped__,e.__chain__);return r.__actions__=nr(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function vg(e,r,n){(n?er(e,r,n):r===i)?r=1:r=Mt(_e(r),0);var c=e==null?0:e.length;if(!c||r<1)return[];for(var l=0,d=0,w=N($n(c/r));l<c;)w[d++]=Pr(e,l,l+=r);return w}function yg(e){for(var r=-1,n=e==null?0:e.length,c=0,l=[];++r<n;){var d=e[r];d&&(l[c++]=d)}return l}function mg(){var e=arguments.length;if(!e)return[];for(var r=N(e-1),n=arguments[0],c=e;c--;)r[c-1]=arguments[c];return gi(we(n)?nr(n):[n],Bt(r,1))}var wg=xe(function(e,r){return Et(e)?Ds(e,Bt(r,1,Et,!0)):[]}),_g=xe(function(e,r){var n=Sr(r);return Et(n)&&(n=i),Et(e)?Ds(e,Bt(r,1,Et,!0),ne(n,2)):[]}),bg=xe(function(e,r){var n=Sr(r);return Et(n)&&(n=i),Et(e)?Ds(e,Bt(r,1,Et,!0),i,n):[]});function Eg(e,r,n){var c=e==null?0:e.length;return c?(r=n||r===i?1:_e(r),Pr(e,r<0?0:r,c)):[]}function Ig(e,r,n){var c=e==null?0:e.length;return c?(r=n||r===i?1:_e(r),r=c-r,Pr(e,0,r<0?0:r)):[]}function xg(e,r){return e&&e.length?Fn(e,ne(r,3),!0,!0):[]}function Pg(e,r){return e&&e.length?Fn(e,ne(r,3),!0):[]}function Sg(e,r,n,c){var l=e==null?0:e.length;return l?(n&&typeof n!="number"&&er(e,r,n)&&(n=0,c=l),md(e,r,n,c)):[]}function nh(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=n==null?0:_e(n);return l<0&&(l=Mt(c+l,0)),xn(e,ne(r,3),l)}function oh(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return n!==i&&(l=_e(n),l=n<0?Mt(c+l,0):Vt(l,c-1)),xn(e,ne(r,3),l,!0)}function ah(e){var r=e==null?0:e.length;return r?Bt(e,1):[]}function Og(e){var r=e==null?0:e.length;return r?Bt(e,ce):[]}function Rg(e,r){var n=e==null?0:e.length;return n?(r=r===i?1:_e(r),Bt(e,r)):[]}function Cg(e){for(var r=-1,n=e==null?0:e.length,c={};++r<n;){var l=e[r];c[l[0]]=l[1]}return c}function ch(e){return e&&e.length?e[0]:i}function Ag(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=n==null?0:_e(n);return l<0&&(l=Mt(c+l,0)),ts(e,r,l)}function Tg(e){var r=e==null?0:e.length;return r?Pr(e,0,-1):[]}var Ng=xe(function(e){var r=nt(e,Sa);return r.length&&r[0]===e[0]?va(r):[]}),Lg=xe(function(e){var r=Sr(e),n=nt(e,Sa);return r===Sr(n)?r=i:n.pop(),n.length&&n[0]===e[0]?va(n,ne(r,2)):[]}),Dg=xe(function(e){var r=Sr(e),n=nt(e,Sa);return r=typeof r=="function"?r:i,r&&n.pop(),n.length&&n[0]===e[0]?va(n,i,r):[]});function $g(e,r){return e==null?"":Tp.call(e,r)}function Sr(e){var r=e==null?0:e.length;return r?e[r-1]:i}function qg(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=c;return n!==i&&(l=_e(n),l=l<0?Mt(c+l,0):Vt(l,c-1)),r===r?gp(e,r,l):xn(e,kc,l,!0)}function Mg(e,r){return e&&e.length?wu(e,_e(r)):i}var jg=xe(uh);function uh(e,r){return e&&e.length&&r&&r.length?_a(e,r):e}function zg(e,r,n){return e&&e.length&&r&&r.length?_a(e,r,ne(n,2)):e}function Ug(e,r,n){return e&&e.length&&r&&r.length?_a(e,r,i,n):e}var Hg=ei(function(e,r){var n=e==null?0:e.length,c=fa(e,r);return Eu(e,nt(r,function(l){return ti(l,n)?+l:l}).sort(Nu)),c});function kg(e,r){var n=[];if(!(e&&e.length))return n;var c=-1,l=[],d=e.length;for(r=ne(r,3);++c<d;){var w=e[c];r(w,c,e)&&(n.push(w),l.push(c))}return Eu(e,l),n}function Ua(e){return e==null?e:$p.call(e)}function Kg(e,r,n){var c=e==null?0:e.length;return c?(n&&typeof n!="number"&&er(e,r,n)?(r=0,n=c):(r=r==null?0:_e(r),n=n===i?c:_e(n)),Pr(e,r,n)):[]}function Bg(e,r){return Bn(e,r)}function Fg(e,r,n){return Ia(e,r,ne(n,2))}function Vg(e,r){var n=e==null?0:e.length;if(n){var c=Bn(e,r);if(c<n&&Lr(e[c],r))return c}return-1}function Gg(e,r){return Bn(e,r,!0)}function Wg(e,r,n){return Ia(e,r,ne(n,2),!0)}function Jg(e,r){var n=e==null?0:e.length;if(n){var c=Bn(e,r,!0)-1;if(Lr(e[c],r))return c}return-1}function Qg(e){return e&&e.length?xu(e):[]}function Yg(e,r){return e&&e.length?xu(e,ne(r,2)):[]}function Xg(e){var r=e==null?0:e.length;return r?Pr(e,1,r):[]}function Zg(e,r,n){return e&&e.length?(r=n||r===i?1:_e(r),Pr(e,0,r<0?0:r)):[]}function ev(e,r,n){var c=e==null?0:e.length;return c?(r=n||r===i?1:_e(r),r=c-r,Pr(e,r<0?0:r,c)):[]}function tv(e,r){return e&&e.length?Fn(e,ne(r,3),!1,!0):[]}function rv(e,r){return e&&e.length?Fn(e,ne(r,3)):[]}var iv=xe(function(e){return wi(Bt(e,1,Et,!0))}),sv=xe(function(e){var r=Sr(e);return Et(r)&&(r=i),wi(Bt(e,1,Et,!0),ne(r,2))}),nv=xe(function(e){var r=Sr(e);return r=typeof r=="function"?r:i,wi(Bt(e,1,Et,!0),i,r)});function ov(e){return e&&e.length?wi(e):[]}function av(e,r){return e&&e.length?wi(e,ne(r,2)):[]}function cv(e,r){return r=typeof r=="function"?r:i,e&&e.length?wi(e,i,r):[]}function Ha(e){if(!(e&&e.length))return[];var r=0;return e=di(e,function(n){if(Et(n))return r=Mt(n.length,r),!0}),sa(r,function(n){return nt(e,ta(n))})}function hh(e,r){if(!(e&&e.length))return[];var n=Ha(e);return r==null?n:nt(n,function(c){return zt(r,i,c)})}var uv=xe(function(e,r){return Et(e)?Ds(e,r):[]}),hv=xe(function(e){return Pa(di(e,Et))}),lv=xe(function(e){var r=Sr(e);return Et(r)&&(r=i),Pa(di(e,Et),ne(r,2))}),fv=xe(function(e){var r=Sr(e);return r=typeof r=="function"?r:i,Pa(di(e,Et),i,r)}),pv=xe(Ha);function dv(e,r){return Ru(e||[],r||[],Ls)}function gv(e,r){return Ru(e||[],r||[],Ms)}var vv=xe(function(e){var r=e.length,n=r>1?e[r-1]:i;return n=typeof n=="function"?(e.pop(),n):i,hh(e,n)});function lh(e){var r=p(e);return r.__chain__=!0,r}function yv(e,r){return r(e),e}function eo(e,r){return r(e)}var mv=ei(function(e){var r=e.length,n=r?e[0]:0,c=this.__wrapped__,l=function(d){return fa(d,e)};return r>1||this.__actions__.length||!(c instanceof Oe)||!ti(n)?this.thru(l):(c=c.slice(n,+n+(r?1:0)),c.__actions__.push({func:eo,args:[l],thisArg:i}),new Ir(c,this.__chain__).thru(function(d){return r&&!d.length&&d.push(i),d}))});function wv(){return lh(this)}function _v(){return new Ir(this.value(),this.__chain__)}function bv(){this.__values__===i&&(this.__values__=Ph(this.value()));var e=this.__index__>=this.__values__.length,r=e?i:this.__values__[this.__index__++];return{done:e,value:r}}function Ev(){return this}function Iv(e){for(var r,n=this;n instanceof zn;){var c=sh(n);c.__index__=0,c.__values__=i,r?l.__wrapped__=c:r=c;var l=c;n=n.__wrapped__}return l.__wrapped__=e,r}function xv(){var e=this.__wrapped__;if(e instanceof Oe){var r=e;return this.__actions__.length&&(r=new Oe(this)),r=r.reverse(),r.__actions__.push({func:eo,args:[Ua],thisArg:i}),new Ir(r,this.__chain__)}return this.thru(Ua)}function Pv(){return Ou(this.__wrapped__,this.__actions__)}var Sv=Vn(function(e,r,n){ze.call(e,n)?++e[n]:Xr(e,n,1)});function Ov(e,r,n){var c=we(e)?Uc:yd;return n&&er(e,r,n)&&(r=i),c(e,ne(r,3))}function Rv(e,r){var n=we(e)?di:hu;return n(e,ne(r,3))}var Cv=ju(nh),Av=ju(oh);function Tv(e,r){return Bt(to(e,r),1)}function Nv(e,r){return Bt(to(e,r),ce)}function Lv(e,r,n){return n=n===i?1:_e(n),Bt(to(e,r),n)}function fh(e,r){var n=we(e)?br:mi;return n(e,ne(r,3))}function ph(e,r){var n=we(e)?Xf:uu;return n(e,ne(r,3))}var Dv=Vn(function(e,r,n){ze.call(e,n)?e[n].push(r):Xr(e,n,[r])});function $v(e,r,n,c){e=or(e)?e:ps(e),n=n&&!c?_e(n):0;var l=e.length;return n<0&&(n=Mt(l+n,0)),oo(e)?n<=l&&e.indexOf(r,n)>-1:!!l&&ts(e,r,n)>-1}var qv=xe(function(e,r,n){var c=-1,l=typeof r=="function",d=or(e)?N(e.length):[];return mi(e,function(w){d[++c]=l?zt(r,w,n):$s(w,r,n)}),d}),Mv=Vn(function(e,r,n){Xr(e,n,r)});function to(e,r){var n=we(e)?nt:vu;return n(e,ne(r,3))}function jv(e,r,n,c){return e==null?[]:(we(r)||(r=r==null?[]:[r]),n=c?i:n,we(n)||(n=n==null?[]:[n]),_u(e,r,n))}var zv=Vn(function(e,r,n){e[n?0:1].push(r)},function(){return[[],[]]});function Uv(e,r,n){var c=we(e)?Zo:Bc,l=arguments.length<3;return c(e,ne(r,4),n,l,mi)}function Hv(e,r,n){var c=we(e)?Zf:Bc,l=arguments.length<3;return c(e,ne(r,4),n,l,uu)}function kv(e,r){var n=we(e)?di:hu;return n(e,so(ne(r,3)))}function Kv(e){var r=we(e)?nu:$d;return r(e)}function Bv(e,r,n){(n?er(e,r,n):r===i)?r=1:r=_e(r);var c=we(e)?fd:qd;return c(e,r)}function Fv(e){var r=we(e)?pd:jd;return r(e)}function Vv(e){if(e==null)return 0;if(or(e))return oo(e)?is(e):e.length;var r=Gt(e);return r==be||r==qe?e.size:ma(e).length}function Gv(e,r,n){var c=we(e)?ea:zd;return n&&er(e,r,n)&&(r=i),c(e,ne(r,3))}var Wv=xe(function(e,r){if(e==null)return[];var n=r.length;return n>1&&er(e,r[0],r[1])?r=[]:n>2&&er(r[0],r[1],r[2])&&(r=[r[0]]),_u(e,Bt(r,1),[])}),ro=Rp||function(){return Ce.Date.now()};function Jv(e,r){if(typeof r!="function")throw new Er(f);return e=_e(e),function(){if(--e<1)return r.apply(this,arguments)}}function dh(e,r,n){return r=n?i:r,r=e&&r==null?e.length:r,Zr(e,H,i,i,i,i,r)}function gh(e,r){var n;if(typeof r!="function")throw new Er(f);return e=_e(e),function(){return--e>0&&(n=r.apply(this,arguments)),e<=1&&(r=i),n}}var ka=xe(function(e,r,n){var c=re;if(n.length){var l=vi(n,ls(ka));c|=de}return Zr(e,c,r,n,l)}),vh=xe(function(e,r,n){var c=re|he;if(n.length){var l=vi(n,ls(vh));c|=de}return Zr(r,c,e,n,l)});function yh(e,r,n){r=n?i:r;var c=Zr(e,fe,i,i,i,i,i,r);return c.placeholder=yh.placeholder,c}function mh(e,r,n){r=n?i:r;var c=Zr(e,pe,i,i,i,i,i,r);return c.placeholder=mh.placeholder,c}function wh(e,r,n){var c,l,d,w,b,O,M=0,j=!1,K=!1,J=!0;if(typeof e!="function")throw new Er(f);r=Or(r)||0,ht(n)&&(j=!!n.leading,K="maxWait"in n,d=K?Mt(Or(n.maxWait)||0,r):d,J="trailing"in n?!!n.trailing:J);function te(It){var Dr=c,si=l;return c=l=i,M=It,w=e.apply(si,Dr),w}function oe(It){return M=It,b=Us(Pe,r),j?te(It):w}function Ee(It){var Dr=It-O,si=It-M,jh=r-Dr;return K?Vt(jh,d-si):jh}function ae(It){var Dr=It-O,si=It-M;return O===i||Dr>=r||Dr<0||K&&si>=d}function Pe(){var It=ro();if(ae(It))return Ae(It);b=Us(Pe,Ee(It))}function Ae(It){return b=i,J&&c?te(It):(c=l=i,w)}function vr(){b!==i&&Cu(b),M=0,c=O=l=b=i}function tr(){return b===i?w:Ae(ro())}function yr(){var It=ro(),Dr=ae(It);if(c=arguments,l=this,O=It,Dr){if(b===i)return oe(O);if(K)return Cu(b),b=Us(Pe,r),te(O)}return b===i&&(b=Us(Pe,r)),w}return yr.cancel=vr,yr.flush=tr,yr}var Qv=xe(function(e,r){return cu(e,1,r)}),Yv=xe(function(e,r,n){return cu(e,Or(r)||0,n)});function Xv(e){return Zr(e,ye)}function io(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new Er(f);var n=function(){var c=arguments,l=r?r.apply(this,c):c[0],d=n.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return n.cache=d.set(l,w)||d,w};return n.cache=new(io.Cache||Yr),n}io.Cache=Yr;function so(e){if(typeof e!="function")throw new Er(f);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Zv(e){return gh(2,e)}var ey=Ud(function(e,r){r=r.length==1&&we(r[0])?nt(r[0],pr(ne())):nt(Bt(r,1),pr(ne()));var n=r.length;return xe(function(c){for(var l=-1,d=Vt(c.length,n);++l<d;)c[l]=r[l].call(this,c[l]);return zt(e,this,c)})}),Ka=xe(function(e,r){var n=vi(r,ls(Ka));return Zr(e,de,i,r,n)}),_h=xe(function(e,r){var n=vi(r,ls(_h));return Zr(e,$,i,r,n)}),ty=ei(function(e,r){return Zr(e,W,i,i,i,r)});function ry(e,r){if(typeof e!="function")throw new Er(f);return r=r===i?r:_e(r),xe(e,r)}function iy(e,r){if(typeof e!="function")throw new Er(f);return r=r==null?0:Mt(_e(r),0),xe(function(n){var c=n[r],l=bi(n,0,r);return c&&gi(l,c),zt(e,this,l)})}function sy(e,r,n){var c=!0,l=!0;if(typeof e!="function")throw new Er(f);return ht(n)&&(c="leading"in n?!!n.leading:c,l="trailing"in n?!!n.trailing:l),wh(e,r,{leading:c,maxWait:r,trailing:l})}function ny(e){return dh(e,1)}function oy(e,r){return Ka(Oa(r),e)}function ay(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function cy(e){return xr(e,z)}function uy(e,r){return r=typeof r=="function"?r:i,xr(e,z,r)}function hy(e){return xr(e,R|z)}function ly(e,r){return r=typeof r=="function"?r:i,xr(e,R|z,r)}function fy(e,r){return r==null||au(e,r,Ut(r))}function Lr(e,r){return e===r||e!==e&&r!==r}var py=Qn(ga),dy=Qn(function(e,r){return e>=r}),Hi=pu(function(){return arguments}())?pu:function(e){return mt(e)&&ze.call(e,"callee")&&!Zc.call(e,"callee")},we=N.isArray,gy=Xt?pr(Xt):Id;function or(e){return e!=null&&no(e.length)&&!ri(e)}function Et(e){return mt(e)&&or(e)}function vy(e){return e===!0||e===!1||mt(e)&&Zt(e)==L}var Ei=Ap||ec,yy=Ar?pr(Ar):xd;function my(e){return mt(e)&&e.nodeType===1&&!Hs(e)}function wy(e){if(e==null)return!0;if(or(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||Ei(e)||fs(e)||Hi(e)))return!e.length;var r=Gt(e);if(r==be||r==qe)return!e.size;if(zs(e))return!ma(e).length;for(var n in e)if(ze.call(e,n))return!1;return!0}function _y(e,r){return qs(e,r)}function by(e,r,n){n=typeof n=="function"?n:i;var c=n?n(e,r):i;return c===i?qs(e,r,i,n):!!c}function Ba(e){if(!mt(e))return!1;var r=Zt(e);return r==E||r==u||typeof e.message=="string"&&typeof e.name=="string"&&!Hs(e)}function Ey(e){return typeof e=="number"&&tu(e)}function ri(e){if(!ht(e))return!1;var r=Zt(e);return r==ee||r==ge||r==D||r==wt}function bh(e){return typeof e=="number"&&e==_e(e)}function no(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ht(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function mt(e){return e!=null&&typeof e=="object"}var Eh=_r?pr(_r):Sd;function Iy(e,r){return e===r||ya(e,r,Da(r))}function xy(e,r,n){return n=typeof n=="function"?n:i,ya(e,r,Da(r),n)}function Py(e){return Ih(e)&&e!=+e}function Sy(e){if(ug(e))throw new ve(h);return du(e)}function Oy(e){return e===null}function Ry(e){return e==null}function Ih(e){return typeof e=="number"||mt(e)&&Zt(e)==Ne}function Hs(e){if(!mt(e)||Zt(e)!=Se)return!1;var r=Nn(e);if(r===null)return!0;var n=ze.call(r,"constructor")&&r.constructor;return typeof n=="function"&&n instanceof n&&Rn.call(n)==xp}var Fa=kr?pr(kr):Od;function Cy(e){return bh(e)&&e>=-V&&e<=V}var xh=Ss?pr(Ss):Rd;function oo(e){return typeof e=="string"||!we(e)&&mt(e)&&Zt(e)==Xe}function gr(e){return typeof e=="symbol"||mt(e)&&Zt(e)==Ze}var fs=Li?pr(Li):Cd;function Ay(e){return e===i}function Ty(e){return mt(e)&&Gt(e)==He}function Ny(e){return mt(e)&&Zt(e)==et}var Ly=Qn(wa),Dy=Qn(function(e,r){return e<=r});function Ph(e){if(!e)return[];if(or(e))return oo(e)?Tr(e):nr(e);if(Rs&&e[Rs])return fp(e[Rs]());var r=Gt(e),n=r==be?oa:r==qe?Pn:ps;return n(e)}function ii(e){if(!e)return e===0?e:0;if(e=Or(e),e===ce||e===-ce){var r=e<0?-1:1;return r*k}return e===e?e:0}function _e(e){var r=ii(e),n=r%1;return r===r?n?r-n:r:0}function Sh(e){return e?Mi(_e(e),0,G):0}function Or(e){if(typeof e=="number")return e;if(gr(e))return B;if(ht(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ht(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Fc(e);var n=$o.test(e);return n||Mo.test(e)?me(e.slice(2),n?2:8):Do.test(e)?B:+e}function Oh(e){return Br(e,ar(e))}function $y(e){return e?Mi(_e(e),-V,V):e===0?e:0}function Me(e){return e==null?"":dr(e)}var qy=us(function(e,r){if(zs(r)||or(r)){Br(r,Ut(r),e);return}for(var n in r)ze.call(r,n)&&Ls(e,n,r[n])}),Rh=us(function(e,r){Br(r,ar(r),e)}),ao=us(function(e,r,n,c){Br(r,ar(r),e,c)}),My=us(function(e,r,n,c){Br(r,Ut(r),e,c)}),jy=ei(fa);function zy(e,r){var n=cs(e);return r==null?n:ou(n,r)}var Uy=xe(function(e,r){e=Je(e);var n=-1,c=r.length,l=c>2?r[2]:i;for(l&&er(r[0],r[1],l)&&(c=1);++n<c;)for(var d=r[n],w=ar(d),b=-1,O=w.length;++b<O;){var M=w[b],j=e[M];(j===i||Lr(j,ns[M])&&!ze.call(e,M))&&(e[M]=d[M])}return e}),Hy=xe(function(e){return e.push(i,Fu),zt(Ch,i,e)});function ky(e,r){return Hc(e,ne(r,3),Kr)}function Ky(e,r){return Hc(e,ne(r,3),da)}function By(e,r){return e==null?e:pa(e,ne(r,3),ar)}function Fy(e,r){return e==null?e:lu(e,ne(r,3),ar)}function Vy(e,r){return e&&Kr(e,ne(r,3))}function Gy(e,r){return e&&da(e,ne(r,3))}function Wy(e){return e==null?[]:kn(e,Ut(e))}function Jy(e){return e==null?[]:kn(e,ar(e))}function Va(e,r,n){var c=e==null?i:ji(e,r);return c===i?n:c}function Qy(e,r){return e!=null&&Wu(e,r,wd)}function Ga(e,r){return e!=null&&Wu(e,r,_d)}var Yy=Uu(function(e,r,n){r!=null&&typeof r.toString!="function"&&(r=Cn.call(r)),e[r]=n},Ja(cr)),Xy=Uu(function(e,r,n){r!=null&&typeof r.toString!="function"&&(r=Cn.call(r)),ze.call(e,r)?e[r].push(n):e[r]=[n]},ne),Zy=xe($s);function Ut(e){return or(e)?su(e):ma(e)}function ar(e){return or(e)?su(e,!0):Ad(e)}function em(e,r){var n={};return r=ne(r,3),Kr(e,function(c,l,d){Xr(n,r(c,l,d),c)}),n}function tm(e,r){var n={};return r=ne(r,3),Kr(e,function(c,l,d){Xr(n,l,r(c,l,d))}),n}var rm=us(function(e,r,n){Kn(e,r,n)}),Ch=us(function(e,r,n,c){Kn(e,r,n,c)}),im=ei(function(e,r){var n={};if(e==null)return n;var c=!1;r=nt(r,function(d){return d=_i(d,e),c||(c=d.length>1),d}),Br(e,Na(e),n),c&&(n=xr(n,R|A|z,Yd));for(var l=r.length;l--;)xa(n,r[l]);return n});function sm(e,r){return Ah(e,so(ne(r)))}var nm=ei(function(e,r){return e==null?{}:Nd(e,r)});function Ah(e,r){if(e==null)return{};var n=nt(Na(e),function(c){return[c]});return r=ne(r),bu(e,n,function(c,l){return r(c,l[0])})}function om(e,r,n){r=_i(r,e);var c=-1,l=r.length;for(l||(l=1,e=i);++c<l;){var d=e==null?i:e[Fr(r[c])];d===i&&(c=l,d=n),e=ri(d)?d.call(e):d}return e}function am(e,r,n){return e==null?e:Ms(e,r,n)}function cm(e,r,n,c){return c=typeof c=="function"?c:i,e==null?e:Ms(e,r,n,c)}var Th=Ku(Ut),Nh=Ku(ar);function um(e,r,n){var c=we(e),l=c||Ei(e)||fs(e);if(r=ne(r,4),n==null){var d=e&&e.constructor;l?n=c?new d:[]:ht(e)?n=ri(d)?cs(Nn(e)):{}:n={}}return(l?br:Kr)(e,function(w,b,O){return r(n,w,b,O)}),n}function hm(e,r){return e==null?!0:xa(e,r)}function lm(e,r,n){return e==null?e:Su(e,r,Oa(n))}function fm(e,r,n,c){return c=typeof c=="function"?c:i,e==null?e:Su(e,r,Oa(n),c)}function ps(e){return e==null?[]:na(e,Ut(e))}function pm(e){return e==null?[]:na(e,ar(e))}function dm(e,r,n){return n===i&&(n=r,r=i),n!==i&&(n=Or(n),n=n===n?n:0),r!==i&&(r=Or(r),r=r===r?r:0),Mi(Or(e),r,n)}function gm(e,r,n){return r=ii(r),n===i?(n=r,r=0):n=ii(n),e=Or(e),bd(e,r,n)}function vm(e,r,n){if(n&&typeof n!="boolean"&&er(e,r,n)&&(r=n=i),n===i&&(typeof r=="boolean"?(n=r,r=i):typeof e=="boolean"&&(n=e,e=i)),e===i&&r===i?(e=0,r=1):(e=ii(e),r===i?(r=e,e=0):r=ii(r)),e>r){var c=e;e=r,r=c}if(n||e%1||r%1){var l=ru();return Vt(e+l*(r-e+Ge("1e-"+((l+"").length-1))),r)}return ba(e,r)}var ym=hs(function(e,r,n){return r=r.toLowerCase(),e+(n?Lh(r):r)});function Lh(e){return Wa(Me(e).toLowerCase())}function Dh(e){return e=Me(e),e&&e.replace(Wr,ap).replace(Qo,"")}function mm(e,r,n){e=Me(e),r=dr(r);var c=e.length;n=n===i?c:Mi(_e(n),0,c);var l=n;return n-=r.length,n>=0&&e.slice(n,l)==r}function wm(e){return e=Me(e),e&&it.test(e)?e.replace(Ri,cp):e}function _m(e){return e=Me(e),e&&Ct.test(e)?e.replace(gt,"\\$&"):e}var bm=hs(function(e,r,n){return e+(n?"-":"")+r.toLowerCase()}),Em=hs(function(e,r,n){return e+(n?" ":"")+r.toLowerCase()}),Im=Mu("toLowerCase");function xm(e,r,n){e=Me(e),r=_e(r);var c=r?is(e):0;if(!r||c>=r)return e;var l=(r-c)/2;return Jn(qn(l),n)+e+Jn($n(l),n)}function Pm(e,r,n){e=Me(e),r=_e(r);var c=r?is(e):0;return r&&c<r?e+Jn(r-c,n):e}function Sm(e,r,n){e=Me(e),r=_e(r);var c=r?is(e):0;return r&&c<r?Jn(r-c,n)+e:e}function Om(e,r,n){return n||r==null?r=0:r&&(r=+r),Dp(Me(e).replace(vt,""),r||0)}function Rm(e,r,n){return(n?er(e,r,n):r===i)?r=1:r=_e(r),Ea(Me(e),r)}function Cm(){var e=arguments,r=Me(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var Am=hs(function(e,r,n){return e+(n?"_":"")+r.toLowerCase()});function Tm(e,r,n){return n&&typeof n!="number"&&er(e,r,n)&&(r=n=i),n=n===i?G:n>>>0,n?(e=Me(e),e&&(typeof r=="string"||r!=null&&!Fa(r))&&(r=dr(r),!r&&rs(e))?bi(Tr(e),0,n):e.split(r,n)):[]}var Nm=hs(function(e,r,n){return e+(n?" ":"")+Wa(r)});function Lm(e,r,n){return e=Me(e),n=n==null?0:Mi(_e(n),0,e.length),r=dr(r),e.slice(n,n+r.length)==r}function Dm(e,r,n){var c=p.templateSettings;n&&er(e,r,n)&&(r=i),e=Me(e),r=ao({},r,c,Bu);var l=ao({},r.imports,c.imports,Bu),d=Ut(l),w=na(l,d),b,O,M=0,j=r.interpolate||Wi,K="__p += '",J=aa((r.escape||Wi).source+"|"+j.source+"|"+(j===ut?Lo:Wi).source+"|"+(r.evaluate||Wi).source+"|$","g"),te="//# sourceURL="+(ze.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Yo+"]")+`
`;e.replace(J,function(ae,Pe,Ae,vr,tr,yr){return Ae||(Ae=vr),K+=e.slice(M,yr).replace(zo,up),Pe&&(b=!0,K+=`' +
__e(`+Pe+`) +
'`),tr&&(O=!0,K+=`';
`+tr+`;
__p += '`),Ae&&(K+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),M=yr+ae.length,ae}),K+=`';
`;var oe=ze.call(r,"variable")&&r.variable;if(!oe)K=`with (obj) {
`+K+`
}
`;else if(To.test(oe))throw new ve(g);K=(O?K.replace(Ur,""):K).replace(Yt,"$1").replace(Gr,"$1;"),K="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(O?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Ee=qh(function(){return $e(d,te+"return "+K).apply(i,w)});if(Ee.source=K,Ba(Ee))throw Ee;return Ee}function $m(e){return Me(e).toLowerCase()}function qm(e){return Me(e).toUpperCase()}function Mm(e,r,n){if(e=Me(e),e&&(n||r===i))return Fc(e);if(!e||!(r=dr(r)))return e;var c=Tr(e),l=Tr(r),d=Vc(c,l),w=Gc(c,l)+1;return bi(c,d,w).join("")}function jm(e,r,n){if(e=Me(e),e&&(n||r===i))return e.slice(0,Jc(e)+1);if(!e||!(r=dr(r)))return e;var c=Tr(e),l=Gc(c,Tr(r))+1;return bi(c,0,l).join("")}function zm(e,r,n){if(e=Me(e),e&&(n||r===i))return e.replace(vt,"");if(!e||!(r=dr(r)))return e;var c=Tr(e),l=Vc(c,Tr(r));return bi(c,l).join("")}function Um(e,r){var n=ie,c=ue;if(ht(r)){var l="separator"in r?r.separator:l;n="length"in r?_e(r.length):n,c="omission"in r?dr(r.omission):c}e=Me(e);var d=e.length;if(rs(e)){var w=Tr(e);d=w.length}if(n>=d)return e;var b=n-is(c);if(b<1)return c;var O=w?bi(w,0,b).join(""):e.slice(0,b);if(l===i)return O+c;if(w&&(b+=O.length-b),Fa(l)){if(e.slice(b).search(l)){var M,j=O;for(l.global||(l=aa(l.source,Me(wr.exec(l))+"g")),l.lastIndex=0;M=l.exec(j);)var K=M.index;O=O.slice(0,K===i?b:K)}}else if(e.indexOf(dr(l),b)!=b){var J=O.lastIndexOf(l);J>-1&&(O=O.slice(0,J))}return O+c}function Hm(e){return e=Me(e),e&&ft.test(e)?e.replace(fi,vp):e}var km=hs(function(e,r,n){return e+(n?" ":"")+r.toUpperCase()}),Wa=Mu("toUpperCase");function $h(e,r,n){return e=Me(e),r=n?i:r,r===i?lp(e)?wp(e):rp(e):e.match(r)||[]}var qh=xe(function(e,r){try{return zt(e,i,r)}catch(n){return Ba(n)?n:new ve(n)}}),Km=ei(function(e,r){return br(r,function(n){n=Fr(n),Xr(e,n,ka(e[n],e))}),e});function Bm(e){var r=e==null?0:e.length,n=ne();return e=r?nt(e,function(c){if(typeof c[1]!="function")throw new Er(f);return[n(c[0]),c[1]]}):[],xe(function(c){for(var l=-1;++l<r;){var d=e[l];if(zt(d[0],this,c))return zt(d[1],this,c)}})}function Fm(e){return vd(xr(e,R))}function Ja(e){return function(){return e}}function Vm(e,r){return e==null||e!==e?r:e}var Gm=zu(),Wm=zu(!0);function cr(e){return e}function Qa(e){return gu(typeof e=="function"?e:xr(e,R))}function Jm(e){return yu(xr(e,R))}function Qm(e,r){return mu(e,xr(r,R))}var Ym=xe(function(e,r){return function(n){return $s(n,e,r)}}),Xm=xe(function(e,r){return function(n){return $s(e,n,r)}});function Ya(e,r,n){var c=Ut(r),l=kn(r,c);n==null&&!(ht(r)&&(l.length||!c.length))&&(n=r,r=e,e=this,l=kn(r,Ut(r)));var d=!(ht(n)&&"chain"in n)||!!n.chain,w=ri(e);return br(l,function(b){var O=r[b];e[b]=O,w&&(e.prototype[b]=function(){var M=this.__chain__;if(d||M){var j=e(this.__wrapped__),K=j.__actions__=nr(this.__actions__);return K.push({func:O,args:arguments,thisArg:e}),j.__chain__=M,j}return O.apply(e,gi([this.value()],arguments))})}),e}function Zm(){return Ce._===this&&(Ce._=Pp),this}function Xa(){}function e0(e){return e=_e(e),xe(function(r){return wu(r,e)})}var t0=Ca(nt),r0=Ca(Uc),i0=Ca(ea);function Mh(e){return qa(e)?ta(Fr(e)):Ld(e)}function s0(e){return function(r){return e==null?i:ji(e,r)}}var n0=Hu(),o0=Hu(!0);function Za(){return[]}function ec(){return!1}function a0(){return{}}function c0(){return""}function u0(){return!0}function h0(e,r){if(e=_e(e),e<1||e>V)return[];var n=G,c=Vt(e,G);r=ne(r),e-=G;for(var l=sa(c,r);++n<e;)r(n);return l}function l0(e){return we(e)?nt(e,Fr):gr(e)?[e]:nr(ih(Me(e)))}function f0(e){var r=++Ip;return Me(e)+r}var p0=Wn(function(e,r){return e+r},0),d0=Aa("ceil"),g0=Wn(function(e,r){return e/r},1),v0=Aa("floor");function y0(e){return e&&e.length?Hn(e,cr,ga):i}function m0(e,r){return e&&e.length?Hn(e,ne(r,2),ga):i}function w0(e){return Kc(e,cr)}function _0(e,r){return Kc(e,ne(r,2))}function b0(e){return e&&e.length?Hn(e,cr,wa):i}function E0(e,r){return e&&e.length?Hn(e,ne(r,2),wa):i}var I0=Wn(function(e,r){return e*r},1),x0=Aa("round"),P0=Wn(function(e,r){return e-r},0);function S0(e){return e&&e.length?ia(e,cr):0}function O0(e,r){return e&&e.length?ia(e,ne(r,2)):0}return p.after=Jv,p.ary=dh,p.assign=qy,p.assignIn=Rh,p.assignInWith=ao,p.assignWith=My,p.at=jy,p.before=gh,p.bind=ka,p.bindAll=Km,p.bindKey=vh,p.castArray=ay,p.chain=lh,p.chunk=vg,p.compact=yg,p.concat=mg,p.cond=Bm,p.conforms=Fm,p.constant=Ja,p.countBy=Sv,p.create=zy,p.curry=yh,p.curryRight=mh,p.debounce=wh,p.defaults=Uy,p.defaultsDeep=Hy,p.defer=Qv,p.delay=Yv,p.difference=wg,p.differenceBy=_g,p.differenceWith=bg,p.drop=Eg,p.dropRight=Ig,p.dropRightWhile=xg,p.dropWhile=Pg,p.fill=Sg,p.filter=Rv,p.flatMap=Tv,p.flatMapDeep=Nv,p.flatMapDepth=Lv,p.flatten=ah,p.flattenDeep=Og,p.flattenDepth=Rg,p.flip=Xv,p.flow=Gm,p.flowRight=Wm,p.fromPairs=Cg,p.functions=Wy,p.functionsIn=Jy,p.groupBy=Dv,p.initial=Tg,p.intersection=Ng,p.intersectionBy=Lg,p.intersectionWith=Dg,p.invert=Yy,p.invertBy=Xy,p.invokeMap=qv,p.iteratee=Qa,p.keyBy=Mv,p.keys=Ut,p.keysIn=ar,p.map=to,p.mapKeys=em,p.mapValues=tm,p.matches=Jm,p.matchesProperty=Qm,p.memoize=io,p.merge=rm,p.mergeWith=Ch,p.method=Ym,p.methodOf=Xm,p.mixin=Ya,p.negate=so,p.nthArg=e0,p.omit=im,p.omitBy=sm,p.once=Zv,p.orderBy=jv,p.over=t0,p.overArgs=ey,p.overEvery=r0,p.overSome=i0,p.partial=Ka,p.partialRight=_h,p.partition=zv,p.pick=nm,p.pickBy=Ah,p.property=Mh,p.propertyOf=s0,p.pull=jg,p.pullAll=uh,p.pullAllBy=zg,p.pullAllWith=Ug,p.pullAt=Hg,p.range=n0,p.rangeRight=o0,p.rearg=ty,p.reject=kv,p.remove=kg,p.rest=ry,p.reverse=Ua,p.sampleSize=Bv,p.set=am,p.setWith=cm,p.shuffle=Fv,p.slice=Kg,p.sortBy=Wv,p.sortedUniq=Qg,p.sortedUniqBy=Yg,p.split=Tm,p.spread=iy,p.tail=Xg,p.take=Zg,p.takeRight=ev,p.takeRightWhile=tv,p.takeWhile=rv,p.tap=yv,p.throttle=sy,p.thru=eo,p.toArray=Ph,p.toPairs=Th,p.toPairsIn=Nh,p.toPath=l0,p.toPlainObject=Oh,p.transform=um,p.unary=ny,p.union=iv,p.unionBy=sv,p.unionWith=nv,p.uniq=ov,p.uniqBy=av,p.uniqWith=cv,p.unset=hm,p.unzip=Ha,p.unzipWith=hh,p.update=lm,p.updateWith=fm,p.values=ps,p.valuesIn=pm,p.without=uv,p.words=$h,p.wrap=oy,p.xor=hv,p.xorBy=lv,p.xorWith=fv,p.zip=pv,p.zipObject=dv,p.zipObjectDeep=gv,p.zipWith=vv,p.entries=Th,p.entriesIn=Nh,p.extend=Rh,p.extendWith=ao,Ya(p,p),p.add=p0,p.attempt=qh,p.camelCase=ym,p.capitalize=Lh,p.ceil=d0,p.clamp=dm,p.clone=cy,p.cloneDeep=hy,p.cloneDeepWith=ly,p.cloneWith=uy,p.conformsTo=fy,p.deburr=Dh,p.defaultTo=Vm,p.divide=g0,p.endsWith=mm,p.eq=Lr,p.escape=wm,p.escapeRegExp=_m,p.every=Ov,p.find=Cv,p.findIndex=nh,p.findKey=ky,p.findLast=Av,p.findLastIndex=oh,p.findLastKey=Ky,p.floor=v0,p.forEach=fh,p.forEachRight=ph,p.forIn=By,p.forInRight=Fy,p.forOwn=Vy,p.forOwnRight=Gy,p.get=Va,p.gt=py,p.gte=dy,p.has=Qy,p.hasIn=Ga,p.head=ch,p.identity=cr,p.includes=$v,p.indexOf=Ag,p.inRange=gm,p.invoke=Zy,p.isArguments=Hi,p.isArray=we,p.isArrayBuffer=gy,p.isArrayLike=or,p.isArrayLikeObject=Et,p.isBoolean=vy,p.isBuffer=Ei,p.isDate=yy,p.isElement=my,p.isEmpty=wy,p.isEqual=_y,p.isEqualWith=by,p.isError=Ba,p.isFinite=Ey,p.isFunction=ri,p.isInteger=bh,p.isLength=no,p.isMap=Eh,p.isMatch=Iy,p.isMatchWith=xy,p.isNaN=Py,p.isNative=Sy,p.isNil=Ry,p.isNull=Oy,p.isNumber=Ih,p.isObject=ht,p.isObjectLike=mt,p.isPlainObject=Hs,p.isRegExp=Fa,p.isSafeInteger=Cy,p.isSet=xh,p.isString=oo,p.isSymbol=gr,p.isTypedArray=fs,p.isUndefined=Ay,p.isWeakMap=Ty,p.isWeakSet=Ny,p.join=$g,p.kebabCase=bm,p.last=Sr,p.lastIndexOf=qg,p.lowerCase=Em,p.lowerFirst=Im,p.lt=Ly,p.lte=Dy,p.max=y0,p.maxBy=m0,p.mean=w0,p.meanBy=_0,p.min=b0,p.minBy=E0,p.stubArray=Za,p.stubFalse=ec,p.stubObject=a0,p.stubString=c0,p.stubTrue=u0,p.multiply=I0,p.nth=Mg,p.noConflict=Zm,p.noop=Xa,p.now=ro,p.pad=xm,p.padEnd=Pm,p.padStart=Sm,p.parseInt=Om,p.random=vm,p.reduce=Uv,p.reduceRight=Hv,p.repeat=Rm,p.replace=Cm,p.result=om,p.round=x0,p.runInContext=S,p.sample=Kv,p.size=Vv,p.snakeCase=Am,p.some=Gv,p.sortedIndex=Bg,p.sortedIndexBy=Fg,p.sortedIndexOf=Vg,p.sortedLastIndex=Gg,p.sortedLastIndexBy=Wg,p.sortedLastIndexOf=Jg,p.startCase=Nm,p.startsWith=Lm,p.subtract=P0,p.sum=S0,p.sumBy=O0,p.template=Dm,p.times=h0,p.toFinite=ii,p.toInteger=_e,p.toLength=Sh,p.toLower=$m,p.toNumber=Or,p.toSafeInteger=$y,p.toString=Me,p.toUpper=qm,p.trim=Mm,p.trimEnd=jm,p.trimStart=zm,p.truncate=Um,p.unescape=Hm,p.uniqueId=f0,p.upperCase=km,p.upperFirst=Wa,p.each=fh,p.eachRight=ph,p.first=ch,Ya(p,function(){var e={};return Kr(p,function(r,n){ze.call(p.prototype,n)||(e[n]=r)}),e}(),{chain:!1}),p.VERSION=s,br(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),br(["drop","take"],function(e,r){Oe.prototype[e]=function(n){n=n===i?1:Mt(_e(n),0);var c=this.__filtered__&&!r?new Oe(this):this.clone();return c.__filtered__?c.__takeCount__=Vt(n,c.__takeCount__):c.__views__.push({size:Vt(n,G),type:e+(c.__dir__<0?"Right":"")}),c},Oe.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),br(["filter","map","takeWhile"],function(e,r){var n=r+1,c=n==m||n==X;Oe.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ne(l,3),type:n}),d.__filtered__=d.__filtered__||c,d}}),br(["head","last"],function(e,r){var n="take"+(r?"Right":"");Oe.prototype[e]=function(){return this[n](1).value()[0]}}),br(["initial","tail"],function(e,r){var n="drop"+(r?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[n](1)}}),Oe.prototype.compact=function(){return this.filter(cr)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,r){return typeof e=="function"?new Oe(this):this.map(function(n){return $s(n,e,r)})}),Oe.prototype.reject=function(e){return this.filter(so(ne(e)))},Oe.prototype.slice=function(e,r){e=_e(e);var n=this;return n.__filtered__&&(e>0||r<0)?new Oe(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),r!==i&&(r=_e(r),n=r<0?n.dropRight(-r):n.take(r-e)),n)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},Kr(Oe.prototype,function(e,r){var n=/^(?:filter|find|map|reject)|While$/.test(r),c=/^(?:head|last)$/.test(r),l=p[c?"take"+(r=="last"?"Right":""):r],d=c||/^find/.test(r);l&&(p.prototype[r]=function(){var w=this.__wrapped__,b=c?[1]:arguments,O=w instanceof Oe,M=b[0],j=O||we(w),K=function(Pe){var Ae=l.apply(p,gi([Pe],b));return c&&J?Ae[0]:Ae};j&&n&&typeof M=="function"&&M.length!=1&&(O=j=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=d&&!J,Ee=O&&!te;if(!d&&j){w=Ee?w:new Oe(this);var ae=e.apply(w,b);return ae.__actions__.push({func:eo,args:[K],thisArg:i}),new Ir(ae,J)}return oe&&Ee?e.apply(this,b):(ae=this.thru(K),oe?c?ae.value()[0]:ae.value():ae)})}),br(["pop","push","shift","sort","splice","unshift"],function(e){var r=Sn[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return r.apply(we(d)?d:[],l)}return this[n](function(w){return r.apply(we(w)?w:[],l)})}}),Kr(Oe.prototype,function(e,r){var n=p[r];if(n){var c=n.name+"";ze.call(as,c)||(as[c]=[]),as[c].push({name:r,func:n})}}),as[Gn(i,he).name]=[{name:"wrapper",func:i}],Oe.prototype.clone=Hp,Oe.prototype.reverse=kp,Oe.prototype.value=Kp,p.prototype.at=mv,p.prototype.chain=wv,p.prototype.commit=_v,p.prototype.next=bv,p.prototype.plant=Iv,p.prototype.reverse=xv,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Pv,p.prototype.first=p.prototype.head,Rs&&(p.prototype[Rs]=Ev),p},ss=_p();bt?((bt.exports=ss)._=ss,We._=ss):Ce._=ss}).call(Ws)})(Pc,Pc.exports);var eI=Object.defineProperty,tI=Object.defineProperties,rI=Object.getOwnPropertyDescriptors,kl=Object.getOwnPropertySymbols,iI=Object.prototype.hasOwnProperty,sI=Object.prototype.propertyIsEnumerable,Kl=(a,t,i)=>t in a?eI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,fo=(a,t)=>{for(var i in t||(t={}))iI.call(t,i)&&Kl(a,i,t[i]);if(kl)for(var i of kl(t))sI.call(t,i)&&Kl(a,i,t[i]);return a},nI=(a,t)=>tI(a,rI(t));function Si(a,t,i){var s;const o=pw(a);return((s=t.rpcMap)==null?void 0:s[o.reference])||`${ZE}?chainId=${o.namespace}:${o.reference}&projectId=${i}`}function Gi(a){return a.includes(":")?a.split(":")[1]:a}function Jf(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function oI(a,t){const i=Object.keys(t.namespaces).filter(o=>o.includes(a));if(!i.length)return[];const s=[];return i.forEach(o=>{const h=t.namespaces[o].accounts;s.push(...h)}),s}function aI(a={},t={}){const i=Bl(a),s=Bl(t);return Pc.exports.merge(i,s)}function Bl(a){var t,i,s,o;const h={};if(!vo(a))return h;for(const[f,g]of Object.entries(a)){const _=nf(f)?[f]:g.chains,v=g.methods||[],I=g.events||[],R=g.rpcMap||{},A=Js(f);h[A]=nI(fo(fo({},h[A]),g),{chains:rc(_,(t=h[A])==null?void 0:t.chains),methods:rc(v,(i=h[A])==null?void 0:i.methods),events:rc(I,(s=h[A])==null?void 0:s.events),rpcMap:fo(fo({},R),(o=h[A])==null?void 0:o.rpcMap)})}return h}function cI(a){return a.includes(":")?a.split(":")[2]:a}function uI(a){const t={};for(const[i,s]of Object.entries(a)){const o=s.methods||[],h=s.events||[],f=s.accounts||[],g=nf(i)?[i]:s.chains?s.chains:Jf(s.accounts);t[i]={chains:g,methods:o,events:h,accounts:f}}return t}function dc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Qf={},ot=a=>Qf[a],gc=(a,t)=>{Qf[a]=t};class hI{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=Gi(i);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Si(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}}class lI{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(parseInt(t),i),this.chainId=parseInt(t),this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,i){const s=i||Si(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=parseInt(Gi(i));t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}async handleSwitchChain(t){var i,s;let o=t.request.params?(i=t.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class fI{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=Gi(i);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Si(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}}class pI{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=Gi(i);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Si(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}}class dI{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{const s=this.getCardanoRPCUrl(i),o=Gi(i);t[o]=this.createHttpProvider(o,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}getCardanoRPCUrl(t){const i=this.namespace.rpcMap;if(i)return i[t]}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}}class gI{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=Gi(i);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Si(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}}class vI{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=Gi(i);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Si(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(s,ot("disableProviderPing")))}}class yI{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const s=i||Si(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;t[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Si(t,this.namespace);return typeof s>"u"?void 0:new hi(new Oi(s,ot("disableProviderPing")))}}var mI=Object.defineProperty,wI=Object.defineProperties,_I=Object.getOwnPropertyDescriptors,Fl=Object.getOwnPropertySymbols,bI=Object.prototype.hasOwnProperty,EI=Object.prototype.propertyIsEnumerable,Vl=(a,t,i)=>t in a?mI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,po=(a,t)=>{for(var i in t||(t={}))bI.call(t,i)&&Vl(a,i,t[i]);if(Fl)for(var i of Fl(t))EI.call(t,i)&&Vl(a,i,t[i]);return a},vc=(a,t)=>wI(a,_I(t));class jc{constructor(t){this.events=new Ac,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Ul})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const i=new jc(t);return await i.initialize(),i}async request(t,i){const[s,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:po({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,i,s){const o=new Date().getTime();this.request(t,s).then(h=>i(null,So(o,h))).catch(h=>i(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Wt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}removeListener(t,i){this.events.removeListener(t,i)}off(t,i){this.events.off(t,i)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=uI(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Gf)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,i){try{if(!this.session)return;const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,i)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(_s(i)){for(const s of i)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await VE.init({logger:this.providerOpts.logger||Ul,relayUrl:this.providerOpts.relayUrl||QE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(i=>Js(i)))];gc("client",this.client),gc("events",this.events),gc("disableProviderPing",this.disableProviderPing),t.forEach(i=>{if(!this.session)return;const s=oI(i,this.session),o=Jf(s),h=aI(this.namespaces,this.optionalNamespaces),f=vc(po({},h[i]),{accounts:s,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new lI({namespace:f});break;case"solana":this.rpcProviders[i]=new fI({namespace:f});break;case"cosmos":this.rpcProviders[i]=new pI({namespace:f});break;case"polkadot":this.rpcProviders[i]=new hI({namespace:f});break;case"cip34":this.rpcProviders[i]=new dI({namespace:f});break;case"elrond":this.rpcProviders[i]=new gI({namespace:f});break;case"multiversx":this.rpcProviders[i]=new vI({namespace:f});break;case"near":this.rpcProviders[i]=new yI({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:i}=t,{event:s}=i;if(s.name==="accountsChanged"){const o=s.data;o&&_s(o)&&this.events.emit("accountsChanged",o.map(cI))}else if(s.name==="chainChanged"){const o=i.chainId,h=i.event.data,f=Js(o),g=dc(o)!==dc(h)?`${f}:${dc(h)}`:o;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:i})=>{var s;const{namespaces:o}=i,h=(s=this.client)==null?void 0:s.session.get(t);this.session=vc(po({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:i})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",vc(po({},Wt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(li.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var i;this.getProvider(t).updateNamespace((i=this.session)==null?void 0:i.namespaces[t])})}setNamespaces(t){const{namespaces:i,optionalNamespaces:s,sessionProperties:o}=t;i&&Object.keys(i).length&&(this.namespaces=i),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",s)}validateChain(t){const[i,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,s];if(i&&!Object.keys(this.namespaces||{}).map(f=>Js(f)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&s)return[i,s];const o=Js(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,i=!1){var s;if(!this.namespaces)return;const[o,h]=this.validateChain(t);i||this.getProvider(o).setDefaultChain(h),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,i){this.client.core.storage.setItem(`${Hl}/${t}`,i)}async getFromStore(t){return await this.client.core.storage.getItem(`${Hl}/${t}`)}}const II=jc,xI="wc",PI="ethereum_provider",SI=`${xI}@2:${PI}:`,OI="https://rpc.walletconnect.com/v1/",Sc=["eth_sendTransaction","personal_sign"],RI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Oc=["chainChanged","accountsChanged"],CI=["chainChanged","accountsChanged","message","disconnect","connect"];var AI=Object.defineProperty,TI=Object.defineProperties,NI=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,LI=Object.prototype.hasOwnProperty,DI=Object.prototype.propertyIsEnumerable,Wl=(a,t,i)=>t in a?AI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Ys=(a,t)=>{for(var i in t||(t={}))LI.call(t,i)&&Wl(a,i,t[i]);if(Gl)for(var i of Gl(t))DI.call(t,i)&&Wl(a,i,t[i]);return a},Jl=(a,t)=>TI(a,NI(t));function Eo(a){return Number(a[0].split(":")[1])}function yc(a){return`0x${a.toString(16)}`}function $I(a){const{chains:t,optionalChains:i,methods:s,optionalMethods:o,events:h,optionalEvents:f,rpcMap:g}=a;if(!_s(t))throw new Error("Invalid chains");const _={chains:t,methods:s||Sc,events:h||Oc,rpcMap:Ys({},t.length?{[Eo(t)]:g[Eo(t)]}:{})},v=h==null?void 0:h.filter(z=>!Oc.includes(z)),I=s==null?void 0:s.filter(z=>!Sc.includes(z));if(!i&&!f&&!o&&!(v!=null&&v.length)&&!(I!=null&&I.length))return{required:t.length?_:void 0};const R=(v==null?void 0:v.length)&&(I==null?void 0:I.length)||!i,A={chains:[...new Set(R?_.chains.concat(i||[]):i)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:RI))],events:[...new Set(_.events.concat(f!=null&&f.length?f:CI))],rpcMap:g};return{required:t.length?_:void 0,optional:i.length?A:void 0}}class zc{constructor(){this.events=new mr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=SI,this.on=(t,i)=>(this.events.on(t,i),this),this.once=(t,i)=>(this.events.once(t,i),this),this.removeListener=(t,i)=>(this.events.removeListener(t,i),this),this.off=(t,i)=>(this.events.off(t,i),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const i=new zc;return await i.initialize(t),i}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,i){this.signer.sendAsync(t,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:i,optional:s}=$I(this.rpc);try{const o=await new Promise(async(f,g)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(v=>{!v.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Jl(Ys({namespaces:Ys({},i&&{[this.namespace]:i})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(v=>{f(v)}).catch(v=>{g(new Error(v.message))})});if(!o)return;const h=dw(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:yc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:i}=t,{event:s}=i;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const i=parseInt(t);this.chainId=i,this.events.emit("chainChanged",yc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Jl(Ys({},Wt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var i,s;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const i=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",yc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const i=this.parseChainId(t);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(t){const[i,s,o]=t.split(":");return{chainId:`${i}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var i,s;const o=(i=t==null?void 0:t.chains)!=null?i:[],h=(s=t==null?void 0:t.optionalChains)!=null?s:[],f=o.concat(h);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?(t==null?void 0:t.methods)||Sc:[],_=o.length?(t==null?void 0:t.events)||Oc:[],v=(t==null?void 0:t.optionalMethods)||[],I=(t==null?void 0:t.optionalEvents)||[],R=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),A=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(z=>this.formatChainId(z)),optionalChains:h.map(z=>this.formatChainId(z)),methods:g,events:_,optionalMethods:v,optionalEvents:I,rpcMap:R,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:A,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,i){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,i)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Eo(this.rpc.chains):Eo(this.rpc.optionalChains),this.signer=await II.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:s}=await gw(()=>import("./CN8lmHpk.js").then(o=>o.i),__vite__mapDeps([0,1,2]),import.meta.url);i=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Ys({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:i,optionalChains:s,rpcMap:o}=t;i&&_s(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),s&&_s(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(t,i){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${OI}?chainId=eip155:${t}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(i=>this.parseAccount(i))}}const YI=zc;export{YI as EthereumProvider,CI as OPTIONAL_EVENTS,RI as OPTIONAL_METHODS,Oc as REQUIRED_EVENTS,Sc as REQUIRED_METHODS,zc as default};
